<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Time series regression models | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="Chapter 7 Time series regression models | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Time series regression models | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/daluchkin/fpp3_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Time series regression models | Forecasting: Principles and Practice (3rd ed)" />
  
  
  

<meta name="author" content="Dmitry Luchkin" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="judgmental-forecasts.html"/>
<link rel="next" href="exponential-smoothing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice (3rd ed)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#what-can-be-forecast"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#forecasting-goals-and-planning"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#determining-what-to-forecast"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#forecasting-data-and-methods"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#some-case-studies"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#the-basic-steps-in-a-forecasting-task"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting"><i class="fa fa-check"></i><b>1.6.1</b> Summary: Five Basic Steps of Forecasting</a></li>
<li class="chapter" data-level="1.6.2" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting-1"><i class="fa fa-check"></i><b>1.6.2</b> Summary: Five Basic Steps of Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started.html"><a href="getting-started.html#the-statistical-forecasting-perspective"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started.html"><a href="getting-started.html#excercises"><i class="fa fa-check"></i><b>1.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-object"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> object</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-index-variable"><i class="fa fa-check"></i><b>2.1.1</b> The index variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-key-variable"><i class="fa fa-check"></i><b>2.1.2</b> The key variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#working-with-tsibble-object"><i class="fa fa-check"></i><b>2.1.3</b> Working with <code>tsibble</code> object</a></li>
<li class="chapter" data-level="2.1.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#read-a-csv-file-and-convert-to-a-tsibble"><i class="fa fa-check"></i><b>2.1.4</b> Read a csv file and convert to a tsibble</a></li>
<li class="chapter" data-level="2.1.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-seasonal-period"><i class="fa fa-check"></i><b>2.1.5</b> The seasonal period</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plot"><i class="fa fa-check"></i><b>2.2</b> Time plot</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-series-patterns"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplots"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#correlation"><i class="fa fa-check"></i><b>2.6.1</b> Correlation</a></li>
<li class="chapter" data-level="2.6.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.2</b> Scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.8.1</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="time-series-graphics.html"><a href="time-series-graphics.html#white-moise"><i class="fa fa-check"></i><b>2.9</b> White moise</a></li>
<li class="chapter" data-level="2.10" data-path="time-series-graphics.html"><a href="time-series-graphics.html#excercises-1"><i class="fa fa-check"></i><b>2.10</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformations-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#mathematical-transformations"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#time-series-components"><i class="fa fa-check"></i><b>3.2</b> Time series components</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seasonally-adjusted-data"><i class="fa fa-check"></i><b>3.2.1</b> Seasonally adjusted data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-average-smoothing"><i class="fa fa-check"></i><b>3.3.1</b> Moving average smoothing</a></li>
<li class="chapter" data-level="3.3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.3.2</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-with-seasonal-data"><i class="fa fa-check"></i><b>3.3.3</b> Estimating the trend-cycle with seasonal data</a></li>
<li class="chapter" data-level="3.3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>3.3.4</b> Example: Employment in the US retail sector</a></li>
<li class="chapter" data-level="3.3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.3.5</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#additive-decomposition"><i class="fa fa-check"></i><b>3.4.1</b> Additive decomposition</a></li>
<li class="chapter" data-level="3.4.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#multiplicative-decomposition"><i class="fa fa-check"></i><b>3.4.2</b> Multiplicative decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#excercises-2"><i class="fa fa-check"></i><b>3.5</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#some-simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.1.1</b> ACF features</a></li>
<li class="chapter" data-level="4.1.2" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.1.2</b> STL features</a></li>
<li class="chapter" data-level="4.1.3" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.1.3</b> Other features</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#exploring-australian-tourism-data"><i class="fa fa-check"></i><b>4.2</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#exercises"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#plot-the-data-visualise"><i class="fa fa-check"></i><b>5.1.2</b> Plot the data (visualise)</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naiïve-method"><i class="fa fa-check"></i><b>5.2.2</b> Naiïve method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naïve-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#model-fitting"><i class="fa fa-check"></i><b>5.2.5</b> Model fitting</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#producing-forecasts"><i class="fa fa-check"></i><b>5.2.6</b> Producing forecasts</a></li>
<li class="chapter" data-level="5.2.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualising-forecasts"><i class="fa fa-check"></i><b>5.2.7</b> Visualising forecasts</a></li>
<li class="chapter" data-level="5.2.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-facebook-closing-stock-price"><i class="fa fa-check"></i><b>5.2.8</b> Example: Facebook closing stock price</a></li>
<li class="chapter" data-level="5.2.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.9</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.10</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values"><i class="fa fa-check"></i><b>5.3.1</b> Fitted values</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.2</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#acf-of-residuals"><i class="fa fa-check"></i><b>5.4.1</b> ACF of residuals</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-google-daily-closing-stock-prices"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting Google daily closing stock prices</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-distributions"><i class="fa fa-check"></i><b>5.5.1</b> Forecast distributions</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.3</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.4</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#benchmark-methods"><i class="fa fa-check"></i><b>5.5.5</b> Benchmark methods</a></li>
<li class="chapter" data-level="5.5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.6</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector-1"><i class="fa fa-check"></i><b>5.7.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-point-forecast-accuracy"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#training-and-test-sets"><i class="fa fa-check"></i><b>5.8.1</b> Training and test sets</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#functions-to-subset-a-time-series"><i class="fa fa-check"></i><b>5.8.2</b> Functions to subset a time series</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.8.3</b> Forecast errors</a></li>
<li class="chapter" data-level="5.8.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.8.4</b> Scale-dependent errors</a></li>
<li class="chapter" data-level="5.8.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.8.5</b> Percentage errors</a></li>
<li class="chapter" data-level="5.8.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.8.6</b> Scaled errors</a></li>
<li class="chapter" data-level="5.8.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples"><i class="fa fa-check"></i><b>5.8.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-distributional-forecast-accuracy"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#quantile-scores"><i class="fa fa-check"></i><b>5.9.1</b> Quantile scores</a></li>
<li class="chapter" data-level="5.9.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#winkler-score"><i class="fa fa-check"></i><b>5.9.2</b> Winkler Score</a></li>
<li class="chapter" data-level="5.9.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#continuous-ranked-probability-score"><i class="fa fa-check"></i><b>5.9.3</b> Continuous Ranked Probability Score</a></li>
<li class="chapter" data-level="5.9.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-free-comparisons-using-skill-scores"><i class="fa fa-check"></i><b>5.9.4</b> Scale-free comparisons using skill scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.10.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#exercises-1"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values-1"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness-of-fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-the-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#acf-plot-of-residuals"><i class="fa fa-check"></i><b>7.3.1</b> ACF plot of residuals</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#histogram-of-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Histogram of residuals</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.3</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.4</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.5</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.6</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.3</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusted-r2"><i class="fa fa-check"></i><b>7.5.1</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross-validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#corrected-akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Corrected Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#schwarzs-bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.5</b> Schwarz’s Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>7.5.6</b> Stepwise regression</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.1</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals-1"><i class="fa fa-check"></i><b>7.6.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.7.1</b> Forecasting with a nonlinear trend</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>7.8.1</b> Correlation is not causation</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-correlated-predictors"><i class="fa fa-check"></i><b>7.8.2</b> Forecasting with correlated predictors</a></li>
<li class="chapter" data-level="7.8.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multicollinearity-and-forecasting"><i class="fa fa-check"></i><b>7.8.3</b> Multicollinearity and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimisation"><i class="fa fa-check"></i><b>8.1.4</b> Optimisation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.2</b> Damped trend methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-seasonality"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.3.1</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.3.2</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.3.3</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.3.4</b> Holt-Winters’ damped method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>8.6.1</b> Model selection</a></li>
<li class="chapter" data-level="8.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.6.2</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-2"><i class="fa fa-check"></i><b>8.7.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#excercises-3"><i class="fa fa-check"></i><b>8.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>9.1.1</b> Differencing</a></li>
<li class="chapter" data-level="9.1.2" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>9.1.2</b> Second-order differencing</a></li>
<li class="chapter" data-level="9.1.3" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>9.1.3</b> Seasonal differencing</a></li>
<li class="chapter" data-level="9.1.4" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>9.1.4</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive (AR) models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="arima-models.html"><a href="arima-models.html#ar1-model"><i class="fa fa-check"></i><b>9.3.1</b> AR(1) model</a></li>
<li class="chapter" data-level="9.3.2" data-path="arima-models.html"><a href="arima-models.html#ar2-model"><i class="fa fa-check"></i><b>9.3.2</b> AR(2) model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="arima-models.html"><a href="arima-models.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="arima-models.html"><a href="arima-models.html#example-egyptian-exports"><i class="fa fa-check"></i><b>9.5.1</b> Example: Egyptian exports</a></li>
<li class="chapter" data-level="9.5.2" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-plots"><i class="fa fa-check"></i><b>9.5.2</b> ACF and PACF plots</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-fable"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>9.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="9.7.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>9.7.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="9.7.3" data-path="arima-models.html"><a href="arima-models.html#example-central-african-republic-exports"><i class="fa fa-check"></i><b>9.7.3</b> Example: Central African Republic exports</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals-3"><i class="fa fa-check"></i><b>9.8.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="arima-models.html"><a href="arima-models.html#arima-model-notation"><i class="fa fa-check"></i><b>9.9.1</b> ARIMA Model Notation</a></li>
<li class="chapter" data-level="9.9.2" data-path="arima-models.html"><a href="arima-models.html#acfpacf"><i class="fa fa-check"></i><b>9.9.2</b> ACF/PACF</a></li>
<li class="chapter" data-level="9.9.3" data-path="arima-models.html"><a href="arima-models.html#example-monthly-us-leisure-and-hospitality-employment"><i class="fa fa-check"></i><b>9.9.3</b> Example: Monthly US leisure and hospitality employment</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="arima-models.html"><a href="arima-models.html#arima-vs-ets"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>9.10.1</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="9.10.2" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>9.10.2</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="arima-models.html"><a href="arima-models.html#exercises-3"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors-using-fable"><i class="fa fa-check"></i><b>10.1</b> Regression with ARIMA errors using <code>fable</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>10.1.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting-1"><i class="fa fa-check"></i><b>10.2</b> Forecasting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income-1"><i class="fa fa-check"></i><b>10.2.1</b> Example: US Personal Consumption and Income</a></li>
<li class="chapter" data-level="10.2.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>10.2.2</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#stochastic-and-deterministic-trends"><i class="fa fa-check"></i><b>10.3</b> Stochastic and deterministic trends</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-air-transport-passengers-australia"><i class="fa fa-check"></i><b>10.3.1</b> Example: Air transport passengers Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>10.4</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>10.5</b> Example: Australian eating out expenditure</a></li>
<li class="chapter" data-level="10.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>10.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-and-grouped-time-series"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-time-series"><i class="fa fa-check"></i><b>11.1.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="11.1.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-tourism-hierarchy"><i class="fa fa-check"></i><b>11.1.2</b> Example: Australian tourism hierarchy</a></li>
<li class="chapter" data-level="11.1.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#grouped-time-series"><i class="fa fa-check"></i><b>11.1.3</b> Grouped time series</a></li>
<li class="chapter" data-level="11.1.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-prison-population"><i class="fa fa-check"></i><b>11.1.4</b> Example: Australian prison population</a></li>
<li class="chapter" data-level="11.1.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#mixed-hierarchical-and-grouped-structure"><i class="fa fa-check"></i><b>11.1.5</b> Mixed hierarchical and grouped structure</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#single-level-approaches"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#the-bottom-up-approach"><i class="fa fa-check"></i><b>11.2.1</b> The bottom-up approach</a></li>
<li class="chapter" data-level="11.2.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#top-down-approaches"><i class="fa fa-check"></i><b>11.2.2</b> Top-down approaches</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecast-reconciliation"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-domestic-tourism"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#reconciled-distributional-forecasts"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-prison-population"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#complex-seasonality"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#stl-with-multiple-seasonal-periods"><i class="fa fa-check"></i><b>12.1.1</b> STL with multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#prophet-model"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-quarterly-cement-production"><i class="fa fa-check"></i><b>12.2.1</b> Example: Quarterly cement production</a></li>
<li class="chapter" data-level="12.2.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-half-hourly-electricity-demand"><i class="fa fa-check"></i><b>12.2.2</b> Example: Half-hourly electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#vector-autoregressions"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daluchkin?tab=repositories">All Repositories</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice (3rd ed)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-regression-models" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Time series regression models<a href="time-series-regression-models.html#time-series-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="time-series-regression-models.html#cb803-1" tabindex="-1"></a><span class="co"># loading libraries</span></span>
<span id="cb803-2"><a href="time-series-regression-models.html#cb803-2" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb803-3"><a href="time-series-regression-models.html#cb803-3" tabindex="-1"></a><span class="fu">library</span>(tsibbledata)</span>
<span id="cb803-4"><a href="time-series-regression-models.html#cb803-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb803-5"><a href="time-series-regression-models.html#cb803-5" tabindex="-1"></a><span class="co"># to read data</span></span>
<span id="cb803-6"><a href="time-series-regression-models.html#cb803-6" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb803-7"><a href="time-series-regression-models.html#cb803-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb803-8"><a href="time-series-regression-models.html#cb803-8" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb803-9"><a href="time-series-regression-models.html#cb803-9" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb803-10"><a href="time-series-regression-models.html#cb803-10" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb803-11"><a href="time-series-regression-models.html#cb803-11" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb803-12"><a href="time-series-regression-models.html#cb803-12" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<p><a href="https://otexts.com/fpp3/regression.html">The source of the chapter</a></p>
<blockquote>
<p>The basic concept is that we forecast the time series of interest <span class="math inline">\(y\)</span> assuming that it has a linear relationship with other time series <span class="math inline">\(x\)</span>.</p>
</blockquote>
<p>The <strong>forecast variable</strong> <span class="math inline">\(y\)</span> is <strong>dependent variable</strong>, regressand or explained variable. The <strong>predictor variables</strong> <span class="math inline">\(x\)</span> are <strong>independent variable</strong>, regressors or exploratory variable.</p>
<div id="the-linear-model" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> The linear model<a href="time-series-regression-models.html#the-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/regression-intro.html">The source of the section</a></p>
<div id="simple-linear-regression" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Simple linear regression<a href="time-series-regression-models.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
y_t = \beta_0 + \beta_1x_{1,t} + \varepsilon_t
\]</span></p>
<p>The intercept <span class="math inline">\(\beta_0\)</span> represents the predicted value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x=0\)</span>. The slope <span class="math inline">\(\beta_1\)</span> represents the average predicted change in <span class="math inline">\(y\)</span> resulting from a one unit increase in <span class="math inline">\(x\)</span>.</p>
<p><span class="math inline">\(\varepsilon_t\)</span> or “error” represents a deviation from the underlying straight line model.</p>
<div id="example-us-consumption-expenditure" class="section level4 hasAnchor" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> Example: US consumption expenditure<a href="time-series-regression-models.html#example-us-consumption-expenditure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="time-series-regression-models.html#cb804-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb804-2"><a href="time-series-regression-models.html#cb804-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Consumption, Income), <span class="at">names_to =</span> <span class="st">&#39;Series&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb804-3"><a href="time-series-regression-models.html#cb804-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb804-4"><a href="time-series-regression-models.html#cb804-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;% change&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="time-series-regression-models.html#cb805-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb805-2"><a href="time-series-regression-models.html#cb805-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">lm =</span> <span class="fu">TSLM</span>(Consumption <span class="sc">~</span> Income)) <span class="sc">|&gt;</span></span>
<span id="cb805-3"><a href="time-series-regression-models.html#cb805-3" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Consumption 
## Model: TSLM 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.58236 -0.27777  0.01862  0.32330  1.42229 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.54454    0.05403  10.079  &lt; 2e-16 ***
## Income       0.27183    0.04673   5.817  2.4e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5905 on 196 degrees of freedom
## Multiple R-squared: 0.1472,  Adjusted R-squared: 0.1429
## F-statistic: 33.84 on 1 and 196 DF, p-value: 2.4022e-08</code></pre>
<p><span class="math display">\[
\hat y_t = 0.54 + 0.27x_t
\]</span></p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="time-series-regression-models.html#cb807-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb807-2"><a href="time-series-regression-models.html#cb807-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">y =</span> Consumption)) <span class="sc">+</span></span>
<span id="cb807-3"><a href="time-series-regression-models.html#cb807-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Income (quarterly % change)&#39;</span>,</span>
<span id="cb807-4"><a href="time-series-regression-models.html#cb807-4" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Consumption (quarterly % change)&#39;</span>) <span class="sc">+</span></span>
<span id="cb807-5"><a href="time-series-regression-models.html#cb807-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb807-6"><a href="time-series-regression-models.html#cb807-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="figure_html/ch07-ts-regression-4-1.png" width="672" /></p>
</div>
</div>
<div id="multiple-linear-regression" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Multiple linear regression<a href="time-series-regression-models.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
y_t = \beta_0 + \beta_1x_{1,t} + \beta_2x_{2,t} + ... + \beta_kx_{k,t} + \varepsilon_t
\]</span></p>
<ul>
<li><span class="math inline">\(y_t\)</span> is the variable we want to predict: the “response” variable</li>
<li>Each <span class="math inline">\(x_{j,t}\)</span> is <strong>numerical</strong> and called a “predictor”. They are usually assumed to be known for all past and future times.</li>
<li>The coefficients <span class="math inline">\(\beta_1, ..., \beta_k\)</span> measure the effect of each predictor after taking account of the all other predictors in the model.</li>
<li><span class="math inline">\(\varepsilon_t\)</span> is a white noise error term</li>
</ul>
<div id="example-us-consumption-expenditure-1" class="section level4 hasAnchor" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> Example: US consumption expenditure<a href="time-series-regression-models.html#example-us-consumption-expenditure-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="time-series-regression-models.html#cb809-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb809-2"><a href="time-series-regression-models.html#cb809-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Quarter) <span class="sc">|&gt;</span></span>
<span id="cb809-3"><a href="time-series-regression-models.html#cb809-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Quarter, value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb809-4"><a href="time-series-regression-models.html#cb809-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb809-5"><a href="time-series-regression-models.html#cb809-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb809-6"><a href="time-series-regression-models.html#cb809-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb809-7"><a href="time-series-regression-models.html#cb809-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;% change&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="time-series-regression-models.html#cb810-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb810-2"><a href="time-series-regression-models.html#cb810-2" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="at">column =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-6-1.png" width="672" /></p>
</div>
</div>
<div id="assumptions" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Assumptions<a href="time-series-regression-models.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The model is a reasonable approximation to reality, the relationship between the forecast variable and the predictor variables satisfies this linear equation.</li>
<li><span class="math inline">\(\varepsilon_t\)</span> have mean zero and are uncorrelated.</li>
<li><span class="math inline">\(\varepsilon_t\)</span> are uncorrelated with aech <span class="math inline">\(x_{j,t}\)</span>.</li>
<li>Errors are normally distributed with constant variance <span class="math inline">\(\sigma^2\)</span> in order to easily produce prediction intervals.</li>
</ul>
</div>
</div>
<div id="least-squares-estimation" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Least squares estimation<a href="time-series-regression-models.html#least-squares-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/least-squares.html">The source of the section</a></p>
<p>The least squares principle provides a way of choosing the coefficients effectively by minimising the sum of the squared errors.</p>
<p><span class="math display">\[
\sum_{t=1}^T \varepsilon_t^2 = \sum_{t=1}^T (y_t - \beta_0 - \beta_1x_{1,t} - \beta_2x_{2,t}-...-- \beta_kx_{k,t})^2
\]</span></p>
<p>Finding the best estimates of the coefficients is colled <strong>fitting</strong> the model to the data, or <strong>learning</strong> or <strong>training</strong> the model.</p>
<div id="example-us-consumption-expenditure-2" class="section level4 hasAnchor" number="7.2.0.1">
<h4><span class="header-section-number">7.2.0.1</span> Example: US consumption expenditure<a href="time-series-regression-models.html#example-us-consumption-expenditure-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
y_t = \beta_0 + \beta_1x_{1,t} + \beta_2x_{2,t} + \beta_3x_{3,t} + \beta_4x_{4,t} + \varepsilon_t
\]</span></p>
<ul>
<li><span class="math inline">\(y\)</span> is the percentage change in real personal consumption expenditure</li>
<li><span class="math inline">\(x_1\)</span> is the percentage change in real personal disposable income</li>
<li><span class="math inline">\(x_2\)</span> is the percentage change in industrial production</li>
<li><span class="math inline">\(x_3\)</span> is the percentage change in personal savings</li>
<li><span class="math inline">\(x_4\)</span> is the change in the unemployment rate</li>
</ul>
<p>Fitting the model.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="time-series-regression-models.html#cb811-1" tabindex="-1"></a>fit_lm <span class="ot">&lt;-</span> us_change <span class="sc">|&gt;</span></span>
<span id="cb811-2"><a href="time-series-regression-models.html#cb811-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">lm =</span> <span class="fu">TSLM</span>(Consumption <span class="sc">~</span> Income <span class="sc">+</span> Production <span class="sc">+</span></span>
<span id="cb811-3"><a href="time-series-regression-models.html#cb811-3" tabindex="-1"></a>                                    Unemployment <span class="sc">+</span> Savings))</span>
<span id="cb811-4"><a href="time-series-regression-models.html#cb811-4" tabindex="-1"></a></span>
<span id="cb811-5"><a href="time-series-regression-models.html#cb811-5" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Consumption 
## Model: TSLM 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.90555 -0.15821 -0.03608  0.13618  1.15471 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.253105   0.034470   7.343 5.71e-12 ***
## Income        0.740583   0.040115  18.461  &lt; 2e-16 ***
## Production    0.047173   0.023142   2.038   0.0429 *  
## Unemployment -0.174685   0.095511  -1.829   0.0689 .  
## Savings      -0.052890   0.002924 -18.088  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3102 on 193 degrees of freedom
## Multiple R-squared: 0.7683,  Adjusted R-squared: 0.7635
## F-statistic:   160 on 4 and 193 DF, p-value: &lt; 2.22e-16</code></pre>
</div>
<div id="fitted-values-1" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Fitted values<a href="time-series-regression-models.html#fitted-values-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Estimated coefficients:</p>
<p><span class="math display">\[
\hat y_t = \hat \beta_0 + \hat \beta_1x_{1,t} + \hat \beta_2x_{2,t} + ... + \hat \beta_kx_{k,t}
\]</span> &gt; <strong>Note!</strong> The predictions of the data used to estimate the model on the training set, not genuine forecasts of future values of <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="time-series-regression-models.html#cb813-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span></span>
<span id="cb813-2"><a href="time-series-regression-models.html#cb813-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb813-3"><a href="time-series-regression-models.html#cb813-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter)) <span class="sc">+</span></span>
<span id="cb813-4"><a href="time-series-regression-models.html#cb813-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Consumption, <span class="at">color =</span> <span class="st">&#39;Actual Values&#39;</span>)) <span class="sc">+</span></span>
<span id="cb813-5"><a href="time-series-regression-models.html#cb813-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> <span class="st">&#39;Fitted Values&#39;</span>)) <span class="sc">+</span></span>
<span id="cb813-6"><a href="time-series-regression-models.html#cb813-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb813-7"><a href="time-series-regression-models.html#cb813-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Percentage change in US consumption expediture&#39;</span>) <span class="sc">+</span></span>
<span id="cb813-8"><a href="time-series-regression-models.html#cb813-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Actual Values&#39;</span> <span class="ot">=</span> <span class="st">&#39;black&#39;</span>, <span class="st">&#39;Fitted Values&#39;</span> <span class="ot">=</span> <span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb813-9"><a href="time-series-regression-models.html#cb813-9" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="time-series-regression-models.html#cb814-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span></span>
<span id="cb814-2"><a href="time-series-regression-models.html#cb814-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb814-3"><a href="time-series-regression-models.html#cb814-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Consumption, <span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb814-4"><a href="time-series-regression-models.html#cb814-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb814-5"><a href="time-series-regression-models.html#cb814-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Fitted (predicted values)&#39;</span>,</span>
<span id="cb814-6"><a href="time-series-regression-models.html#cb814-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Data (actual values)&#39;</span>,</span>
<span id="cb814-7"><a href="time-series-regression-models.html#cb814-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Percent change in US consumption expediture&#39;</span>) <span class="sc">+</span></span>
<span id="cb814-8"><a href="time-series-regression-models.html#cb814-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-9-1.png" width="672" /></p>
</div>
<div id="goodness-of-fit" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Goodness-of-fit<a href="time-series-regression-models.html#goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(R^2\)</span> is the coefficient of determination, which can be calculated as the square of the correlation between the observed <span class="math inline">\(y\)</span> values and the predicted <span class="math inline">\(\hat y\)</span> values.</p>
<p><span class="math display">\[
R^2 = \frac {\sum (\hat y_t - \bar y)^2} {\sum (y_t - \bar y)^2}, R^2 \in [0, 1]
\]</span> &gt; <strong>Important!</strong> The value of <span class="math inline">\(R^2\)</span> will never decrease when adding an extra predictor to the model and this can lead to over-fitting.</p>
<blockquote>
<p>Validating a model’s forecasting performance on the test data is much better than measuring the <span class="math inline">\(R^2\)</span> value on the training data.</p>
</blockquote>
</div>
<div id="standard-error-of-the-regression" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Standard error of the regression<a href="time-series-regression-models.html#standard-error-of-the-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\hat \sigma_e\)</span> is residual standard error.</p>
<p><span class="math display">\[
\hat \sigma_e = \sqrt {\frac 1 {T - k - 1} \sum_{t=1}^T e_t^2}
\]</span></p>
<p>where <span class="math inline">\(k\)</span> in the number of predictors in the model <span class="math inline">\(T-k-1\)</span> because there is estimated <span class="math inline">\(k+1\)</span> parameters (the intercept and a coefficient for each predictor variable)</p>
</div>
</div>
<div id="evaluating-the-regression-model" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Evaluating the regression model<a href="time-series-regression-models.html#evaluating-the-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/regression-evaluation.html">The source of the section</a></p>
<p><span class="math display">\[
e_t = y_t - \hat y_t = y_t - \hat \beta_0 - \hat \beta_1x_{1,t} - \hat \beta_2x_{2,t} - ... - \hat \beta_kx_{k,t}
\]</span> Properties of residuals:</p>
<ul>
<li><span class="math inline">\(\sum_{t=1}^T e_t = 0\)</span> and <span class="math inline">\(\sum_{t=1}^T x_{k,t}e_t = 0\)</span> for all <span class="math inline">\(k\)</span> - <span class="math inline">\(\varepsilon_t\)</span> have mean zero and are uncorrelated, <span class="math inline">\(NID(0, \sigma^2)\)</span></li>
<li><span class="math inline">\(\varepsilon_t\)</span> are uncorrepated with each <span class="math inline">\(x_{j,t}\)</span>
<ul>
<li>Timeplot, ACF, Histogram (<code>gg_tsresiduals()</code>)</li>
<li>Against predictors (non-linearity)</li>
<li>Against fitted values (heteroscedasticity)</li>
<li>Against predictors not in the model (include predictor in the model)</li>
</ul></li>
</ul>
<p>Expect to see scatterplots resembling a horizontal band with no values too far from the band and no patterns such as curvature or increasing spread.</p>
<div id="acf-plot-of-residuals" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> ACF plot of residuals<a href="time-series-regression-models.html#acf-plot-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We should <strong>always</strong> look ar an ACF plot of the residuals to be sure there are no information left in the residual over which we should be accounted for in the model in order to obtain better forecast.</p>
</div>
<div id="histogram-of-residuals" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Histogram of residuals<a href="time-series-regression-models.html#histogram-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We should <strong>always</strong> check whether the residuals are normally distributed using histogram, qq-plot, or/and formal tests. It does make the calculation of prediction intervals much easier.</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="time-series-regression-models.html#cb815-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="time-series-regression-models.html#cb816-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span></span>
<span id="cb816-2"><a href="time-series-regression-models.html#cb816-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb816-3"><a href="time-series-regression-models.html#cb816-3" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model lb_stat lb_pvalue
##   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 lm        18.9    0.0420</code></pre>
<p><strong>Conclusion:</strong></p>
<ul>
<li>Changing variation over time - heteroscedasticity could affect accuracy of prediction intervals</li>
<li>The histogram is slightly skewed</li>
<li>There is significant spike at lag 7.</li>
</ul>
</div>
<div id="residual-plots-against-predictors" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Residual plots against predictors<a href="time-series-regression-models.html#residual-plots-against-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We would expect the residuals to be randomly scattered without showing any systematic patterns.</p>
</blockquote>
<p>Examine scatterplots of the residuals against each of the predictor variables. If the plots show a pattern then there is the relationship is nonlinear.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="time-series-regression-models.html#cb818-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb818-2"><a href="time-series-regression-models.html#cb818-2" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">residuals</span>(fit_lm), <span class="at">by =</span> <span class="st">&#39;Quarter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb818-3"><a href="time-series-regression-models.html#cb818-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Income<span class="sc">:</span>Unemployment, <span class="at">names_to =</span> <span class="st">&#39;regressor&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;x&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb818-4"><a href="time-series-regression-models.html#cb818-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb818-5"><a href="time-series-regression-models.html#cb818-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb818-6"><a href="time-series-regression-models.html#cb818-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> regressor, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="sc">+</span></span>
<span id="cb818-7"><a href="time-series-regression-models.html#cb818-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Residuals&#39;</span>, <span class="at">x =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-12-1.png" width="672" /></p>
<blockquote>
<p><strong>Important!</strong> Plot the residuals against any predictors that are not in the nodel. If any pattern are shown, these predictors are needed to be added to the model.</p>
</blockquote>
</div>
<div id="residual-plots-against-fitted-values" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Residual plots against fitted values<a href="time-series-regression-models.html#residual-plots-against-fitted-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A plot of the residuals against the fitted values should show no pattern, otherwise there may be <strong>heteroscedasticity</strong> in the errors (unconstant variance).</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="time-series-regression-models.html#cb819-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span></span>
<span id="cb819-2"><a href="time-series-regression-models.html#cb819-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb819-3"><a href="time-series-regression-models.html#cb819-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb819-4"><a href="time-series-regression-models.html#cb819-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb819-5"><a href="time-series-regression-models.html#cb819-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Fitted&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Residuals&#39;</span>, <span class="at">title =</span> <span class="st">&#39;Fitted vs Residuals&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-13-1.png" width="672" /></p>
<p>The error are <strong>homoscedastic</strong>.</p>
</div>
<div id="outliers-and-influential-observations" class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Outliers and influential observations<a href="time-series-regression-models.html#outliers-and-influential-observations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Observations that have a large influence on the estimated coefficients of a regression model are called <strong>influential observations</strong>.</p>
</blockquote>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="time-series-regression-models.html#cb820-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb820-2"><a href="time-series-regression-models.html#cb820-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">y =</span> Consumption)) <span class="sc">+</span></span>
<span id="cb820-3"><a href="time-series-regression-models.html#cb820-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb820-4"><a href="time-series-regression-models.html#cb820-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="figure_html/ch07-ts-regression-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="time-series-regression-models.html#cb822-1" tabindex="-1"></a>us_change2 <span class="ot">&lt;-</span> us_change</span>
<span id="cb822-2"><a href="time-series-regression-models.html#cb822-2" tabindex="-1"></a></span>
<span id="cb822-3"><a href="time-series-regression-models.html#cb822-3" tabindex="-1"></a><span class="fu">bind_rows</span>(us_change2,</span>
<span id="cb822-4"><a href="time-series-regression-models.html#cb822-4" tabindex="-1"></a>          us_change2 <span class="sc">|&gt;</span></span>
<span id="cb822-5"><a href="time-series-regression-models.html#cb822-5" tabindex="-1"></a>                  <span class="fu">new_data</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">keep_all =</span> T) <span class="sc">|&gt;</span></span>
<span id="cb822-6"><a href="time-series-regression-models.html#cb822-6" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">Consumption =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">Income =</span> <span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb822-7"><a href="time-series-regression-models.html#cb822-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">y =</span> Consumption)) <span class="sc">+</span></span>
<span id="cb822-8"><a href="time-series-regression-models.html#cb822-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb822-9"><a href="time-series-regression-models.html#cb822-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="figure_html/ch07-ts-regression-15-1.png" width="672" /></p>
</div>
<div id="spurious-regression" class="section level3 hasAnchor" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Spurious regression<a href="time-series-regression-models.html#spurious-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="time-series-regression-models.html#cb824-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb824-2"><a href="time-series-regression-models.html#cb824-2" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;=</span> <span class="dv">2011</span>) <span class="sc">|&gt;</span></span>
<span id="cb824-3"><a href="time-series-regression-models.html#cb824-3" tabindex="-1"></a>  <span class="fu">left_join</span>(guinea_rice, <span class="at">by =</span> <span class="st">&#39;Year&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb824-4"><a href="time-series-regression-models.html#cb824-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Passengers <span class="sc">~</span> Production))</span>
<span id="cb824-5"><a href="time-series-regression-models.html#cb824-5" tabindex="-1"></a></span>
<span id="cb824-6"><a href="time-series-regression-models.html#cb824-6" tabindex="-1"></a><span class="fu">report</span>(fit)</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: TSLM 
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.9448 -1.8917 -0.3272  1.8620 10.4210 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -7.493      1.203  -6.229 2.25e-07 ***
## Production    40.288      1.337  30.135  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.239 on 40 degrees of freedom
## Multiple R-squared: 0.9578,  Adjusted R-squared: 0.9568
## F-statistic: 908.1 on 1 and 40 DF, p-value: &lt; 2.22e-16</code></pre>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="time-series-regression-models.html#cb826-1" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb826-2"><a href="time-series-regression-models.html#cb826-2" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-17-1.png" width="672" /></p>
</div>
</div>
<div id="some-useful-predictors" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Some useful predictors<a href="time-series-regression-models.html#some-useful-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/useful-predictors.html">The source of the section</a></p>
<div id="trend" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Trend<a href="time-series-regression-models.html#trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear trend:</p>
<ul>
<li><span class="math inline">\(t = 1, 2, ..., T\)</span></li>
<li>Using <span class="math inline">\(x_{1,t} = t\)</span> as predictor</li>
<li>Trend variable can be specified by <code>trend()</code> in the <code>TSLM()</code></li>
<li>Strong assumption that trend will continue</li>
</ul>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="time-series-regression-models.html#cb827-1" tabindex="-1"></a>aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb827-2"><a href="time-series-regression-models.html#cb827-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Passengers <span class="sc">~</span> <span class="fu">trend</span>())) <span class="sc">|&gt;</span></span>
<span id="cb827-3"><a href="time-series-regression-models.html#cb827-3" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb827-4"><a href="time-series-regression-models.html#cb827-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Passengers) <span class="sc">+</span></span>
<span id="cb827-5"><a href="time-series-regression-models.html#cb827-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb827-6"><a href="time-series-regression-models.html#cb827-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Linear trend of number of air passengers in Australia&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-18-1.png" width="672" /></p>
</div>
<div id="dummy-variables" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Dummy variables<a href="time-series-regression-models.html#dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To make numerical variable from categorical variable use dummy variable which takes 1 if <strong>yeas</strong> and 0 if <strong>no</strong>. To remove the effect of outliers, for example if special event has occured, saying the Rio de Janeiro summer Olympics in 2016, the dummy variable takes value 1 for the observations which have overlapped with the games and 0 everywhere else.</p>
<blockquote>
<p><code>TSLM()</code> will automatically handle this case if you specify a factor variable as a predictor.</p>
</blockquote>
</div>
<div id="seasonal-dummy-variables" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Seasonal dummy variables<a href="time-series-regression-models.html#seasonal-dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For quarterly data.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th><span class="math inline">\(d_{1, t}\)</span></th>
<th><span class="math inline">\(d_{2, t}\)</span></th>
<th><span class="math inline">\(d_{3, t}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Q1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td align="left">Q2</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td align="left">Q3</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td align="left">Q4</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td align="left">Q1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>The interpretation of each of the coefficients associated with the dummy variables is that it is a measure of the effect of that category relative to the omitted category. In the above example, the coefficient of <span class="math inline">\(d_{1,t}\)</span> associated with Q1 will measure the effect of Q1 on the forecast variable compared to the effect of Q4 (omitted dummy variable).</p>
<p>The model using a linear trend and quarterly dummy variables.</p>
<p><span class="math display">\[
y_t = \beta_0 + \beta_1t + \beta_2d_{2, t} + \beta_3d_{3, t} + \beta_4d_{4, t} + \varepsilon_t
\]</span></p>
<p>where <span class="math inline">\(d_{i, t} = 1\)</span> if <span class="math inline">\(t\)</span> is in quarter <span class="math inline">\(i\)</span> and 0 otherwise.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="time-series-regression-models.html#cb828-1" tabindex="-1"></a>recent_production <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb828-2"><a href="time-series-regression-models.html#cb828-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>)</span>
<span id="cb828-3"><a href="time-series-regression-models.html#cb828-3" tabindex="-1"></a></span>
<span id="cb828-4"><a href="time-series-regression-models.html#cb828-4" tabindex="-1"></a>recent_production <span class="sc">|&gt;</span></span>
<span id="cb828-5"><a href="time-series-regression-models.html#cb828-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Beer) <span class="sc">+</span></span>
<span id="cb828-6"><a href="time-series-regression-models.html#cb828-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Megalitres&#39;</span>,</span>
<span id="cb828-7"><a href="time-series-regression-models.html#cb828-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Australian quarterly beer production&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="time-series-regression-models.html#cb829-1" tabindex="-1"></a>fit_beer <span class="ot">&lt;-</span> recent_production <span class="sc">|&gt;</span></span>
<span id="cb829-2"><a href="time-series-regression-models.html#cb829-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>()))</span>
<span id="cb829-3"><a href="time-series-regression-models.html#cb829-3" tabindex="-1"></a></span>
<span id="cb829-4"><a href="time-series-regression-models.html#cb829-4" tabindex="-1"></a><span class="fu">report</span>(fit_beer)</span></code></pre></div>
<pre><code>## Series: Beer 
## Model: TSLM 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -42.9029  -7.5995  -0.4594   7.9908  21.7895 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   441.80044    3.73353 118.333  &lt; 2e-16 ***
## trend()        -0.34027    0.06657  -5.111 2.73e-06 ***
## season()year2 -34.65973    3.96832  -8.734 9.10e-13 ***
## season()year3 -17.82164    4.02249  -4.430 3.45e-05 ***
## season()year4  72.79641    4.02305  18.095  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.23 on 69 degrees of freedom
## Multiple R-squared: 0.9243,  Adjusted R-squared: 0.9199
## F-statistic: 210.7 on 4 and 69 DF, p-value: &lt; 2.22e-16</code></pre>
<p><strong>Interpretation:</strong> The first quarter variable has been omitted, so the coefficients associated with the other quarters are measures of the difference between those quarters and the first quarter. There is an average downward trend of -0.34 megalitres per quarter. On average, the second quarter has production of 34.7 megalitres lower than the first quarter, the third quarter has production of 17.8 megalitres lower than the first quarter, and the fourth quarter has production of 72.8 megalitres higher than the first quarter.</p>
<div id="beware-of-using-dummy-variables" class="section level4 hasAnchor" number="7.4.3.1">
<h4><span class="header-section-number">7.4.3.1</span> Beware of using dummy variables<a href="time-series-regression-models.html#beware-of-using-dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Using one dummy for each category gives too many dummy variables</li>
<li>The regression will then be singular and inestimable</li>
<li>Either omit the constant, or omit the dummy for one category</li>
<li>The coefficients of the dummies are relative to the omitted category</li>
</ul>
</div>
<div id="example" class="section level4 hasAnchor" number="7.4.3.2">
<h4><span class="header-section-number">7.4.3.2</span> Example<a href="time-series-regression-models.html#example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="time-series-regression-models.html#cb831-1" tabindex="-1"></a>fit_beer <span class="sc">|&gt;</span></span>
<span id="cb831-2"><a href="time-series-regression-models.html#cb831-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb831-3"><a href="time-series-regression-models.html#cb831-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter)) <span class="sc">+</span></span>
<span id="cb831-4"><a href="time-series-regression-models.html#cb831-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Beer, <span class="at">color =</span> <span class="st">&#39;Data&#39;</span>)) <span class="sc">+</span></span>
<span id="cb831-5"><a href="time-series-regression-models.html#cb831-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> <span class="st">&#39;Fitted&#39;</span>)) <span class="sc">+</span></span>
<span id="cb831-6"><a href="time-series-regression-models.html#cb831-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Data =</span> <span class="st">&#39;black&#39;</span>, <span class="at">Fitted =</span> <span class="st">&#39;orange&#39;</span>)) <span class="sc">+</span></span>
<span id="cb831-7"><a href="time-series-regression-models.html#cb831-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Megalitres&#39;</span>,</span>
<span id="cb831-8"><a href="time-series-regression-models.html#cb831-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Australian quarterly beer production&#39;</span>) <span class="sc">+</span></span>
<span id="cb831-9"><a href="time-series-regression-models.html#cb831-9" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&#39;Series&#39;</span>))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="time-series-regression-models.html#cb832-1" tabindex="-1"></a>fit_beer <span class="sc">|&gt;</span></span>
<span id="cb832-2"><a href="time-series-regression-models.html#cb832-2" tabindex="-1"></a><span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb832-3"><a href="time-series-regression-models.html#cb832-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Beer, <span class="at">y =</span> .fitted,</span>
<span id="cb832-4"><a href="time-series-regression-models.html#cb832-4" tabindex="-1"></a>             <span class="at">color =</span> <span class="fu">factor</span>(<span class="fu">quarter</span>(Quarter)))) <span class="sc">+</span></span>
<span id="cb832-5"><a href="time-series-regression-models.html#cb832-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb832-6"><a href="time-series-regression-models.html#cb832-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Fitted&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Actual values&quot;</span>,</span>
<span id="cb832-7"><a href="time-series-regression-models.html#cb832-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Australian quarterly beer production&quot;</span>) <span class="sc">+</span></span>
<span id="cb832-8"><a href="time-series-regression-models.html#cb832-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb832-9"><a href="time-series-regression-models.html#cb832-9" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Quarter&quot;</span>))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-22-1.png" width="672" /></p>
</div>
<div id="uses-of-dummy-variables" class="section level4 hasAnchor" number="7.4.3.3">
<h4><span class="header-section-number">7.4.3.3</span> Uses of dummy variables<a href="time-series-regression-models.html#uses-of-dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Seasonal dummies</strong></p>
<ul>
<li>For <strong>quarterly</strong> data use <strong>3</strong> dummies</li>
<li>For <strong>monthly</strong> data use <strong>11</strong> dummies</li>
<li>For <strong>daily</strong> data use <strong>6</strong> dummies</li>
<li>For <strong>weekly</strong> data <strong>DO NOT USE</strong> dummies, use <a href="time-series-regression-models.html#fourier">Fourier</a> instead.</li>
</ul>
<p><strong>Outliers</strong></p>
<ul>
<li>If there is an outlier, use a dummy variable to remove its effect.</li>
</ul>
<p><strong>Public holidays</strong></p>
<ul>
<li>For daily data: if it is a public holiday, dummy = 1, otherwise dummy = 0</li>
</ul>
</div>
</div>
<div id="intervention-variables" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Intervention variables<a href="time-series-regression-models.html#intervention-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Spikes</strong><br />
</p>
<p>Equivalent to a dummy variable for handling an outlier.</p>
<div class="float">
<img src="pics/spikes.png" alt="Outlier dummy variable" />
<div class="figcaption">Outlier dummy variable</div>
</div>
<p><strong>Steps</strong><br />
</p>
<p>Variable takes value 0 before the intervention and 1 afterwards.</p>
<p><img src="pics/steps.png" alt="Steps dummy variable" /> <strong>Change of slope</strong><br />
</p>
<p>Variables take values 0 before the intervention and values {1, 2, 3, …} afterwards.</p>
<div class="float">
<img src="pics/slope.png" alt="Change of slope dummy variable" />
<div class="figcaption">Change of slope dummy variable</div>
</div>
<p>###Holidays</p>
<p><strong>For monthly data</strong><br />
</p>
<ul>
<li>Christmas: always in December so part of monthly seasonal effect</li>
<li>Easter: use a dummy variable <span class="math inline">\(v_t = 1\)</span> if any part of Easter is in that month, <span class="math inline">\(v_t = 0\)</span> otherwise.</li>
<li>Ramadan and Chinese new year similar</li>
</ul>
<blockquote>
<p><strong>Important!</strong> If the public holiday starts in one month and finishes in the another, the dummy variable is split proportionally between months.</p>
</blockquote>
</div>
<div id="trading-days" class="section level3 hasAnchor" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Trading days<a href="time-series-regression-models.html#trading-days" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The number of trading days in each month can be included as a predictor</li>
<li>Alternative:
<ul>
<li><span class="math inline">\(x_1\)</span> = number of Mondays in month</li>
<li><span class="math inline">\(x_2\)</span> = number of Tuesdays in month</li>
<li><span class="math inline">\(x_3\)</span> = number of Wednesday in month</li>
<li><span class="math inline">\(x_4\)</span> = number of Thursday in month</li>
<li><span class="math inline">\(x_5\)</span> = number of Friday in month</li>
<li><span class="math inline">\(x_6\)</span> = number of Saturday in month</li>
<li><span class="math inline">\(x_7\)</span> = number of Sunday in month</li>
</ul></li>
</ul>
</div>
<div id="distributed-lags" class="section level3 hasAnchor" number="7.4.6">
<h3><span class="header-section-number">7.4.6</span> Distributed lags<a href="time-series-regression-models.html#distributed-lags" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the effect of advertising can last beyond the actual campaign, we need to include lagged values of advertising expenditure.</p>
<ul>
<li><span class="math inline">\(x_1\)</span> = advertising for previous month</li>
<li><span class="math inline">\(x_2\)</span> = advertising for two months previously</li>
<li>…</li>
<li><span class="math inline">\(x_2\)</span> = advertising for <span class="math inline">\(m\)</span> months previously</li>
</ul>
<p><a id="fourier"></a> ### Fourier series</p>
<ul>
<li>For long seasonal perions</li>
<li>An alternative to using seasonal dummy variables</li>
</ul>
<p>If <span class="math inline">\(m\)</span> is the seasonal pattern, then</p>
<p><span class="math display">\[
x_{1,t} = sin\left(\frac {2\pi t} m \right), x_{2,t} = cos \left( \frac {2\pi t} m \right), \\
x_{3,t} = sin\left(\frac {4\pi t} m \right), x_{4,t} = cos \left( \frac {4\pi t} m \right), \\
x_{5,t} = sin\left(\frac {6\pi t} m \right), x_{6,t} = cos \left( \frac {6\pi t} m \right), \\
\]</span></p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="time-series-regression-models.html#cb833-1" tabindex="-1"></a>recent_production <span class="sc">|&gt;</span></span>
<span id="cb833-2"><a href="time-series-regression-models.html#cb833-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">fourier</span>(<span class="at">K =</span> <span class="dv">2</span>))) <span class="sc">|&gt;</span></span>
<span id="cb833-3"><a href="time-series-regression-models.html#cb833-3" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Beer 
## Model: TSLM 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -42.9029  -7.5995  -0.4594   7.9908  21.7895 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        446.87920    2.87321 155.533  &lt; 2e-16 ***
## trend()             -0.34027    0.06657  -5.111 2.73e-06 ***
## fourier(K = 2)C1_4   8.91082    2.01125   4.430 3.45e-05 ***
## fourier(K = 2)S1_4 -53.72807    2.01125 -26.714  &lt; 2e-16 ***
## fourier(K = 2)C2_4 -13.98958    1.42256  -9.834 9.26e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.23 on 69 degrees of freedom
## Multiple R-squared: 0.9243,  Adjusted R-squared: 0.9199
## F-statistic: 210.7 on 4 and 69 DF, p-value: &lt; 2.22e-16</code></pre>
<p><span class="math inline">\(K = m/2\)</span>, where <span class="math inline">\(m\)</span> is the seasonal period. Using maximum allowed <span class="math inline">\(K\)</span> produces the results that are identical to those when using seasonal dummy variables.</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="time-series-regression-models.html#cb835-1" tabindex="-1"></a>recent_production <span class="sc">|&gt;</span></span>
<span id="cb835-2"><a href="time-series-regression-models.html#cb835-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">trend_season_linear_regression =</span> <span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>()),</span>
<span id="cb835-3"><a href="time-series-regression-models.html#cb835-3" tabindex="-1"></a>        <span class="at">harmonic_regression =</span> <span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">fourier</span>(<span class="at">K =</span> <span class="dv">2</span>))) <span class="sc">|&gt;</span></span>
<span id="cb835-4"><a href="time-series-regression-models.html#cb835-4" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Warning in report.mdl_df(model(recent_production, trend_season_linear_regression = TSLM(Beer ~ : Model reporting is only supported for individual models, so a glance
## will be shown. To see the report for a specific model, use `select()` and `filter()` to identify a single model.</code></pre>
<pre><code>## # A tibble: 2 × 15
##   .model                         r_squared adj_r_squared sigma2 statistic  p_value    df log_lik   AIC  AICc   BIC    CV deviance df.residual  rank
##   &lt;chr&gt;                              &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
## 1 trend_season_linear_regression     0.924         0.920   150.      211. 6.97e-38     5   -288.  377.  379.  391.  160.   10320.          69     5
## 2 harmonic_regression                0.924         0.920   150.      211. 6.97e-38     5   -288.  377.  379.  391.  160.   10320.          69     5</code></pre>
</div>
</div>
<div id="selecting-predictors" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Selecting predictors<a href="time-series-regression-models.html#selecting-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/selecting-predictors.html">The source of the section</a></p>
<p>The measures of predictive accuracy which can be used to find the best model:</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="time-series-regression-models.html#cb838-1" tabindex="-1"></a>fit_lm <span class="sc">|&gt;</span></span>
<span id="cb838-2"><a href="time-series-regression-models.html#cb838-2" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">|&gt;</span></span>
<span id="cb838-3"><a href="time-series-regression-models.html#cb838-3" tabindex="-1"></a>  <span class="fu">select</span>(adj_r_squared, CV, AIC, AICc, BIC)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   adj_r_squared    CV   AIC  AICc   BIC
##           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1         0.763 0.104 -457. -456. -437.</code></pre>
<div id="adjusted-r2" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Adjusted <span class="math inline">\(R^2\)</span><a href="time-series-regression-models.html#adjusted-r2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(R^2\)</span> (coefficient of determination) measures how well the model fits the historical data, but not well the model will forecast future data.</p>
<p><span class="math display">\[
R^2 = \frac {\sum (\hat y_t - \bar y)^2} {\sum (y_t - \bar y)^2}
\]</span></p>
<p>Minimising the SSE is equivalent to maximising <span class="math inline">\(R^2\)</span>. It is <strong>not</strong> a valid way of selecting predictors.</p>
<p><span class="math display">\[
SSE = \sum_{t=1}^T e_t^2
\]</span>
Adjusted <span class="math inline">\(R^2\)</span> (<span class="math inline">\(\bar R^2\)</span>) will no longer increase with each added predictor.</p>
<p><span class="math display">\[
Adj. R^2 = \bar R^2 = 1 - (1-R^2)\frac {T-1} {T-k-1}
\]</span></p>
<p>where <span class="math inline">\(T\)</span> is the number of observations, <span class="math inline">\(k\)</span> is the number of predictors. Maximising <span class="math inline">\(\bar R^2\)</span> is equivalent to minimising the standard error <span class="math inline">\(\hat \sigma^2\)</span>.</p>
</div>
<div id="cross-validation" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Cross-validation<a href="time-series-regression-models.html#cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Remove observation <span class="math inline">\(t\)</span> from the data set, and fit the model using the remaining data.Then compute the error (<span class="math inline">\(e_t^* = y_t - \hat y_t\)</span>) for the omitted observation.</li>
<li>Repeat step 1 for <span class="math inline">\(t = 1,2,...,T\)</span></li>
<li>Compute the MSE from <span class="math inline">\(e_1^*,...,e_T^*\)</span> - CV</li>
</ol>
<blockquote>
<p><strong>Note!</strong> The best model is the one with the smallest value of CV</p>
</blockquote>
</div>
<div id="akaikes-information-criterion" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Akaike’s Information Criterion<a href="time-series-regression-models.html#akaikes-information-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
AIC = T \times log \left( \frac {SSE} T\right) + 2(k + 2)
\]</span>
where <span class="math inline">\(T\)</span> is the number of observations used for estimation and <span class="math inline">\(k\)</span> is the number of predictors in the model.</p>
<blockquote>
<p><strong>Note!</strong> The model with the minimum value of the AIC is often the best model for forecasting. For large values of <span class="math inline">\(T\)</span>, minimising the AIC is equivalent to minimising the CV value.</p>
</blockquote>
</div>
<div id="corrected-akaikes-information-criterion" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Corrected Akaike’s Information Criterion<a href="time-series-regression-models.html#corrected-akaikes-information-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
AIC_c = AIC + \frac {2(k+1)(k+3)} {T-k-3}
\]</span>
&gt; <strong>Note!</strong> The model with the minimum value of the <span class="math inline">\(AIC_c\)</span> is often the best model for forecasting.</p>
</div>
<div id="schwarzs-bayesian-information-criterion" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Schwarz’s Bayesian Information Criterion<a href="time-series-regression-models.html#schwarzs-bayesian-information-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
BIC = T \times log \left( \frac {SSE} T \right) + (k+2) \times log (T)
\]</span>
&gt; <strong>Note!</strong> The model with the minimum value of the <span class="math inline">\(BIC\)</span> is often the best model for forecasting.</p>
</div>
<div id="stepwise-regression" class="section level3 hasAnchor" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Stepwise regression<a href="time-series-regression-models.html#stepwise-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Backwards stepwise regression:</strong></p>
<ul>
<li>Start with the model containing all potential predictors.</li>
<li>Remove one predictor at a time. Keep the model if it improves the measure of predictive accuracy.</li>
<li>Iterate until no further improvement.</li>
</ul>
<p>If the number of predictors is too large, use <strong>forward stepwise regression</strong> instead.</p>
<ul>
<li>Start with a model that includes only the intercept.</li>
<li>Predictors are added one at a time, and the one that most improves the measure of predictive accuracy is retained in the model.</li>
<li>The procedure is repeated until no further improvement can be achieved.</li>
</ul>
<blockquote>
<p><strong>Note!</strong> Any stepwise approach is not guaranteed to lead to the best possible model, but it almost always leads to a good model.</p>
</blockquote>
</div>
</div>
<div id="forecasting-with-regression" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Forecasting with regression<a href="time-series-regression-models.html#forecasting-with-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/forecasting-regression.html">The source of the section</a></p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="time-series-regression-models.html#cb840-1" tabindex="-1"></a>recent_production <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb840-2"><a href="time-series-regression-models.html#cb840-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) </span>
<span id="cb840-3"><a href="time-series-regression-models.html#cb840-3" tabindex="-1"></a></span>
<span id="cb840-4"><a href="time-series-regression-models.html#cb840-4" tabindex="-1"></a>fit_beer <span class="ot">&lt;-</span> recent_production <span class="sc">|&gt;</span></span>
<span id="cb840-5"><a href="time-series-regression-models.html#cb840-5" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Beer <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>()))</span>
<span id="cb840-6"><a href="time-series-regression-models.html#cb840-6" tabindex="-1"></a></span>
<span id="cb840-7"><a href="time-series-regression-models.html#cb840-7" tabindex="-1"></a>fc_beer <span class="ot">&lt;-</span> fit_beer <span class="sc">|&gt;</span> <span class="fu">forecast</span>()</span>
<span id="cb840-8"><a href="time-series-regression-models.html#cb840-8" tabindex="-1"></a></span>
<span id="cb840-9"><a href="time-series-regression-models.html#cb840-9" tabindex="-1"></a>fc_beer <span class="sc">|&gt;</span></span>
<span id="cb840-10"><a href="time-series-regression-models.html#cb840-10" tabindex="-1"></a>  <span class="fu">autoplot</span>(recent_production) <span class="sc">+</span></span>
<span id="cb840-11"><a href="time-series-regression-models.html#cb840-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb840-12"><a href="time-series-regression-models.html#cb840-12" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Forecasts of beer production using regression&quot;</span>,</span>
<span id="cb840-13"><a href="time-series-regression-models.html#cb840-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;megalitres&quot;</span></span>
<span id="cb840-14"><a href="time-series-regression-models.html#cb840-14" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-26-1.png" width="672" /></p>
<div id="scenario-based-forecasting" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Scenario based forecasting<a href="time-series-regression-models.html#scenario-based-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="time-series-regression-models.html#cb841-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> us_change <span class="sc">|&gt;</span></span>
<span id="cb841-2"><a href="time-series-regression-models.html#cb841-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb841-3"><a href="time-series-regression-models.html#cb841-3" tabindex="-1"></a>     <span class="at">lm =</span> <span class="fu">TSLM</span>(Consumption <span class="sc">~</span> Income <span class="sc">+</span> Savings <span class="sc">+</span> Unemployment)</span>
<span id="cb841-4"><a href="time-series-regression-models.html#cb841-4" tabindex="-1"></a>  )</span>
<span id="cb841-5"><a href="time-series-regression-models.html#cb841-5" tabindex="-1"></a></span>
<span id="cb841-6"><a href="time-series-regression-models.html#cb841-6" tabindex="-1"></a>future_scenarios <span class="ot">&lt;-</span> <span class="fu">scenarios</span>(</span>
<span id="cb841-7"><a href="time-series-regression-models.html#cb841-7" tabindex="-1"></a>  <span class="at">Increase =</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb841-8"><a href="time-series-regression-models.html#cb841-8" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="dv">1</span>, <span class="at">Savings =</span> <span class="fl">0.5</span>, <span class="at">Unemployment =</span> <span class="dv">0</span>),</span>
<span id="cb841-9"><a href="time-series-regression-models.html#cb841-9" tabindex="-1"></a>  <span class="at">Decrease =</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb841-10"><a href="time-series-regression-models.html#cb841-10" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">Savings =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">Unemployment =</span> <span class="dv">0</span>),</span>
<span id="cb841-11"><a href="time-series-regression-models.html#cb841-11" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&#39;Scenario&#39;</span></span>
<span id="cb841-12"><a href="time-series-regression-models.html#cb841-12" tabindex="-1"></a>)</span>
<span id="cb841-13"><a href="time-series-regression-models.html#cb841-13" tabindex="-1"></a></span>
<span id="cb841-14"><a href="time-series-regression-models.html#cb841-14" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">new_data =</span> future_scenarios)</span>
<span id="cb841-15"><a href="time-series-regression-models.html#cb841-15" tabindex="-1"></a></span>
<span id="cb841-16"><a href="time-series-regression-models.html#cb841-16" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb841-17"><a href="time-series-regression-models.html#cb841-17" tabindex="-1"></a>  <span class="fu">autoplot</span>(Consumption) <span class="sc">+</span></span>
<span id="cb841-18"><a href="time-series-regression-models.html#cb841-18" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc) <span class="sc">+</span></span>
<span id="cb841-19"><a href="time-series-regression-models.html#cb841-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US consumption&quot;</span>, <span class="at">y =</span> <span class="st">&quot;% change&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-27-1.png" width="672" /></p>
</div>
<div id="prediction-intervals-1" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Prediction intervals<a href="time-series-regression-models.html#prediction-intervals-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="time-series-regression-models.html#cb842-1" tabindex="-1"></a>fit_cons <span class="ot">&lt;-</span> us_change <span class="sc">|&gt;</span></span>
<span id="cb842-2"><a href="time-series-regression-models.html#cb842-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Consumption <span class="sc">~</span> Income))</span>
<span id="cb842-3"><a href="time-series-regression-models.html#cb842-3" tabindex="-1"></a>new_cons <span class="ot">&lt;-</span> <span class="fu">scenarios</span>(</span>
<span id="cb842-4"><a href="time-series-regression-models.html#cb842-4" tabindex="-1"></a>  <span class="st">&quot;Average increase&quot;</span> <span class="ot">=</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb842-5"><a href="time-series-regression-models.html#cb842-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">mean</span>(us_change<span class="sc">$</span>Income)),</span>
<span id="cb842-6"><a href="time-series-regression-models.html#cb842-6" tabindex="-1"></a>  <span class="st">&quot;Extreme increase&quot;</span> <span class="ot">=</span> <span class="fu">new_data</span>(us_change, <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb842-7"><a href="time-series-regression-models.html#cb842-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="dv">12</span>),</span>
<span id="cb842-8"><a href="time-series-regression-models.html#cb842-8" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;Scenario&quot;</span></span>
<span id="cb842-9"><a href="time-series-regression-models.html#cb842-9" tabindex="-1"></a>)</span>
<span id="cb842-10"><a href="time-series-regression-models.html#cb842-10" tabindex="-1"></a>fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_cons, new_cons)</span>
<span id="cb842-11"><a href="time-series-regression-models.html#cb842-11" tabindex="-1"></a></span>
<span id="cb842-12"><a href="time-series-regression-models.html#cb842-12" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb842-13"><a href="time-series-regression-models.html#cb842-13" tabindex="-1"></a>  <span class="fu">autoplot</span>(Consumption) <span class="sc">+</span></span>
<span id="cb842-14"><a href="time-series-regression-models.html#cb842-14" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcast) <span class="sc">+</span></span>
<span id="cb842-15"><a href="time-series-regression-models.html#cb842-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US consumption&quot;</span>, <span class="at">y =</span> <span class="st">&quot;% change&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-28-1.png" width="672" /></p>
</div>
</div>
<div id="nonlinear-regression" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Nonlinear regression<a href="time-series-regression-models.html#nonlinear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/nonlinear-regression.html">The source of the section</a></p>
<p>Non-linear regression:
<span class="math display">\[
ln(y) = \beta_0 + \beta_1ln(x) +\varepsilon
\]</span></p>
<p><span class="math inline">\(\beta_1\)</span> is the average percentage change in <span class="math inline">\(y\)</span> resulting from a 1% increaqsing in <span class="math inline">\(x\)</span>.
In the case what variable <span class="math inline">\(x\)</span> contains zeros, we use the transformation <span class="math inline">\(ln(x+1)\)</span>.</p>
<div id="forecasting-with-a-nonlinear-trend" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Forecasting with a nonlinear trend<a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="time-series-regression-models.html#cb843-1" tabindex="-1"></a>boston_men <span class="ot">&lt;-</span> boston_marathon <span class="sc">|&gt;</span></span>
<span id="cb843-2"><a href="time-series-regression-models.html#cb843-2" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1924</span>) <span class="sc">|&gt;</span></span>
<span id="cb843-3"><a href="time-series-regression-models.html#cb843-3" tabindex="-1"></a>  <span class="fu">filter</span>(Event <span class="sc">==</span> <span class="st">&quot;Men&#39;s open division&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb843-4"><a href="time-series-regression-models.html#cb843-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Minutes =</span> <span class="fu">as.numeric</span>(Time)<span class="sc">/</span><span class="dv">60</span>)</span>
<span id="cb843-5"><a href="time-series-regression-models.html#cb843-5" tabindex="-1"></a></span>
<span id="cb843-6"><a href="time-series-regression-models.html#cb843-6" tabindex="-1"></a><span class="co"># linear trend</span></span>
<span id="cb843-7"><a href="time-series-regression-models.html#cb843-7" tabindex="-1"></a>boston_men <span class="sc">|&gt;</span></span>
<span id="cb843-8"><a href="time-series-regression-models.html#cb843-8" tabindex="-1"></a>  <span class="fu">autoplot</span>(Minutes) <span class="sc">+</span></span>
<span id="cb843-9"><a href="time-series-regression-models.html#cb843-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb843-10"><a href="time-series-regression-models.html#cb843-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Boston marathon winning times&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="figure_html/ch07-ts-regression-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="time-series-regression-models.html#cb845-1" tabindex="-1"></a><span class="co"># residuals from linear trend</span></span>
<span id="cb845-2"><a href="time-series-regression-models.html#cb845-2" tabindex="-1"></a>boston_men <span class="sc">|&gt;</span></span>
<span id="cb845-3"><a href="time-series-regression-models.html#cb845-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Minutes <span class="sc">~</span> <span class="fu">trend</span>())) <span class="sc">|&gt;</span></span>
<span id="cb845-4"><a href="time-series-regression-models.html#cb845-4" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb845-5"><a href="time-series-regression-models.html#cb845-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Residuals from a linear trend&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="time-series-regression-models.html#cb846-1" tabindex="-1"></a><span class="co"># exponential trend</span></span>
<span id="cb846-2"><a href="time-series-regression-models.html#cb846-2" tabindex="-1"></a>fit_exp <span class="ot">&lt;-</span> boston_men <span class="sc">|&gt;</span></span>
<span id="cb846-3"><a href="time-series-regression-models.html#cb846-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(<span class="fu">log</span>(Minutes) <span class="sc">~</span> <span class="fu">trend</span>()))</span>
<span id="cb846-4"><a href="time-series-regression-models.html#cb846-4" tabindex="-1"></a>  </span>
<span id="cb846-5"><a href="time-series-regression-models.html#cb846-5" tabindex="-1"></a>fit_exp <span class="sc">|&gt;</span> </span>
<span id="cb846-6"><a href="time-series-regression-models.html#cb846-6" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb846-7"><a href="time-series-regression-models.html#cb846-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(Minutes) <span class="sc">+</span></span>
<span id="cb846-8"><a href="time-series-regression-models.html#cb846-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb846-9"><a href="time-series-regression-models.html#cb846-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Boston marathon winning times (exp trend)&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="time-series-regression-models.html#cb847-1" tabindex="-1"></a>fit_exp <span class="sc">|&gt;</span></span>
<span id="cb847-2"><a href="time-series-regression-models.html#cb847-2" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb847-3"><a href="time-series-regression-models.html#cb847-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Residuals from an exponential trend&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-32-1.png" width="672" />
### Piacewise regression</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="time-series-regression-models.html#cb848-1" tabindex="-1"></a>fit_trends <span class="ot">&lt;-</span> boston_men <span class="sc">|&gt;</span></span>
<span id="cb848-2"><a href="time-series-regression-models.html#cb848-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb848-3"><a href="time-series-regression-models.html#cb848-3" tabindex="-1"></a>    <span class="at">linear =</span> <span class="fu">TSLM</span>(Minutes <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb848-4"><a href="time-series-regression-models.html#cb848-4" tabindex="-1"></a>    <span class="at">exponential =</span> <span class="fu">TSLM</span>(<span class="fu">log</span>(Minutes) <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb848-5"><a href="time-series-regression-models.html#cb848-5" tabindex="-1"></a>    <span class="at">piecewise =</span> <span class="fu">TSLM</span>(Minutes <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">1950</span>, <span class="dv">1980</span>)))</span>
<span id="cb848-6"><a href="time-series-regression-models.html#cb848-6" tabindex="-1"></a>  )</span>
<span id="cb848-7"><a href="time-series-regression-models.html#cb848-7" tabindex="-1"></a>fc_trends <span class="ot">&lt;-</span> fit_trends <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>)</span>
<span id="cb848-8"><a href="time-series-regression-models.html#cb848-8" tabindex="-1"></a></span>
<span id="cb848-9"><a href="time-series-regression-models.html#cb848-9" tabindex="-1"></a>boston_men <span class="sc">|&gt;</span></span>
<span id="cb848-10"><a href="time-series-regression-models.html#cb848-10" tabindex="-1"></a>  <span class="fu">autoplot</span>(Minutes) <span class="sc">+</span></span>
<span id="cb848-11"><a href="time-series-regression-models.html#cb848-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">fitted</span>(fit_trends),</span>
<span id="cb848-12"><a href="time-series-regression-models.html#cb848-12" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">colour =</span> .model)) <span class="sc">+</span></span>
<span id="cb848-13"><a href="time-series-regression-models.html#cb848-13" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc_trends, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb848-14"><a href="time-series-regression-models.html#cb848-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Minutes&quot;</span>,</span>
<span id="cb848-15"><a href="time-series-regression-models.html#cb848-15" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Boston marathon winning times&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-33-1.png" width="672" /></p>
</div>
</div>
<div id="correlation-causation-and-forecasting" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Correlation, causation and forecasting<a href="time-series-regression-models.html#correlation-causation-and-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/causality.html">The source of the section</a></p>
<div id="correlation-is-not-causation" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Correlation is not causation<a href="time-series-regression-models.html#correlation-is-not-causation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is important not to confuse correlation with causation, or causation with forecasting. A variable <span class="math inline">\(x\)</span> may be useful for forecasting a variable <span class="math inline">\(y\)</span> , but that does not mean <span class="math inline">\(x\)</span> is causing <span class="math inline">\(y\)</span>. It is possible that <span class="math inline">\(x\)</span> is causing <span class="math inline">\(y\)</span> , but it may be that <span class="math inline">\(y\)</span> is causing <span class="math inline">\(x\)</span> , or that the relationship between them is more complicated than simple causality.</p>
</div>
<div id="forecasting-with-correlated-predictors" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> Forecasting with correlated predictors<a href="time-series-regression-models.html#forecasting-with-correlated-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When two or more predictors are highly correlated it is always challenging to accurately separate their individual effects. Having correlated predictors is not really a problem for forecasting, as we can still compute forecasts without needing to separate out the effects of the predictors.</p>
</div>
<div id="multicollinearity-and-forecasting" class="section level3 hasAnchor" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> Multicollinearity and forecasting<a href="time-series-regression-models.html#multicollinearity-and-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A closely related issue is multicollinearity, which occurs when similar information is provided by two or more of the predictor variables in a multiple regression.</p>
<p>An example of this problem is the dummy variable trap discussed in Section 7.4. Suppose you have quarterly data and use four dummy variables, <span class="math inline">\(d_1, d_2, d_3\)</span> and <span class="math inline">\(d_4\)</span>. Then <span class="math inline">\(d_4 = 1 - d_1 - d_2 - d_3\)</span>, so there is perfect correlation between <span class="math inline">\(d_4\)</span> and <span class="math inline">\(d_1 + d_2 + d_3\)</span>.</p>
<blockquote>
<p><strong>Note!</strong> If you are using good statistical software, if you are not interested in the specific contributions of each predictor, and if the future values of your predictor variables are within their historical ranges, there is nothing to worry about — multicollinearity is not a problem except when there is perfect correlation.</p>
</blockquote>
</div>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Exercises<a href="time-series-regression-models.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="time-series-regression-models.html#cb849-1" tabindex="-1"></a>jan14_victoria_elec <span class="ot">&lt;-</span> vic_elec <span class="sc">|&gt;</span></span>
<span id="cb849-2"><a href="time-series-regression-models.html#cb849-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">yearmonth</span>(Time) <span class="sc">==</span> <span class="fu">yearmonth</span>(<span class="st">&#39;2014 Jan&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb849-3"><a href="time-series-regression-models.html#cb849-3" tabindex="-1"></a>  <span class="fu">index_by</span>(<span class="at">Date =</span> <span class="fu">as_date</span>(Time)) <span class="sc">|&gt;</span></span>
<span id="cb849-4"><a href="time-series-regression-models.html#cb849-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Demand =</span> <span class="fu">sum</span>(Demand),</span>
<span id="cb849-5"><a href="time-series-regression-models.html#cb849-5" tabindex="-1"></a>            <span class="at">Temperature =</span> <span class="fu">max</span>(Temperature))</span>
<span id="cb849-6"><a href="time-series-regression-models.html#cb849-6" tabindex="-1"></a></span>
<span id="cb849-7"><a href="time-series-regression-models.html#cb849-7" tabindex="-1"></a>jan14_victoria_elec</span></code></pre></div>
<pre><code>## # A tsibble: 31 x 3 [1D]
##    Date        Demand Temperature
##    &lt;date&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1 2014-01-01 175185.        26  
##  2 2014-01-02 188351.        23  
##  3 2014-01-03 189086.        22.2
##  4 2014-01-04 173798.        20.3
##  5 2014-01-05 169733.        26.1
##  6 2014-01-06 195241.        19.6
##  7 2014-01-07 199770.        20  
##  8 2014-01-08 205339.        27.4
##  9 2014-01-09 227334.        32.4
## 10 2014-01-10 258111.        34  
## # ℹ 21 more rows</code></pre>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="time-series-regression-models.html#cb851-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb851-2"><a href="time-series-regression-models.html#cb851-2" tabindex="-1"></a>jan14_victoria_elec <span class="sc">|&gt;</span></span>
<span id="cb851-3"><a href="time-series-regression-models.html#cb851-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Demand) <span class="sc">+</span></span>
<span id="cb851-4"><a href="time-series-regression-models.html#cb851-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Electricity demand on 2014 Jan&#39;</span>, <span class="at">y =</span> <span class="st">&#39;MWh&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="time-series-regression-models.html#cb852-1" tabindex="-1"></a>fit_elec <span class="ot">&lt;-</span> jan14_victoria_elec <span class="sc">|&gt;</span></span>
<span id="cb852-2"><a href="time-series-regression-models.html#cb852-2" tabindex="-1"></a>              <span class="fu">model</span>(<span class="fu">TSLM</span>(Demand <span class="sc">~</span> Temperature))</span>
<span id="cb852-3"><a href="time-series-regression-models.html#cb852-3" tabindex="-1"></a></span>
<span id="cb852-4"><a href="time-series-regression-models.html#cb852-4" tabindex="-1"></a>fit_elec <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Demand 
## Model: TSLM 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -49978.2 -10218.9   -121.3  18533.2  35440.6 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  59083.9    17424.8   3.391  0.00203 ** 
## Temperature   6154.3      601.3  10.235 3.89e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 24540 on 29 degrees of freedom
## Multiple R-squared: 0.7832,  Adjusted R-squared: 0.7757
## F-statistic: 104.7 on 1 and 29 DF, p-value: 3.8897e-11</code></pre>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="time-series-regression-models.html#cb854-1" tabindex="-1"></a>jan14_victoria_elec <span class="sc">|&gt;</span></span>
<span id="cb854-2"><a href="time-series-regression-models.html#cb854-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Temperature, <span class="at">y =</span> Demand)) <span class="sc">+</span></span>
<span id="cb854-3"><a href="time-series-regression-models.html#cb854-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb854-4"><a href="time-series-regression-models.html#cb854-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb854-5"><a href="time-series-regression-models.html#cb854-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Relationship between temperature and electricity demand&#39;</span>,</span>
<span id="cb854-6"><a href="time-series-regression-models.html#cb854-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Demand, MWh&#39;</span>, <span class="at">x =</span> <span class="st">&#39;Temperature, C&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="figure_html/ch07-ts-regression-37-1.png" width="672" /></p>
<p>January is a summer month in Australia, the more temperature outside was the more air conditioning is used inside.</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="time-series-regression-models.html#cb856-1" tabindex="-1"></a><span class="co"># b. </span></span>
<span id="cb856-2"><a href="time-series-regression-models.html#cb856-2" tabindex="-1"></a></span>
<span id="cb856-3"><a href="time-series-regression-models.html#cb856-3" tabindex="-1"></a>fit_elec <span class="sc">|&gt;</span></span>
<span id="cb856-4"><a href="time-series-regression-models.html#cb856-4" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>() <span class="sc">+</span></span>
<span id="cb856-5"><a href="time-series-regression-models.html#cb856-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Residuals from the model&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="time-series-regression-models.html#cb857-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb857-2"><a href="time-series-regression-models.html#cb857-2" tabindex="-1"></a></span>
<span id="cb857-3"><a href="time-series-regression-models.html#cb857-3" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit_elec <span class="sc">|&gt;</span></span>
<span id="cb857-4"><a href="time-series-regression-models.html#cb857-4" tabindex="-1"></a>  <span class="fu">forecast</span>(</span>
<span id="cb857-5"><a href="time-series-regression-models.html#cb857-5" tabindex="-1"></a>    <span class="at">new_data =</span> <span class="fu">scenarios</span>(</span>
<span id="cb857-6"><a href="time-series-regression-models.html#cb857-6" tabindex="-1"></a>              <span class="st">&#39;max15&#39;</span> <span class="ot">=</span> <span class="fu">new_data</span>(jan14_victoria_elec, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Temperature =</span> <span class="dv">15</span>),</span>
<span id="cb857-7"><a href="time-series-regression-models.html#cb857-7" tabindex="-1"></a>              <span class="st">&#39;max35&#39;</span> <span class="ot">=</span> <span class="fu">new_data</span>(jan14_victoria_elec, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Temperature =</span> <span class="dv">35</span>), <span class="at">names_to =</span> <span class="st">&#39;Scenarios&#39;</span>)</span>
<span id="cb857-8"><a href="time-series-regression-models.html#cb857-8" tabindex="-1"></a>  )</span>
<span id="cb857-9"><a href="time-series-regression-models.html#cb857-9" tabindex="-1"></a></span>
<span id="cb857-10"><a href="time-series-regression-models.html#cb857-10" tabindex="-1"></a>jan14_victoria_elec <span class="sc">|&gt;</span> </span>
<span id="cb857-11"><a href="time-series-regression-models.html#cb857-11" tabindex="-1"></a>  <span class="fu">autoplot</span>(Demand) <span class="sc">+</span></span>
<span id="cb857-12"><a href="time-series-regression-models.html#cb857-12" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc)</span></code></pre></div>
<pre><code>## Warning: Computation failed in `stat_interval()`.
## Caused by error in `trans$transform()`:
## ! `transform_date()` works with objects of class &lt;Date&gt; only</code></pre>
<pre><code>## Warning in min(x, na.rm = na.rm): no non-missing arguments to min; returning Inf</code></pre>
<pre><code>## Warning in max(x, na.rm = na.rm): no non-missing arguments to max; returning -Inf</code></pre>
<pre><code>## Warning in min(x, na.rm = na.rm): no non-missing arguments to min; returning Inf</code></pre>
<pre><code>## Warning in max(x, na.rm = na.rm): no non-missing arguments to max; returning -Inf</code></pre>
<pre><code>## Warning in min(x, na.rm = na.rm): no non-missing arguments to min; returning Inf</code></pre>
<pre><code>## Warning in max(x, na.rm = na.rm): no non-missing arguments to max; returning -Inf</code></pre>
<p><img src="figure_html/ch07-ts-regression-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="time-series-regression-models.html#cb865-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb865-2"><a href="time-series-regression-models.html#cb865-2" tabindex="-1"></a></span>
<span id="cb865-3"><a href="time-series-regression-models.html#cb865-3" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit_elec <span class="sc">|&gt;</span></span>
<span id="cb865-4"><a href="time-series-regression-models.html#cb865-4" tabindex="-1"></a>  <span class="fu">forecast</span>(</span>
<span id="cb865-5"><a href="time-series-regression-models.html#cb865-5" tabindex="-1"></a>    <span class="at">new_data =</span> <span class="fu">scenarios</span>(</span>
<span id="cb865-6"><a href="time-series-regression-models.html#cb865-6" tabindex="-1"></a>              <span class="st">&#39;max15&#39;</span> <span class="ot">=</span> <span class="fu">new_data</span>(jan14_victoria_elec, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Temperature =</span> <span class="dv">15</span>),</span>
<span id="cb865-7"><a href="time-series-regression-models.html#cb865-7" tabindex="-1"></a>              <span class="st">&#39;max35&#39;</span> <span class="ot">=</span> <span class="fu">new_data</span>(jan14_victoria_elec, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Temperature =</span> <span class="dv">35</span>), <span class="at">names_to =</span> <span class="st">&#39;Scenarios&#39;</span>)</span>
<span id="cb865-8"><a href="time-series-regression-models.html#cb865-8" tabindex="-1"></a>  )</span>
<span id="cb865-9"><a href="time-series-regression-models.html#cb865-9" tabindex="-1"></a></span>
<span id="cb865-10"><a href="time-series-regression-models.html#cb865-10" tabindex="-1"></a>jan14_victoria_elec <span class="sc">|&gt;</span> </span>
<span id="cb865-11"><a href="time-series-regression-models.html#cb865-11" tabindex="-1"></a>  <span class="fu">autoplot</span>(Demand) <span class="sc">+</span></span>
<span id="cb865-12"><a href="time-series-regression-models.html#cb865-12" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="time-series-regression-models.html#cb866-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb866-2"><a href="time-series-regression-models.html#cb866-2" tabindex="-1"></a>vic_elec <span class="sc">|&gt;</span></span>
<span id="cb866-3"><a href="time-series-regression-models.html#cb866-3" tabindex="-1"></a>  <span class="fu">index_by</span>(<span class="at">Date =</span> <span class="fu">as_date</span>(Time)) <span class="sc">|&gt;</span></span>
<span id="cb866-4"><a href="time-series-regression-models.html#cb866-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb866-5"><a href="time-series-regression-models.html#cb866-5" tabindex="-1"></a>    <span class="at">Demand =</span> <span class="fu">sum</span>(Demand),</span>
<span id="cb866-6"><a href="time-series-regression-models.html#cb866-6" tabindex="-1"></a>    <span class="at">Temperature =</span> <span class="fu">max</span>(Temperature)</span>
<span id="cb866-7"><a href="time-series-regression-models.html#cb866-7" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb866-8"><a href="time-series-regression-models.html#cb866-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Demand)) <span class="sc">+</span></span>
<span id="cb866-9"><a href="time-series-regression-models.html#cb866-9" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-41-1.png" width="672" /></p>
<p>The Temperature and the Demand do not have linear relationship, so the linear model might not be the best choice.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="time-series-regression-models.html#cb867-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb867-2"><a href="time-series-regression-models.html#cb867-2" tabindex="-1"></a></span>
<span id="cb867-3"><a href="time-series-regression-models.html#cb867-3" tabindex="-1"></a>olympic_running <span class="sc">|&gt;</span></span>
<span id="cb867-4"><a href="time-series-regression-models.html#cb867-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Time) <span class="sc">+</span></span>
<span id="cb867-5"><a href="time-series-regression-models.html#cb867-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Length <span class="sc">~</span> Sex, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb867-6"><a href="time-series-regression-models.html#cb867-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="time-series-regression-models.html#cb868-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb868-2"><a href="time-series-regression-models.html#cb868-2" tabindex="-1"></a></span>
<span id="cb868-3"><a href="time-series-regression-models.html#cb868-3" tabindex="-1"></a>fit <span class="ot">&lt;-</span> olympic_running <span class="sc">|&gt;</span></span>
<span id="cb868-4"><a href="time-series-regression-models.html#cb868-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Time <span class="sc">~</span> <span class="fu">trend</span>()))</span>
<span id="cb868-5"><a href="time-series-regression-models.html#cb868-5" tabindex="-1"></a>  </span>
<span id="cb868-6"><a href="time-series-regression-models.html#cb868-6" tabindex="-1"></a>aug <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> <span class="fu">augment</span>()</span>
<span id="cb868-7"><a href="time-series-regression-models.html#cb868-7" tabindex="-1"></a></span>
<span id="cb868-8"><a href="time-series-regression-models.html#cb868-8" tabindex="-1"></a><span class="co"># get the regression lines</span></span>
<span id="cb868-9"><a href="time-series-regression-models.html#cb868-9" tabindex="-1"></a>olympic_running <span class="sc">|&gt;</span></span>
<span id="cb868-10"><a href="time-series-regression-models.html#cb868-10" tabindex="-1"></a>  <span class="fu">autoplot</span>(Time) <span class="sc">+</span></span>
<span id="cb868-11"><a href="time-series-regression-models.html#cb868-11" tabindex="-1"></a>  <span class="fu">autolayer</span>(aug, .fitted) <span class="sc">+</span></span>
<span id="cb868-12"><a href="time-series-regression-models.html#cb868-12" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Length <span class="sc">~</span> Sex, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb868-13"><a href="time-series-regression-models.html#cb868-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-43-1.png" width="672" /></p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="time-series-regression-models.html#cb869-1" tabindex="-1"></a><span class="co"># get average rate per year</span></span>
<span id="cb869-2"><a href="time-series-regression-models.html#cb869-2" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb869-3"><a href="time-series-regression-models.html#cb869-3" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb869-4"><a href="time-series-regression-models.html#cb869-4" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&#39;trend()&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb869-5"><a href="time-series-regression-models.html#cb869-5" tabindex="-1"></a>  <span class="fu">select</span>(Length, Sex, <span class="st">`</span><span class="at">Average rate per year</span><span class="st">`</span><span class="ot">=</span>estimate)</span></code></pre></div>
<pre><code>## # A tibble: 14 × 3
##    Length Sex   `Average rate per year`
##     &lt;int&gt; &lt;chr&gt;                   &lt;dbl&gt;
##  1    100 men                   -0.0504
##  2    100 women                 -0.0567
##  3    200 men                   -0.0995
##  4    200 women                 -0.135 
##  5    400 men                   -0.258 
##  6    400 women                 -0.160 
##  7    800 men                   -0.607 
##  8    800 women                 -0.792 
##  9   1500 men                   -1.26  
## 10   1500 women                  0.587 
## 11   5000 men                   -4.12  
## 12   5000 women                 -1.21  
## 13  10000 men                  -10.7   
## 14  10000 women                -14.0</code></pre>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="time-series-regression-models.html#cb871-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb871-2"><a href="time-series-regression-models.html#cb871-2" tabindex="-1"></a></span>
<span id="cb871-3"><a href="time-series-regression-models.html#cb871-3" tabindex="-1"></a><span class="co"># prot the residuals vs year</span></span>
<span id="cb871-4"><a href="time-series-regression-models.html#cb871-4" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb871-5"><a href="time-series-regression-models.html#cb871-5" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb871-6"><a href="time-series-regression-models.html#cb871-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb871-7"><a href="time-series-regression-models.html#cb871-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb871-8"><a href="time-series-regression-models.html#cb871-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Length <span class="sc">~</span> Sex, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="time-series-regression-models.html#cb872-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb872-2"><a href="time-series-regression-models.html#cb872-2" tabindex="-1"></a></span>
<span id="cb872-3"><a href="time-series-regression-models.html#cb872-3" tabindex="-1"></a>olympic_running <span class="sc">|&gt;</span></span>
<span id="cb872-4"><a href="time-series-regression-models.html#cb872-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Time) <span class="sc">+</span></span>
<span id="cb872-5"><a href="time-series-regression-models.html#cb872-5" tabindex="-1"></a>  <span class="fu">autolayer</span>(fit <span class="sc">|&gt;</span></span>
<span id="cb872-6"><a href="time-series-regression-models.html#cb872-6" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">2</span>)</span>
<span id="cb872-7"><a href="time-series-regression-models.html#cb872-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb872-8"><a href="time-series-regression-models.html#cb872-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Length <span class="sc">~</span> Sex, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb872-9"><a href="time-series-regression-models.html#cb872-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-46-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="time-series-regression-models.html#cb873-1" tabindex="-1"></a>souvenirs</span></code></pre></div>
<pre><code>## # A tsibble: 84 x 2 [1M]
##       Month Sales
##       &lt;mth&gt; &lt;dbl&gt;
##  1 1987 Jan 1665.
##  2 1987 Feb 2398.
##  3 1987 Mar 2841.
##  4 1987 Apr 3547.
##  5 1987 May 3753.
##  6 1987 Jun 3715.
##  7 1987 Jul 4350.
##  8 1987 Aug 3566.
##  9 1987 Sep 5022.
## 10 1987 Oct 6423.
## # ℹ 74 more rows</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="time-series-regression-models.html#cb875-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb875-2"><a href="time-series-regression-models.html#cb875-2" tabindex="-1"></a>souvenirs <span class="sc">|&gt;</span></span>
<span id="cb875-3"><a href="time-series-regression-models.html#cb875-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Sales)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="time-series-regression-models.html#cb876-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb876-2"><a href="time-series-regression-models.html#cb876-2" tabindex="-1"></a>souvenirs <span class="sc">|&gt;</span></span>
<span id="cb876-3"><a href="time-series-regression-models.html#cb876-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">log</span>(Sales))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-49-1.png" width="672" /></p>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="time-series-regression-models.html#cb877-1" tabindex="-1"></a><span class="co"># Because of the fluctuation of the variance the logarithms should be applied </span></span>
<span id="cb877-2"><a href="time-series-regression-models.html#cb877-2" tabindex="-1"></a><span class="co"># to make stationary time series.</span></span></code></pre></div>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="time-series-regression-models.html#cb878-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb878-2"><a href="time-series-regression-models.html#cb878-2" tabindex="-1"></a>souvenirs_log <span class="ot">&lt;-</span> souvenirs <span class="sc">|&gt;</span></span>
<span id="cb878-3"><a href="time-series-regression-models.html#cb878-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sales_log =</span> <span class="fu">log</span>(Sales), </span>
<span id="cb878-4"><a href="time-series-regression-models.html#cb878-4" tabindex="-1"></a>         <span class="st">`</span><span class="at">Surfing Festival</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">year</span>(Month) <span class="sc">&gt;=</span> <span class="dv">1988</span> <span class="sc">&amp;</span> </span>
<span id="cb878-5"><a href="time-series-regression-models.html#cb878-5" tabindex="-1"></a>                                     <span class="fu">month</span>(Month) <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb878-6"><a href="time-series-regression-models.html#cb878-6" tabindex="-1"></a>fit <span class="ot">&lt;-</span> souvenirs_log <span class="sc">|&gt;</span></span>
<span id="cb878-7"><a href="time-series-regression-models.html#cb878-7" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Sales_log <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">season</span>() <span class="sc">+</span> <span class="st">`</span><span class="at">Surfing Festival</span><span class="st">`</span>))</span></code></pre></div>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="time-series-regression-models.html#cb879-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb879-2"><a href="time-series-regression-models.html#cb879-2" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb879-3"><a href="time-series-regression-models.html#cb879-3" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb879-4"><a href="time-series-regression-models.html#cb879-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb879-5"><a href="time-series-regression-models.html#cb879-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb879-6"><a href="time-series-regression-models.html#cb879-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Residuals vs Time&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="time-series-regression-models.html#cb880-1" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb880-2"><a href="time-series-regression-models.html#cb880-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb880-3"><a href="time-series-regression-models.html#cb880-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb880-4"><a href="time-series-regression-models.html#cb880-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb880-5"><a href="time-series-regression-models.html#cb880-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Residuals vs Fitted&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="time-series-regression-models.html#cb881-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb881-2"><a href="time-series-regression-models.html#cb881-2" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb881-3"><a href="time-series-regression-models.html#cb881-3" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb881-4"><a href="time-series-regression-models.html#cb881-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="fu">month</span>(Month)), <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb881-5"><a href="time-series-regression-models.html#cb881-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb881-6"><a href="time-series-regression-models.html#cb881-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Box plot per Month&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="time-series-regression-models.html#cb882-1" tabindex="-1"></a><span class="co"># f.</span></span>
<span id="cb882-2"><a href="time-series-regression-models.html#cb882-2" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Sales_log 
## Model: TSLM 
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.336727 -0.127571  0.002568  0.109106  0.376714 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        7.6196670  0.0742471 102.626  &lt; 2e-16 ***
## trend()            0.0220198  0.0008268  26.634  &lt; 2e-16 ***
## season()year2      0.2514168  0.0956790   2.628 0.010555 *  
## season()year3      0.2660828  0.1934044   1.376 0.173275    
## season()year4      0.3840535  0.0957075   4.013 0.000148 ***
## season()year5      0.4094870  0.0957325   4.277 5.88e-05 ***
## season()year6      0.4488283  0.0957647   4.687 1.33e-05 ***
## season()year7      0.6104545  0.0958039   6.372 1.71e-08 ***
## season()year8      0.5879644  0.0958503   6.134 4.53e-08 ***
## season()year9      0.6693299  0.0959037   6.979 1.36e-09 ***
## season()year10     0.7473919  0.0959643   7.788 4.48e-11 ***
## season()year11     1.2067479  0.0960319  12.566  &lt; 2e-16 ***
## season()year12     1.9622412  0.0961066  20.417  &lt; 2e-16 ***
## `Surfing Festival` 0.5015151  0.1964273   2.553 0.012856 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.179 on 70 degrees of freedom
## Multiple R-squared: 0.9567,  Adjusted R-squared: 0.9487
## F-statistic:   119 on 13 and 70 DF, p-value: &lt; 2.22e-16</code></pre>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="time-series-regression-models.html#cb884-1" tabindex="-1"></a><span class="co"># g.</span></span>
<span id="cb884-2"><a href="time-series-regression-models.html#cb884-2" tabindex="-1"></a></span>
<span id="cb884-3"><a href="time-series-regression-models.html#cb884-3" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb884-4"><a href="time-series-regression-models.html#cb884-4" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb884-5"><a href="time-series-regression-models.html#cb884-5" tabindex="-1"></a>  <span class="fu">features</span>(.resid, ljung_box, <span class="at">lag =</span> <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model                                                    lb_stat lb_pvalue
##   &lt;chr&gt;                                                       &lt;dbl&gt;     &lt;dbl&gt;
## 1 TSLM(Sales_log ~ trend() + season() + `Surfing Festival`)    76.9  1.63e-11</code></pre>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="time-series-regression-models.html#cb886-1" tabindex="-1"></a><span class="co"># H0 is rejected, there is autocorrelation in the residuals</span></span></code></pre></div>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="time-series-regression-models.html#cb887-1" tabindex="-1"></a><span class="co"># h.</span></span>
<span id="cb887-2"><a href="time-series-regression-models.html#cb887-2" tabindex="-1"></a>fc <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span></span>
<span id="cb887-3"><a href="time-series-regression-models.html#cb887-3" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">new_data =</span> <span class="fu">scenarios</span>(<span class="fu">new_data</span>(souvenirs, <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb887-4"><a href="time-series-regression-models.html#cb887-4" tabindex="-1"></a>                                  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Surfing Festival</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">month</span>(Month) <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb887-5"><a href="time-series-regression-models.html#cb887-5" tabindex="-1"></a>                                <span class="fu">new_data</span>(souvenirs, <span class="dv">24</span>) <span class="sc">|&gt;</span></span>
<span id="cb887-6"><a href="time-series-regression-models.html#cb887-6" tabindex="-1"></a>                                  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Surfing Festival</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">month</span>(Month) <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb887-7"><a href="time-series-regression-models.html#cb887-7" tabindex="-1"></a>                                <span class="fu">new_data</span>(souvenirs, <span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb887-8"><a href="time-series-regression-models.html#cb887-8" tabindex="-1"></a>                                  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Surfing Festival</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">month</span>(Month) <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>))))</span>
<span id="cb887-9"><a href="time-series-regression-models.html#cb887-9" tabindex="-1"></a>souvenirs_log <span class="sc">|&gt;</span></span>
<span id="cb887-10"><a href="time-series-regression-models.html#cb887-10" tabindex="-1"></a>  <span class="fu">autoplot</span>(Sales_log) <span class="sc">+</span></span>
<span id="cb887-11"><a href="time-series-regression-models.html#cb887-11" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">.scenario =</span> <span class="fu">factor</span>(.scenario))) <span class="sc">+</span></span>
<span id="cb887-12"><a href="time-series-regression-models.html#cb887-12" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.scenario <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-56-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="time-series-regression-models.html#cb888-1" tabindex="-1"></a>gasoline <span class="ot">&lt;-</span> us_gasoline <span class="sc">|&gt;</span></span>
<span id="cb888-2"><a href="time-series-regression-models.html#cb888-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Week) <span class="sc">&lt;=</span> <span class="dv">2004</span>)</span>
<span id="cb888-3"><a href="time-series-regression-models.html#cb888-3" tabindex="-1"></a></span>
<span id="cb888-4"><a href="time-series-regression-models.html#cb888-4" tabindex="-1"></a>gasoline <span class="sc">|&gt;</span></span>
<span id="cb888-5"><a href="time-series-regression-models.html#cb888-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Barrels) <span class="sc">+</span></span>
<span id="cb888-6"><a href="time-series-regression-models.html#cb888-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Million barrels per day&#39;</span>,</span>
<span id="cb888-7"><a href="time-series-regression-models.html#cb888-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Weekly data for supplies of US finished motor gasoline product&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="time-series-regression-models.html#cb889-1" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb889-2"><a href="time-series-regression-models.html#cb889-2" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb889-3"><a href="time-series-regression-models.html#cb889-3" tabindex="-1"></a>minACCc <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb889-4"><a href="time-series-regression-models.html#cb889-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">52</span><span class="sc">/</span><span class="dv">2</span>)) {</span>
<span id="cb889-5"><a href="time-series-regression-models.html#cb889-5" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> gasoline <span class="sc">|&gt;</span></span>
<span id="cb889-6"><a href="time-series-regression-models.html#cb889-6" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">TSLM</span>(Barrels <span class="sc">~</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">fourier</span>(<span class="at">K=</span>i)))</span>
<span id="cb889-7"><a href="time-series-regression-models.html#cb889-7" tabindex="-1"></a>  fits[[i]] <span class="ot">&lt;-</span> fit <span class="co"># keep fit</span></span>
<span id="cb889-8"><a href="time-series-regression-models.html#cb889-8" tabindex="-1"></a>  AICc <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">glance</span>(fit)[[<span class="st">&#39;AICc&#39;</span>]], <span class="dv">2</span>)</span>
<span id="cb889-9"><a href="time-series-regression-models.html#cb889-9" tabindex="-1"></a>  <span class="cf">if</span>(AICc <span class="sc">&lt;</span> minACCc){</span>
<span id="cb889-10"><a href="time-series-regression-models.html#cb889-10" tabindex="-1"></a>    minACCc <span class="ot">&lt;-</span> AICc</span>
<span id="cb889-11"><a href="time-series-regression-models.html#cb889-11" tabindex="-1"></a>  }</span>
<span id="cb889-12"><a href="time-series-regression-models.html#cb889-12" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span></span>
<span id="cb889-13"><a href="time-series-regression-models.html#cb889-13" tabindex="-1"></a>    <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb889-14"><a href="time-series-regression-models.html#cb889-14" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Week, <span class="at">y =</span> Barrels)) <span class="sc">+</span></span>
<span id="cb889-15"><a href="time-series-regression-models.html#cb889-15" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&#39;Actual Data&#39;</span>)) <span class="sc">+</span></span>
<span id="cb889-16"><a href="time-series-regression-models.html#cb889-16" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> <span class="st">&#39;Fitted&#39;</span>)) <span class="sc">+</span></span>
<span id="cb889-17"><a href="time-series-regression-models.html#cb889-17" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb889-18"><a href="time-series-regression-models.html#cb889-18" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Actual Data&#39;</span><span class="ot">=</span><span class="st">&#39;darkgray&#39;</span>, <span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb889-19"><a href="time-series-regression-models.html#cb889-19" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">paste</span>(<span class="st">&quot;K=&quot;</span>, i, <span class="st">&quot;   AICc=&quot;</span>, AICc))</span>
<span id="cb889-20"><a href="time-series-regression-models.html#cb889-20" tabindex="-1"></a>}</span>
<span id="cb889-21"><a href="time-series-regression-models.html#cb889-21" tabindex="-1"></a></span>
<span id="cb889-22"><a href="time-series-regression-models.html#cb889-22" tabindex="-1"></a><span class="fu">do.call</span>(gridExtra<span class="sc">::</span>grid.arrange, <span class="fu">c</span>(plots, <span class="at">ncol =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-58-1.png" width="576" /></p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="time-series-regression-models.html#cb890-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb890-2"><a href="time-series-regression-models.html#cb890-2" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">which.min</span>(<span class="fu">sapply</span>(fits, <span class="cf">function</span>(fit) {</span>
<span id="cb890-3"><a href="time-series-regression-models.html#cb890-3" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">glance</span>(fit)[[<span class="st">&#39;AICc&#39;</span>]], <span class="dv">2</span>)</span>
<span id="cb890-4"><a href="time-series-regression-models.html#cb890-4" tabindex="-1"></a>}))</span>
<span id="cb890-5"><a href="time-series-regression-models.html#cb890-5" tabindex="-1"></a></span>
<span id="cb890-6"><a href="time-series-regression-models.html#cb890-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Optimal K =&#39;</span>, K, <span class="st">&#39;, AICc = &#39;</span>, <span class="fu">round</span>(<span class="fu">glance</span>(fits[[K]])[[<span class="st">&#39;AICc&#39;</span>]], <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Optimal K = 7 , AICc =  -1887.35&quot;</code></pre>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="time-series-regression-models.html#cb892-1" tabindex="-1"></a>fits[[K]] <span class="sc">|&gt;</span></span>
<span id="cb892-2"><a href="time-series-regression-models.html#cb892-2" tabindex="-1"></a>    <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb892-3"><a href="time-series-regression-models.html#cb892-3" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Week, <span class="at">y =</span> Barrels)) <span class="sc">+</span></span>
<span id="cb892-4"><a href="time-series-regression-models.html#cb892-4" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">&#39;Actual Data&#39;</span>)) <span class="sc">+</span></span>
<span id="cb892-5"><a href="time-series-regression-models.html#cb892-5" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> <span class="st">&#39;Fitted&#39;</span>)) <span class="sc">+</span></span>
<span id="cb892-6"><a href="time-series-regression-models.html#cb892-6" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb892-7"><a href="time-series-regression-models.html#cb892-7" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Actual Data&#39;</span><span class="ot">=</span><span class="st">&#39;darkgray&#39;</span>, <span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb892-8"><a href="time-series-regression-models.html#cb892-8" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">paste</span>(<span class="st">&quot;K=&quot;</span>, K, <span class="st">&quot;   AICc=&quot;</span>, <span class="fu">round</span>(<span class="fu">glance</span>(fits[[K]])[[<span class="st">&#39;AICc&#39;</span>]], <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="time-series-regression-models.html#cb893-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb893-2"><a href="time-series-regression-models.html#cb893-2" tabindex="-1"></a></span>
<span id="cb893-3"><a href="time-series-regression-models.html#cb893-3" tabindex="-1"></a>fits[[K]] <span class="sc">|&gt;</span></span>
<span id="cb893-4"><a href="time-series-regression-models.html#cb893-4" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="time-series-regression-models.html#cb894-1" tabindex="-1"></a>fits[[K]] <span class="sc">|&gt;</span></span>
<span id="cb894-2"><a href="time-series-regression-models.html#cb894-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb894-3"><a href="time-series-regression-models.html#cb894-3" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model                                   lb_stat lb_pvalue
##   &lt;chr&gt;                                      &lt;dbl&gt;     &lt;dbl&gt;
## 1 TSLM(Barrels ~ trend() + fourier(K = i))    5.23    0.0222</code></pre>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="time-series-regression-models.html#cb896-1" tabindex="-1"></a><span class="co"># H0 is rejected, the residuals are autocorrelated.</span></span></code></pre></div>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="time-series-regression-models.html#cb897-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb897-2"><a href="time-series-regression-models.html#cb897-2" tabindex="-1"></a></span>
<span id="cb897-3"><a href="time-series-regression-models.html#cb897-3" tabindex="-1"></a>us_gasoline <span class="sc">|&gt;</span></span>
<span id="cb897-4"><a href="time-series-regression-models.html#cb897-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Week) <span class="sc">&lt;</span> <span class="dv">2006</span>) <span class="sc">|&gt;</span></span>
<span id="cb897-5"><a href="time-series-regression-models.html#cb897-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Barrels) <span class="sc">+</span></span>
<span id="cb897-6"><a href="time-series-regression-models.html#cb897-6" tabindex="-1"></a>  <span class="fu">autolayer</span>(fits[[K]] <span class="sc">|&gt;</span></span>
<span id="cb897-7"><a href="time-series-regression-models.html#cb897-7" tabindex="-1"></a>              <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">52</span>), <span class="at">color=</span><span class="st">&#39;red&#39;</span>, <span class="at">level=</span><span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `TSLM(Barrels ~ trend() + fourier(K = i)) = (function (object, ...) ...`.
## Caused by warning:
## ! prediction from a rank-deficient fit may be misleading</code></pre>
<p><img src="figure_html/ch07-ts-regression-63-1.png" width="672" />
6.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="time-series-regression-models.html#cb899-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb899-2"><a href="time-series-regression-models.html#cb899-2" tabindex="-1"></a>auf <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb899-3"><a href="time-series-regression-models.html#cb899-3" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&#39;Afghanistan&#39;</span>)</span>
<span id="cb899-4"><a href="time-series-regression-models.html#cb899-4" tabindex="-1"></a></span>
<span id="cb899-5"><a href="time-series-regression-models.html#cb899-5" tabindex="-1"></a>auf <span class="sc">|&gt;</span> <span class="fu">autoplot</span>(Population) <span class="sc">+</span></span>
<span id="cb899-6"><a href="time-series-regression-models.html#cb899-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Population of Afghanistan&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="time-series-regression-models.html#cb900-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb900-2"><a href="time-series-regression-models.html#cb900-2" tabindex="-1"></a></span>
<span id="cb900-3"><a href="time-series-regression-models.html#cb900-3" tabindex="-1"></a>fit_trends <span class="ot">&lt;-</span> auf <span class="sc">|&gt;</span></span>
<span id="cb900-4"><a href="time-series-regression-models.html#cb900-4" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb900-5"><a href="time-series-regression-models.html#cb900-5" tabindex="-1"></a>    <span class="at">linear_trend =</span> <span class="fu">TSLM</span>(Population <span class="sc">~</span> <span class="fu">trend</span>()),</span>
<span id="cb900-6"><a href="time-series-regression-models.html#cb900-6" tabindex="-1"></a>    <span class="at">piecewise =</span> <span class="fu">TSLM</span>(Population <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1989</span>)))</span>
<span id="cb900-7"><a href="time-series-regression-models.html#cb900-7" tabindex="-1"></a>  )</span>
<span id="cb900-8"><a href="time-series-regression-models.html#cb900-8" tabindex="-1"></a></span>
<span id="cb900-9"><a href="time-series-regression-models.html#cb900-9" tabindex="-1"></a>auf <span class="sc">|&gt;</span></span>
<span id="cb900-10"><a href="time-series-regression-models.html#cb900-10" tabindex="-1"></a>  <span class="fu">autoplot</span>(Population) <span class="sc">+</span></span>
<span id="cb900-11"><a href="time-series-regression-models.html#cb900-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">fitted</span>(fit_trends),</span>
<span id="cb900-12"><a href="time-series-regression-models.html#cb900-12" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb900-13"><a href="time-series-regression-models.html#cb900-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Population of Afghanistan&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-65-1.png" width="672" /></p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="time-series-regression-models.html#cb901-1" tabindex="-1"></a>fc_trends <span class="ot">&lt;-</span> fit_trends <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">5</span>)</span>
<span id="cb901-2"><a href="time-series-regression-models.html#cb901-2" tabindex="-1"></a></span>
<span id="cb901-3"><a href="time-series-regression-models.html#cb901-3" tabindex="-1"></a>auf <span class="sc">|&gt;</span></span>
<span id="cb901-4"><a href="time-series-regression-models.html#cb901-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Population) <span class="sc">+</span></span>
<span id="cb901-5"><a href="time-series-regression-models.html#cb901-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">fitted</span>(fit_trends),</span>
<span id="cb901-6"><a href="time-series-regression-models.html#cb901-6" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .fitted, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb901-7"><a href="time-series-regression-models.html#cb901-7" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc_trends, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb901-8"><a href="time-series-regression-models.html#cb901-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Population of Afghanistan&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch07-ts-regression-66-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="judgmental-forecasts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exponential-smoothing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
