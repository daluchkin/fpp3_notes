<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Dynamic regression models | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="Chapter 10 Dynamic regression models | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Dynamic regression models | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/daluchkin/fpp3_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Dynamic regression models | Forecasting: Principles and Practice (3rd ed)" />
  
  
  

<meta name="author" content="Dmitry Luchkin" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima-models.html"/>
<link rel="next" href="forecasting-hierarchical-and-grouped-time-series.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice (3rd ed)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#what-can-be-forecast"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#forecasting-goals-and-planning"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#determining-what-to-forecast"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#forecasting-data-and-methods"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#some-case-studies"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#the-basic-steps-in-a-forecasting-task"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting"><i class="fa fa-check"></i><b>1.6.1</b> Summary: Five Basic Steps of Forecasting</a></li>
<li class="chapter" data-level="1.6.2" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting-1"><i class="fa fa-check"></i><b>1.6.2</b> Summary: Five Basic Steps of Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started.html"><a href="getting-started.html#the-statistical-forecasting-perspective"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started.html"><a href="getting-started.html#excercises"><i class="fa fa-check"></i><b>1.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-object"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> object</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-index-variable"><i class="fa fa-check"></i><b>2.1.1</b> The index variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-key-variable"><i class="fa fa-check"></i><b>2.1.2</b> The key variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#working-with-tsibble-object"><i class="fa fa-check"></i><b>2.1.3</b> Working with <code>tsibble</code> object</a></li>
<li class="chapter" data-level="2.1.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#read-a-csv-file-and-convert-to-a-tsibble"><i class="fa fa-check"></i><b>2.1.4</b> Read a csv file and convert to a tsibble</a></li>
<li class="chapter" data-level="2.1.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-seasonal-period"><i class="fa fa-check"></i><b>2.1.5</b> The seasonal period</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plot"><i class="fa fa-check"></i><b>2.2</b> Time plot</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-series-patterns"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplots"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#correlation"><i class="fa fa-check"></i><b>2.6.1</b> Correlation</a></li>
<li class="chapter" data-level="2.6.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.2</b> Scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.8.1</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="time-series-graphics.html"><a href="time-series-graphics.html#white-moise"><i class="fa fa-check"></i><b>2.9</b> White moise</a></li>
<li class="chapter" data-level="2.10" data-path="time-series-graphics.html"><a href="time-series-graphics.html#excercises-1"><i class="fa fa-check"></i><b>2.10</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformations-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#mathematical-transformations"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#time-series-components"><i class="fa fa-check"></i><b>3.2</b> Time series components</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seasonally-adjusted-data"><i class="fa fa-check"></i><b>3.2.1</b> Seasonally adjusted data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-average-smoothing"><i class="fa fa-check"></i><b>3.3.1</b> Moving average smoothing</a></li>
<li class="chapter" data-level="3.3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.3.2</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-with-seasonal-data"><i class="fa fa-check"></i><b>3.3.3</b> Estimating the trend-cycle with seasonal data</a></li>
<li class="chapter" data-level="3.3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>3.3.4</b> Example: Employment in the US retail sector</a></li>
<li class="chapter" data-level="3.3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.3.5</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#additive-decomposition"><i class="fa fa-check"></i><b>3.4.1</b> Additive decomposition</a></li>
<li class="chapter" data-level="3.4.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#multiplicative-decomposition"><i class="fa fa-check"></i><b>3.4.2</b> Multiplicative decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#excercises-2"><i class="fa fa-check"></i><b>3.5</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#some-simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.1.1</b> ACF features</a></li>
<li class="chapter" data-level="4.1.2" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.1.2</b> STL features</a></li>
<li class="chapter" data-level="4.1.3" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.1.3</b> Other features</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#exploring-australian-tourism-data"><i class="fa fa-check"></i><b>4.2</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#exercises"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#plot-the-data-visualise"><i class="fa fa-check"></i><b>5.1.2</b> Plot the data (visualise)</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naiïve-method"><i class="fa fa-check"></i><b>5.2.2</b> Naiïve method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naïve-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#model-fitting"><i class="fa fa-check"></i><b>5.2.5</b> Model fitting</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#producing-forecasts"><i class="fa fa-check"></i><b>5.2.6</b> Producing forecasts</a></li>
<li class="chapter" data-level="5.2.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualising-forecasts"><i class="fa fa-check"></i><b>5.2.7</b> Visualising forecasts</a></li>
<li class="chapter" data-level="5.2.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-facebook-closing-stock-price"><i class="fa fa-check"></i><b>5.2.8</b> Example: Facebook closing stock price</a></li>
<li class="chapter" data-level="5.2.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.9</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.10</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values"><i class="fa fa-check"></i><b>5.3.1</b> Fitted values</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.2</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#acf-of-residuals"><i class="fa fa-check"></i><b>5.4.1</b> ACF of residuals</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-google-daily-closing-stock-prices"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting Google daily closing stock prices</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-distributions"><i class="fa fa-check"></i><b>5.5.1</b> Forecast distributions</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.3</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.4</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#benchmark-methods"><i class="fa fa-check"></i><b>5.5.5</b> Benchmark methods</a></li>
<li class="chapter" data-level="5.5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.6</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector-1"><i class="fa fa-check"></i><b>5.7.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-point-forecast-accuracy"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#training-and-test-sets"><i class="fa fa-check"></i><b>5.8.1</b> Training and test sets</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#functions-to-subset-a-time-series"><i class="fa fa-check"></i><b>5.8.2</b> Functions to subset a time series</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.8.3</b> Forecast errors</a></li>
<li class="chapter" data-level="5.8.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.8.4</b> Scale-dependent errors</a></li>
<li class="chapter" data-level="5.8.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.8.5</b> Percentage errors</a></li>
<li class="chapter" data-level="5.8.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.8.6</b> Scaled errors</a></li>
<li class="chapter" data-level="5.8.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples"><i class="fa fa-check"></i><b>5.8.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-distributional-forecast-accuracy"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#quantile-scores"><i class="fa fa-check"></i><b>5.9.1</b> Quantile scores</a></li>
<li class="chapter" data-level="5.9.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#winkler-score"><i class="fa fa-check"></i><b>5.9.2</b> Winkler Score</a></li>
<li class="chapter" data-level="5.9.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#continuous-ranked-probability-score"><i class="fa fa-check"></i><b>5.9.3</b> Continuous Ranked Probability Score</a></li>
<li class="chapter" data-level="5.9.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-free-comparisons-using-skill-scores"><i class="fa fa-check"></i><b>5.9.4</b> Scale-free comparisons using skill scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.10.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#exercises-1"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values-1"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness-of-fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-the-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#acf-plot-of-residuals"><i class="fa fa-check"></i><b>7.3.1</b> ACF plot of residuals</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#histogram-of-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Histogram of residuals</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.3</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.4</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.5</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.6</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.3</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusted-r2"><i class="fa fa-check"></i><b>7.5.1</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross-validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#corrected-akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Corrected Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#schwarzs-bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.5</b> Schwarz’s Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>7.5.6</b> Stepwise regression</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.1</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals-1"><i class="fa fa-check"></i><b>7.6.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.7.1</b> Forecasting with a nonlinear trend</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>7.8.1</b> Correlation is not causation</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-correlated-predictors"><i class="fa fa-check"></i><b>7.8.2</b> Forecasting with correlated predictors</a></li>
<li class="chapter" data-level="7.8.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multicollinearity-and-forecasting"><i class="fa fa-check"></i><b>7.8.3</b> Multicollinearity and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimisation"><i class="fa fa-check"></i><b>8.1.4</b> Optimisation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.2</b> Damped trend methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-seasonality"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.3.1</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.3.2</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.3.3</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.3.4</b> Holt-Winters’ damped method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>8.6.1</b> Model selection</a></li>
<li class="chapter" data-level="8.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.6.2</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-2"><i class="fa fa-check"></i><b>8.7.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#excercises-3"><i class="fa fa-check"></i><b>8.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>9.1.1</b> Differencing</a></li>
<li class="chapter" data-level="9.1.2" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>9.1.2</b> Second-order differencing</a></li>
<li class="chapter" data-level="9.1.3" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>9.1.3</b> Seasonal differencing</a></li>
<li class="chapter" data-level="9.1.4" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>9.1.4</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive (AR) models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="arima-models.html"><a href="arima-models.html#ar1-model"><i class="fa fa-check"></i><b>9.3.1</b> AR(1) model</a></li>
<li class="chapter" data-level="9.3.2" data-path="arima-models.html"><a href="arima-models.html#ar2-model"><i class="fa fa-check"></i><b>9.3.2</b> AR(2) model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="arima-models.html"><a href="arima-models.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="arima-models.html"><a href="arima-models.html#example-egyptian-exports"><i class="fa fa-check"></i><b>9.5.1</b> Example: Egyptian exports</a></li>
<li class="chapter" data-level="9.5.2" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-plots"><i class="fa fa-check"></i><b>9.5.2</b> ACF and PACF plots</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-fable"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>9.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="9.7.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>9.7.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="9.7.3" data-path="arima-models.html"><a href="arima-models.html#example-central-african-republic-exports"><i class="fa fa-check"></i><b>9.7.3</b> Example: Central African Republic exports</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals-3"><i class="fa fa-check"></i><b>9.8.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="arima-models.html"><a href="arima-models.html#arima-model-notation"><i class="fa fa-check"></i><b>9.9.1</b> ARIMA Model Notation</a></li>
<li class="chapter" data-level="9.9.2" data-path="arima-models.html"><a href="arima-models.html#acfpacf"><i class="fa fa-check"></i><b>9.9.2</b> ACF/PACF</a></li>
<li class="chapter" data-level="9.9.3" data-path="arima-models.html"><a href="arima-models.html#example-monthly-us-leisure-and-hospitality-employment"><i class="fa fa-check"></i><b>9.9.3</b> Example: Monthly US leisure and hospitality employment</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="arima-models.html"><a href="arima-models.html#arima-vs-ets"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>9.10.1</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="9.10.2" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>9.10.2</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="arima-models.html"><a href="arima-models.html#exercises-3"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors-using-fable"><i class="fa fa-check"></i><b>10.1</b> Regression with ARIMA errors using <code>fable</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>10.1.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting-1"><i class="fa fa-check"></i><b>10.2</b> Forecasting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income-1"><i class="fa fa-check"></i><b>10.2.1</b> Example: US Personal Consumption and Income</a></li>
<li class="chapter" data-level="10.2.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>10.2.2</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#stochastic-and-deterministic-trends"><i class="fa fa-check"></i><b>10.3</b> Stochastic and deterministic trends</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-air-transport-passengers-australia"><i class="fa fa-check"></i><b>10.3.1</b> Example: Air transport passengers Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>10.4</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>10.5</b> Example: Australian eating out expenditure</a></li>
<li class="chapter" data-level="10.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>10.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-and-grouped-time-series"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-time-series"><i class="fa fa-check"></i><b>11.1.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="11.1.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-tourism-hierarchy"><i class="fa fa-check"></i><b>11.1.2</b> Example: Australian tourism hierarchy</a></li>
<li class="chapter" data-level="11.1.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#grouped-time-series"><i class="fa fa-check"></i><b>11.1.3</b> Grouped time series</a></li>
<li class="chapter" data-level="11.1.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-prison-population"><i class="fa fa-check"></i><b>11.1.4</b> Example: Australian prison population</a></li>
<li class="chapter" data-level="11.1.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#mixed-hierarchical-and-grouped-structure"><i class="fa fa-check"></i><b>11.1.5</b> Mixed hierarchical and grouped structure</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#single-level-approaches"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#the-bottom-up-approach"><i class="fa fa-check"></i><b>11.2.1</b> The bottom-up approach</a></li>
<li class="chapter" data-level="11.2.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#top-down-approaches"><i class="fa fa-check"></i><b>11.2.2</b> Top-down approaches</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecast-reconciliation"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-domestic-tourism"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#reconciled-distributional-forecasts"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-prison-population"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#complex-seasonality"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#stl-with-multiple-seasonal-periods"><i class="fa fa-check"></i><b>12.1.1</b> STL with multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#prophet-model"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-quarterly-cement-production"><i class="fa fa-check"></i><b>12.2.1</b> Example: Quarterly cement production</a></li>
<li class="chapter" data-level="12.2.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-half-hourly-electricity-demand"><i class="fa fa-check"></i><b>12.2.2</b> Example: Half-hourly electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#vector-autoregressions"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daluchkin?tab=repositories">All Repositories</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice (3rd ed)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dynamic-regression-models" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Dynamic regression models<a href="dynamic-regression-models.html#dynamic-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><a href="https://otexts.com/fpp3/dynamic.html">The source of the chapter</a></p>
<div class="sourceCode" id="cb1236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1236-1"><a href="dynamic-regression-models.html#cb1236-1" tabindex="-1"></a><span class="co"># loading libraries</span></span>
<span id="cb1236-2"><a href="dynamic-regression-models.html#cb1236-2" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1236-3"><a href="dynamic-regression-models.html#cb1236-3" tabindex="-1"></a><span class="fu">library</span>(tsibbledata)</span>
<span id="cb1236-4"><a href="dynamic-regression-models.html#cb1236-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1236-5"><a href="dynamic-regression-models.html#cb1236-5" tabindex="-1"></a><span class="co"># to read data</span></span>
<span id="cb1236-6"><a href="dynamic-regression-models.html#cb1236-6" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1236-7"><a href="dynamic-regression-models.html#cb1236-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1236-8"><a href="dynamic-regression-models.html#cb1236-8" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb1236-9"><a href="dynamic-regression-models.html#cb1236-9" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb1236-10"><a href="dynamic-regression-models.html#cb1236-10" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb1236-11"><a href="dynamic-regression-models.html#cb1236-11" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb1236-12"><a href="dynamic-regression-models.html#cb1236-12" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<div id="regression-with-arima-errors-using-fable" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Regression with ARIMA errors using <code>fable</code><a href="dynamic-regression-models.html#regression-with-arima-errors-using-fable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/regarima.html">The source of the section</a></p>
<p>To fit a regression model with ARIMA errors, the <code>pdq()</code> specifies the order of the ARIMA errors model.</p>
<blockquote>
<p>If differencing is specifies, then the differencing is applied <strong>to all variables</strong> in the regression model. Use <code>ARIMA(y ~ x + pdq(1,1,0))</code> to apply dirfferencing to all variables.</p>
</blockquote>
<p>The constant disappears due to the differencing. Add 1 to include the constant.</p>
<div id="example-us-personal-consumption-and-income" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Example: US Personal Consumption and Income<a href="dynamic-regression-models.html#example-us-personal-consumption-and-income" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1237-1"><a href="dynamic-regression-models.html#cb1237-1" tabindex="-1"></a>us_change <span class="sc">|&gt;</span></span>
<span id="cb1237-2"><a href="dynamic-regression-models.html#cb1237-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(Consumption, Income),</span>
<span id="cb1237-3"><a href="dynamic-regression-models.html#cb1237-3" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;var&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1237-4"><a href="dynamic-regression-models.html#cb1237-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1237-5"><a href="dynamic-regression-models.html#cb1237-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(var <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb1237-6"><a href="dynamic-regression-models.html#cb1237-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US consumption and personal income&quot;</span>,</span>
<span id="cb1237-7"><a href="dynamic-regression-models.html#cb1237-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Quarterly % change&quot;</span>) <span class="sc">+</span></span>
<span id="cb1237-8"><a href="dynamic-regression-models.html#cb1237-8" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span><span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb1238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1238-1"><a href="dynamic-regression-models.html#cb1238-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> us_change <span class="sc">|&gt;</span></span>
<span id="cb1238-2"><a href="dynamic-regression-models.html#cb1238-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Consumption <span class="sc">~</span> Income))</span>
<span id="cb1238-3"><a href="dynamic-regression-models.html#cb1238-3" tabindex="-1"></a></span>
<span id="cb1238-4"><a href="dynamic-regression-models.html#cb1238-4" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Consumption 
## Model: LM w/ ARIMA(1,0,2) errors 
## 
## Coefficients:
##          ar1      ma1     ma2  Income  intercept
##       0.7070  -0.6172  0.2066  0.1976     0.5949
## s.e.  0.1068   0.1218  0.0741  0.0462     0.0850
## 
## sigma^2 estimated as 0.3113:  log likelihood=-163.04
## AIC=338.07   AICc=338.51   BIC=357.8</code></pre>
<div class="sourceCode" id="cb1240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1240-1"><a href="dynamic-regression-models.html#cb1240-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb1240-2"><a href="dynamic-regression-models.html#cb1240-2" tabindex="-1"></a>    <span class="st">`</span><span class="at">Regression residuals</span><span class="st">`</span> <span class="ot">=</span></span>
<span id="cb1240-3"><a href="dynamic-regression-models.html#cb1240-3" tabindex="-1"></a>        <span class="fu">as_tibble</span>(<span class="fu">residuals</span>(fit, <span class="at">type =</span> <span class="st">&quot;regression&quot;</span>)),</span>
<span id="cb1240-4"><a href="dynamic-regression-models.html#cb1240-4" tabindex="-1"></a>    <span class="st">`</span><span class="at">ARIMA residuals</span><span class="st">`</span> <span class="ot">=</span></span>
<span id="cb1240-5"><a href="dynamic-regression-models.html#cb1240-5" tabindex="-1"></a>        <span class="fu">as_tibble</span>(<span class="fu">residuals</span>(fit, <span class="at">type =</span> <span class="st">&quot;innovation&quot;</span>)),</span>
<span id="cb1240-6"><a href="dynamic-regression-models.html#cb1240-6" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;type&quot;</span></span>
<span id="cb1240-7"><a href="dynamic-regression-models.html#cb1240-7" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1240-8"><a href="dynamic-regression-models.html#cb1240-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1240-9"><a href="dynamic-regression-models.html#cb1240-9" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels=</span><span class="fu">c</span>(</span>
<span id="cb1240-10"><a href="dynamic-regression-models.html#cb1240-10" tabindex="-1"></a>      <span class="st">&quot;Regression residuals&quot;</span>, <span class="st">&quot;ARIMA residuals&quot;</span>))</span>
<span id="cb1240-11"><a href="dynamic-regression-models.html#cb1240-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1240-12"><a href="dynamic-regression-models.html#cb1240-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb1240-13"><a href="dynamic-regression-models.html#cb1240-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1240-14"><a href="dynamic-regression-models.html#cb1240-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(type))</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb1241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1241-1"><a href="dynamic-regression-models.html#cb1241-1" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb1242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1242-1"><a href="dynamic-regression-models.html#cb1242-1" tabindex="-1"></a><span class="fu">augment</span>(fit) <span class="sc">|&gt;</span></span>
<span id="cb1242-2"><a href="dynamic-regression-models.html#cb1242-2" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">dof =</span> <span class="dv">3</span>, <span class="at">lag =</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model                      lb_stat lb_pvalue
##   &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;
## 1 ARIMA(Consumption ~ Income)    5.21     0.391</code></pre>
<p>We cannot reject <span class="math inline">\(H_0\)</span>, so there is no autocorrelation in the residuals.</p>
</div>
</div>
<div id="forecasting-1" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Forecasting<a href="dynamic-regression-models.html#forecasting-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/forecasting.html">The source of the section</a></p>
<blockquote>
<p>To forecast using a regression model with ARIMA errors, we need to forecast the regression part of the model and the ARIMA part of the model, and combine the results. When the predictors are themselves unknown, we must either model them separately, or use assumed future values for each predictor.</p>
</blockquote>
<div id="example-us-personal-consumption-and-income-1" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Example: US Personal Consumption and Income<a href="dynamic-regression-models.html#example-us-personal-consumption-and-income-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1244-1"><a href="dynamic-regression-models.html#cb1244-1" tabindex="-1"></a>us_change_future <span class="ot">&lt;-</span> <span class="fu">new_data</span>(us_change, <span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb1244-2"><a href="dynamic-regression-models.html#cb1244-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">mean</span>(us_change<span class="sc">$</span>Income))</span>
<span id="cb1244-3"><a href="dynamic-regression-models.html#cb1244-3" tabindex="-1"></a></span>
<span id="cb1244-4"><a href="dynamic-regression-models.html#cb1244-4" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb1244-5"><a href="dynamic-regression-models.html#cb1244-5" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">new_data =</span> us_change_future) <span class="sc">|&gt;</span></span>
<span id="cb1244-6"><a href="dynamic-regression-models.html#cb1244-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(us_change) <span class="sc">+</span></span>
<span id="cb1244-7"><a href="dynamic-regression-models.html#cb1244-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Percentage change&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-7-1.png" width="672" /></p>
</div>
<div id="example-forecasting-electricity-demand" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Example: Forecasting electricity demand<a href="dynamic-regression-models.html#example-forecasting-electricity-demand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1245-1"><a href="dynamic-regression-models.html#cb1245-1" tabindex="-1"></a>vic_elec_daily <span class="ot">&lt;-</span> vic_elec <span class="sc">|&gt;</span></span>
<span id="cb1245-2"><a href="dynamic-regression-models.html#cb1245-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Time) <span class="sc">==</span> <span class="dv">2014</span>) <span class="sc">|&gt;</span></span>
<span id="cb1245-3"><a href="dynamic-regression-models.html#cb1245-3" tabindex="-1"></a>  <span class="fu">index_by</span>(<span class="at">Date =</span> <span class="fu">date</span>(Time)) <span class="sc">|&gt;</span></span>
<span id="cb1245-4"><a href="dynamic-regression-models.html#cb1245-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1245-5"><a href="dynamic-regression-models.html#cb1245-5" tabindex="-1"></a>    <span class="at">Demand =</span> <span class="fu">sum</span>(Demand) <span class="sc">/</span> <span class="fl">1e3</span>,</span>
<span id="cb1245-6"><a href="dynamic-regression-models.html#cb1245-6" tabindex="-1"></a>    <span class="at">Temperature =</span> <span class="fu">max</span>(Temperature),</span>
<span id="cb1245-7"><a href="dynamic-regression-models.html#cb1245-7" tabindex="-1"></a>    <span class="at">Holiday =</span> <span class="fu">any</span>(Holiday)</span>
<span id="cb1245-8"><a href="dynamic-regression-models.html#cb1245-8" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1245-9"><a href="dynamic-regression-models.html#cb1245-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day_Type =</span> <span class="fu">case_when</span>(</span>
<span id="cb1245-10"><a href="dynamic-regression-models.html#cb1245-10" tabindex="-1"></a>    Holiday <span class="sc">~</span> <span class="st">&quot;Holiday&quot;</span>,</span>
<span id="cb1245-11"><a href="dynamic-regression-models.html#cb1245-11" tabindex="-1"></a>    <span class="fu">wday</span>(Date) <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;Weekday&quot;</span>,</span>
<span id="cb1245-12"><a href="dynamic-regression-models.html#cb1245-12" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Weekend&quot;</span></span>
<span id="cb1245-13"><a href="dynamic-regression-models.html#cb1245-13" tabindex="-1"></a>  ))</span>
<span id="cb1245-14"><a href="dynamic-regression-models.html#cb1245-14" tabindex="-1"></a></span>
<span id="cb1245-15"><a href="dynamic-regression-models.html#cb1245-15" tabindex="-1"></a>vic_elec_daily <span class="sc">|&gt;</span></span>
<span id="cb1245-16"><a href="dynamic-regression-models.html#cb1245-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Temperature, <span class="at">y =</span> Demand, <span class="at">colour =</span> Day_Type)) <span class="sc">+</span></span>
<span id="cb1245-17"><a href="dynamic-regression-models.html#cb1245-17" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1245-18"><a href="dynamic-regression-models.html#cb1245-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Electricity demand (GW)&quot;</span>,</span>
<span id="cb1245-19"><a href="dynamic-regression-models.html#cb1245-19" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Maximum daily temperature&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb1246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1246-1"><a href="dynamic-regression-models.html#cb1246-1" tabindex="-1"></a>vic_elec_daily <span class="sc">|&gt;</span></span>
<span id="cb1246-2"><a href="dynamic-regression-models.html#cb1246-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(Demand, Temperature)) <span class="sc">|&gt;</span></span>
<span id="cb1246-3"><a href="dynamic-regression-models.html#cb1246-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb1246-4"><a href="dynamic-regression-models.html#cb1246-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1246-5"><a href="dynamic-regression-models.html#cb1246-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb1247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1247-1"><a href="dynamic-regression-models.html#cb1247-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> vic_elec_daily <span class="sc">|&gt;</span></span>
<span id="cb1247-2"><a href="dynamic-regression-models.html#cb1247-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Demand <span class="sc">~</span> Temperature <span class="sc">+</span> <span class="fu">I</span>(Temperature<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1247-3"><a href="dynamic-regression-models.html#cb1247-3" tabindex="-1"></a>                (Day_Type <span class="sc">==</span> <span class="st">&quot;Weekday&quot;</span>)))</span>
<span id="cb1247-4"><a href="dynamic-regression-models.html#cb1247-4" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb1248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1248-1"><a href="dynamic-regression-models.html#cb1248-1" tabindex="-1"></a><span class="co"># dof = p + q + P + Q = 2 + 2 + 2 + 0</span></span>
<span id="cb1248-2"><a href="dynamic-regression-models.html#cb1248-2" tabindex="-1"></a></span>
<span id="cb1248-3"><a href="dynamic-regression-models.html#cb1248-3" tabindex="-1"></a><span class="fu">augment</span>(fit) <span class="sc">|&gt;</span></span>
<span id="cb1248-4"><a href="dynamic-regression-models.html#cb1248-4" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">dof =</span> <span class="dv">6</span>, <span class="at">lag =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model                                                                             lb_stat lb_pvalue
##   &lt;chr&gt;                                                                                &lt;dbl&gt;     &lt;dbl&gt;
## 1 &quot;ARIMA(Demand ~ Temperature + I(Temperature^2) + (Day_Type == \n    \&quot;Weekday\&quot;))&quot;    28.4  0.000404</code></pre>
<div class="sourceCode" id="cb1250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1250-1"><a href="dynamic-regression-models.html#cb1250-1" tabindex="-1"></a>vic_elec_future <span class="ot">&lt;-</span> <span class="fu">new_data</span>(vic_elec_daily, <span class="dv">14</span>) <span class="sc">|&gt;</span></span>
<span id="cb1250-2"><a href="dynamic-regression-models.html#cb1250-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1250-3"><a href="dynamic-regression-models.html#cb1250-3" tabindex="-1"></a>    <span class="at">Temperature =</span> <span class="dv">26</span>,</span>
<span id="cb1250-4"><a href="dynamic-regression-models.html#cb1250-4" tabindex="-1"></a>    <span class="at">Holiday =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="fu">rep</span>(<span class="cn">FALSE</span>, <span class="dv">13</span>)),</span>
<span id="cb1250-5"><a href="dynamic-regression-models.html#cb1250-5" tabindex="-1"></a>    <span class="at">Day_Type =</span> <span class="fu">case_when</span>(</span>
<span id="cb1250-6"><a href="dynamic-regression-models.html#cb1250-6" tabindex="-1"></a>      Holiday <span class="sc">~</span> <span class="st">&quot;Holiday&quot;</span>,</span>
<span id="cb1250-7"><a href="dynamic-regression-models.html#cb1250-7" tabindex="-1"></a>      <span class="fu">wday</span>(Date) <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;Weekday&quot;</span>,</span>
<span id="cb1250-8"><a href="dynamic-regression-models.html#cb1250-8" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Weekend&quot;</span></span>
<span id="cb1250-9"><a href="dynamic-regression-models.html#cb1250-9" tabindex="-1"></a>    )</span>
<span id="cb1250-10"><a href="dynamic-regression-models.html#cb1250-10" tabindex="-1"></a>  )</span>
<span id="cb1250-11"><a href="dynamic-regression-models.html#cb1250-11" tabindex="-1"></a><span class="fu">forecast</span>(fit, vic_elec_future) <span class="sc">|&gt;</span></span>
<span id="cb1250-12"><a href="dynamic-regression-models.html#cb1250-12" tabindex="-1"></a>  <span class="fu">autoplot</span>(vic_elec_daily) <span class="sc">+</span></span>
<span id="cb1250-13"><a href="dynamic-regression-models.html#cb1250-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Daily electricity demand: Victoria&quot;</span>,</span>
<span id="cb1250-14"><a href="dynamic-regression-models.html#cb1250-14" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;GW&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-12-1.png" width="672" /></p>
</div>
</div>
<div id="stochastic-and-deterministic-trends" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Stochastic and deterministic trends<a href="dynamic-regression-models.html#stochastic-and-deterministic-trends" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/stochastic-and-deterministic-trends.html">The source of the section</a></p>
<div id="example-air-transport-passengers-australia" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Example: Air transport passengers Australia<a href="dynamic-regression-models.html#example-air-transport-passengers-australia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1251-1"><a href="dynamic-regression-models.html#cb1251-1" tabindex="-1"></a>aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb1251-2"><a href="dynamic-regression-models.html#cb1251-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(Passengers) <span class="sc">+</span></span>
<span id="cb1251-3"><a href="dynamic-regression-models.html#cb1251-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Passengers (millions)&#39;</span>,</span>
<span id="cb1251-4"><a href="dynamic-regression-models.html#cb1251-4" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Total annual air passengers&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-13-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>The deterministic trend model</li>
</ol>
<div class="sourceCode" id="cb1252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1252-1"><a href="dynamic-regression-models.html#cb1252-1" tabindex="-1"></a>fit_deterministic <span class="ot">&lt;-</span> aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb1252-2"><a href="dynamic-regression-models.html#cb1252-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">deterministic =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">trend</span>() <span class="sc">+</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>)))</span>
<span id="cb1252-3"><a href="dynamic-regression-models.html#cb1252-3" tabindex="-1"></a></span>
<span id="cb1252-4"><a href="dynamic-regression-models.html#cb1252-4" tabindex="-1"></a>fit_deterministic <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: LM w/ ARIMA(1,0,0) errors 
## 
## Coefficients:
##          ar1  trend()  intercept
##       0.9564   1.4151     0.9014
## s.e.  0.0362   0.1972     7.0751
## 
## sigma^2 estimated as 4.343:  log likelihood=-100.88
## AIC=209.77   AICc=210.72   BIC=217.17</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The stochastic trend model</li>
</ol>
<div class="sourceCode" id="cb1254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1254-1"><a href="dynamic-regression-models.html#cb1254-1" tabindex="-1"></a>fit_stochastic <span class="ot">&lt;-</span> aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb1254-2"><a href="dynamic-regression-models.html#cb1254-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stochastic =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">1</span>)))</span>
<span id="cb1254-3"><a href="dynamic-regression-models.html#cb1254-3" tabindex="-1"></a></span>
<span id="cb1254-4"><a href="dynamic-regression-models.html#cb1254-4" tabindex="-1"></a>fit_stochastic <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ARIMA(0,1,0) w/ drift 
## 
## Coefficients:
##       constant
##         1.4191
## s.e.    0.3014
## 
## sigma^2 estimated as 4.271:  log likelihood=-98.16
## AIC=200.31   AICc=200.59   BIC=203.97</code></pre>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1256-1"><a href="dynamic-regression-models.html#cb1256-1" tabindex="-1"></a>aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb1256-2"><a href="dynamic-regression-models.html#cb1256-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(Passengers) <span class="sc">+</span></span>
<span id="cb1256-3"><a href="dynamic-regression-models.html#cb1256-3" tabindex="-1"></a>  <span class="fu">autolayer</span>(fit_stochastic <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">20</span>),</span>
<span id="cb1256-4"><a href="dynamic-regression-models.html#cb1256-4" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;#0072B2&quot;</span>, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb1256-5"><a href="dynamic-regression-models.html#cb1256-5" tabindex="-1"></a>  <span class="fu">autolayer</span>(fit_deterministic <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">20</span>),</span>
<span id="cb1256-6"><a href="dynamic-regression-models.html#cb1256-6" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;#D55E00&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.65</span>, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb1256-7"><a href="dynamic-regression-models.html#cb1256-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Air passengers (millions)&quot;</span>,</span>
<span id="cb1256-8"><a href="dynamic-regression-models.html#cb1256-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Forecasts from trend models&quot;</span>)</span></code></pre></div>
<pre><code>## Scale for fill_ramp is already present.
## Adding another scale for fill_ramp, which will replace the existing scale.</code></pre>
<p><img src="figure_html/ch10-ts-dynamic-16-1.png" width="672" /></p>
<ul>
<li>The slope of the deterministic trend is not going to change over time.</li>
<li>It is safer to forecast with stochastic trends, especially for longer forecast horizons, as the prediction intervals allow for greater uncertainty in future growth.</li>
</ul>
</div>
</div>
<div id="dynamic-harmonic-regression" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Dynamic harmonic regression<a href="dynamic-regression-models.html#dynamic-harmonic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/dhr.html">The source of the section</a></p>
<p>The dynamic regression with Fourier terms is often better for long seasonal periods.</p>
<p>The <code>ARIMA()</code> function is allow a seasonal period up to <span class="math inline">\(m=350\)</span>.</p>
<p>The harmonic regression allows:</p>
<ul>
<li>any length seasonality</li>
<li>Fourier terms of different frequencies can be used for data with more than one seasonal period</li>
<li><span class="math inline">\(K\)</span> param controls the smoothness of the seasonal pattern. It is the number of Fourier sin and cos pairs. The smaller <span class="math inline">\(K\)</span> is, the smoother the seasonal pattern is.</li>
</ul>
<p>The seasonality has to have fixed pattern over time.</p>
</div>
<div id="example-australian-eating-out-expenditure" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Example: Australian eating out expenditure<a href="dynamic-regression-models.html#example-australian-eating-out-expenditure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1258-1"><a href="dynamic-regression-models.html#cb1258-1" tabindex="-1"></a>aus_cafe <span class="ot">&lt;-</span> aus_retail <span class="sc">|&gt;</span></span>
<span id="cb1258-2"><a href="dynamic-regression-models.html#cb1258-2" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb1258-3"><a href="dynamic-regression-models.html#cb1258-3" tabindex="-1"></a>    Industry <span class="sc">==</span> <span class="st">&quot;Cafes, restaurants and takeaway food services&quot;</span>,</span>
<span id="cb1258-4"><a href="dynamic-regression-models.html#cb1258-4" tabindex="-1"></a>    <span class="fu">year</span>(Month) <span class="sc">%in%</span> <span class="dv">2004</span><span class="sc">:</span><span class="dv">2018</span></span>
<span id="cb1258-5"><a href="dynamic-regression-models.html#cb1258-5" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1258-6"><a href="dynamic-regression-models.html#cb1258-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Turnover =</span> <span class="fu">sum</span>(Turnover))</span>
<span id="cb1258-7"><a href="dynamic-regression-models.html#cb1258-7" tabindex="-1"></a></span>
<span id="cb1258-8"><a href="dynamic-regression-models.html#cb1258-8" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">model</span>(aus_cafe,</span>
<span id="cb1258-9"><a href="dynamic-regression-models.html#cb1258-9" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 1</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-10"><a href="dynamic-regression-models.html#cb1258-10" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-11"><a href="dynamic-regression-models.html#cb1258-11" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 3</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-12"><a href="dynamic-regression-models.html#cb1258-12" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 4</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-13"><a href="dynamic-regression-models.html#cb1258-13" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 5</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-14"><a href="dynamic-regression-models.html#cb1258-14" tabindex="-1"></a>  <span class="st">`</span><span class="at">K = 6</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ARIMA</span>(<span class="fu">log</span>(Turnover) <span class="sc">~</span> <span class="fu">fourier</span>(<span class="at">K=</span><span class="dv">6</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb1258-15"><a href="dynamic-regression-models.html#cb1258-15" tabindex="-1"></a>)</span>
<span id="cb1258-16"><a href="dynamic-regression-models.html#cb1258-16" tabindex="-1"></a></span>
<span id="cb1258-17"><a href="dynamic-regression-models.html#cb1258-17" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb1258-18"><a href="dynamic-regression-models.html#cb1258-18" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="st">&quot;2 years&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1258-19"><a href="dynamic-regression-models.html#cb1258-19" tabindex="-1"></a>  <span class="fu">autoplot</span>(aus_cafe, <span class="at">level =</span> <span class="dv">95</span>) <span class="sc">+</span></span>
<span id="cb1258-20"><a href="dynamic-regression-models.html#cb1258-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(.model), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1258-21"><a href="dynamic-regression-models.html#cb1258-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">level =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1258-22"><a href="dynamic-regression-models.html#cb1258-22" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb1258-23"><a href="dynamic-regression-models.html#cb1258-23" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">yearmonth</span>(<span class="st">&quot;2007 Jan&quot;</span>), <span class="at">y =</span> <span class="dv">4250</span>,</span>
<span id="cb1258-24"><a href="dynamic-regression-models.html#cb1258-24" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;AICc = &quot;</span>, <span class="fu">format</span>(AICc))),</span>
<span id="cb1258-25"><a href="dynamic-regression-models.html#cb1258-25" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">glance</span>(fit)</span>
<span id="cb1258-26"><a href="dynamic-regression-models.html#cb1258-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1258-27"><a href="dynamic-regression-models.html#cb1258-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">&quot;Total monthly eating-out expenditure&quot;</span>,</span>
<span id="cb1258-28"><a href="dynamic-regression-models.html#cb1258-28" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;$ billions&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-17-1.png" width="672" /></p>
</div>
<div id="lagged-predictors" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Lagged predictors<a href="dynamic-regression-models.html#lagged-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/lagged-predictors.html">The source of the section</a></p>
<div id="example-tv-advertising-and-insurance-quotations" class="section level3 hasAnchor" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> Example: TV advertising and insurance quotations<a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1259-1"><a href="dynamic-regression-models.html#cb1259-1" tabindex="-1"></a>insurance <span class="sc">|&gt;</span></span>
<span id="cb1259-2"><a href="dynamic-regression-models.html#cb1259-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Quotes<span class="sc">:</span>TVadverts) <span class="sc">|&gt;</span></span>
<span id="cb1259-3"><a href="dynamic-regression-models.html#cb1259-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb1259-4"><a href="dynamic-regression-models.html#cb1259-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1259-5"><a href="dynamic-regression-models.html#cb1259-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb1259-6"><a href="dynamic-regression-models.html#cb1259-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Insurance advertising and quotations&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1260-1"><a href="dynamic-regression-models.html#cb1260-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> insurance <span class="sc">|&gt;</span></span>
<span id="cb1260-2"><a href="dynamic-regression-models.html#cb1260-2" tabindex="-1"></a>  <span class="co"># Restrict data so models use same fitting period</span></span>
<span id="cb1260-3"><a href="dynamic-regression-models.html#cb1260-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quotes =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, Quotes[<span class="dv">4</span><span class="sc">:</span><span class="dv">40</span>])) <span class="sc">|&gt;</span></span>
<span id="cb1260-4"><a href="dynamic-regression-models.html#cb1260-4" tabindex="-1"></a>  <span class="co"># Estimate models</span></span>
<span id="cb1260-5"><a href="dynamic-regression-models.html#cb1260-5" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1260-6"><a href="dynamic-regression-models.html#cb1260-6" tabindex="-1"></a>    <span class="at">lag0 =</span> <span class="fu">ARIMA</span>(Quotes <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>) <span class="sc">+</span> TVadverts),</span>
<span id="cb1260-7"><a href="dynamic-regression-models.html#cb1260-7" tabindex="-1"></a>    <span class="at">lag1 =</span> <span class="fu">ARIMA</span>(Quotes <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1260-8"><a href="dynamic-regression-models.html#cb1260-8" tabindex="-1"></a>                 TVadverts <span class="sc">+</span> <span class="fu">lag</span>(TVadverts)),</span>
<span id="cb1260-9"><a href="dynamic-regression-models.html#cb1260-9" tabindex="-1"></a>    <span class="at">lag2 =</span> <span class="fu">ARIMA</span>(Quotes <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1260-10"><a href="dynamic-regression-models.html#cb1260-10" tabindex="-1"></a>                 TVadverts <span class="sc">+</span> <span class="fu">lag</span>(TVadverts) <span class="sc">+</span></span>
<span id="cb1260-11"><a href="dynamic-regression-models.html#cb1260-11" tabindex="-1"></a>                 <span class="fu">lag</span>(TVadverts, <span class="dv">2</span>)),</span>
<span id="cb1260-12"><a href="dynamic-regression-models.html#cb1260-12" tabindex="-1"></a>    <span class="at">lag3 =</span> <span class="fu">ARIMA</span>(Quotes <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1260-13"><a href="dynamic-regression-models.html#cb1260-13" tabindex="-1"></a>                 TVadverts <span class="sc">+</span> <span class="fu">lag</span>(TVadverts) <span class="sc">+</span></span>
<span id="cb1260-14"><a href="dynamic-regression-models.html#cb1260-14" tabindex="-1"></a>                 <span class="fu">lag</span>(TVadverts, <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lag</span>(TVadverts, <span class="dv">3</span>))</span>
<span id="cb1260-15"><a href="dynamic-regression-models.html#cb1260-15" tabindex="-1"></a>  )</span>
<span id="cb1260-16"><a href="dynamic-regression-models.html#cb1260-16" tabindex="-1"></a></span>
<span id="cb1260-17"><a href="dynamic-regression-models.html#cb1260-17" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">glance</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 × 8
##   .model sigma2 log_lik   AIC  AICc   BIC ar_roots  ma_roots 
##   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   
## 1 lag0    0.265   -28.3  66.6  68.3  75.0 &lt;cpl [2]&gt; &lt;cpl [0]&gt;
## 2 lag1    0.209   -24.0  58.1  59.9  66.5 &lt;cpl [1]&gt; &lt;cpl [1]&gt;
## 3 lag2    0.215   -24.0  60.0  62.6  70.2 &lt;cpl [1]&gt; &lt;cpl [1]&gt;
## 4 lag3    0.206   -22.2  60.3  65.0  73.8 &lt;cpl [1]&gt; &lt;cpl [1]&gt;</code></pre>
<div class="sourceCode" id="cb1262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1262-1"><a href="dynamic-regression-models.html#cb1262-1" tabindex="-1"></a>fit_best <span class="ot">&lt;-</span> insurance <span class="sc">|&gt;</span></span>
<span id="cb1262-2"><a href="dynamic-regression-models.html#cb1262-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Quotes <span class="sc">~</span> <span class="fu">pdq</span>(<span class="at">d =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1262-3"><a href="dynamic-regression-models.html#cb1262-3" tabindex="-1"></a>              TVadverts <span class="sc">+</span> <span class="fu">lag</span>(TVadverts)))</span>
<span id="cb1262-4"><a href="dynamic-regression-models.html#cb1262-4" tabindex="-1"></a><span class="fu">report</span>(fit_best)</span></code></pre></div>
<pre><code>## Series: Quotes 
## Model: LM w/ ARIMA(1,0,2) errors 
## 
## Coefficients:
##          ar1     ma1     ma2  TVadverts  lag(TVadverts)  intercept
##       0.5123  0.9169  0.4591     1.2527          0.1464     2.1554
## s.e.  0.1849  0.2051  0.1895     0.0588          0.0531     0.8595
## 
## sigma^2 estimated as 0.2166:  log likelihood=-23.94
## AIC=61.88   AICc=65.38   BIC=73.7</code></pre>
<div class="sourceCode" id="cb1264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1264-1"><a href="dynamic-regression-models.html#cb1264-1" tabindex="-1"></a>insurance_future <span class="ot">&lt;-</span> <span class="fu">new_data</span>(insurance, <span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb1264-2"><a href="dynamic-regression-models.html#cb1264-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TVadverts =</span> <span class="dv">8</span>)</span>
<span id="cb1264-3"><a href="dynamic-regression-models.html#cb1264-3" tabindex="-1"></a>fit_best <span class="sc">|&gt;</span></span>
<span id="cb1264-4"><a href="dynamic-regression-models.html#cb1264-4" tabindex="-1"></a>  <span class="fu">forecast</span>(insurance_future) <span class="sc">|&gt;</span></span>
<span id="cb1264-5"><a href="dynamic-regression-models.html#cb1264-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(insurance) <span class="sc">+</span></span>
<span id="cb1264-6"><a href="dynamic-regression-models.html#cb1264-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1264-7"><a href="dynamic-regression-models.html#cb1264-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Quotes&quot;</span>,</span>
<span id="cb1264-8"><a href="dynamic-regression-models.html#cb1264-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Forecast quotes with future advertising set to 8&quot;</span></span>
<span id="cb1264-9"><a href="dynamic-regression-models.html#cb1264-9" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="figure_html/ch10-ts-dynamic-21-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="forecasting-hierarchical-and-grouped-time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
