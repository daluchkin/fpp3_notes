<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Time series decomposition | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="Chapter 3 Time series decomposition | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Time series decomposition | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/daluchkin/fpp3_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Time series decomposition | Forecasting: Principles and Practice (3rd ed)" />
  
  
  

<meta name="author" content="Dmitry Luchkin" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-graphics.html"/>
<link rel="next" href="time-series-features.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice (3rd ed)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#what-can-be-forecast"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#forecasting-goals-and-planning"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#determining-what-to-forecast"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#forecasting-data-and-methods"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#some-case-studies"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#the-basic-steps-in-a-forecasting-task"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting"><i class="fa fa-check"></i><b>1.6.1</b> Summary: Five Basic Steps of Forecasting</a></li>
<li class="chapter" data-level="1.6.2" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting-1"><i class="fa fa-check"></i><b>1.6.2</b> Summary: Five Basic Steps of Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started.html"><a href="getting-started.html#the-statistical-forecasting-perspective"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started.html"><a href="getting-started.html#excercises"><i class="fa fa-check"></i><b>1.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-object"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> object</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-index-variable"><i class="fa fa-check"></i><b>2.1.1</b> The index variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-key-variable"><i class="fa fa-check"></i><b>2.1.2</b> The key variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#working-with-tsibble-object"><i class="fa fa-check"></i><b>2.1.3</b> Working with <code>tsibble</code> object</a></li>
<li class="chapter" data-level="2.1.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#read-a-csv-file-and-convert-to-a-tsibble"><i class="fa fa-check"></i><b>2.1.4</b> Read a csv file and convert to a tsibble</a></li>
<li class="chapter" data-level="2.1.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-seasonal-period"><i class="fa fa-check"></i><b>2.1.5</b> The seasonal period</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plot"><i class="fa fa-check"></i><b>2.2</b> Time plot</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-series-patterns"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplots"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#correlation"><i class="fa fa-check"></i><b>2.6.1</b> Correlation</a></li>
<li class="chapter" data-level="2.6.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.2</b> Scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.8.1</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="time-series-graphics.html"><a href="time-series-graphics.html#white-moise"><i class="fa fa-check"></i><b>2.9</b> White moise</a></li>
<li class="chapter" data-level="2.10" data-path="time-series-graphics.html"><a href="time-series-graphics.html#excercises-1"><i class="fa fa-check"></i><b>2.10</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformations-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#mathematical-transformations"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#time-series-components"><i class="fa fa-check"></i><b>3.2</b> Time series components</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seasonally-adjusted-data"><i class="fa fa-check"></i><b>3.2.1</b> Seasonally adjusted data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-average-smoothing"><i class="fa fa-check"></i><b>3.3.1</b> Moving average smoothing</a></li>
<li class="chapter" data-level="3.3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.3.2</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-with-seasonal-data"><i class="fa fa-check"></i><b>3.3.3</b> Estimating the trend-cycle with seasonal data</a></li>
<li class="chapter" data-level="3.3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>3.3.4</b> Example: Employment in the US retail sector</a></li>
<li class="chapter" data-level="3.3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.3.5</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#additive-decomposition"><i class="fa fa-check"></i><b>3.4.1</b> Additive decomposition</a></li>
<li class="chapter" data-level="3.4.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#multiplicative-decomposition"><i class="fa fa-check"></i><b>3.4.2</b> Multiplicative decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#excercises-2"><i class="fa fa-check"></i><b>3.5</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#some-simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.1.1</b> ACF features</a></li>
<li class="chapter" data-level="4.1.2" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.1.2</b> STL features</a></li>
<li class="chapter" data-level="4.1.3" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.1.3</b> Other features</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#exploring-australian-tourism-data"><i class="fa fa-check"></i><b>4.2</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#exercises"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#plot-the-data-visualise"><i class="fa fa-check"></i><b>5.1.2</b> Plot the data (visualise)</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naiïve-method"><i class="fa fa-check"></i><b>5.2.2</b> Naiïve method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naïve-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#model-fitting"><i class="fa fa-check"></i><b>5.2.5</b> Model fitting</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#producing-forecasts"><i class="fa fa-check"></i><b>5.2.6</b> Producing forecasts</a></li>
<li class="chapter" data-level="5.2.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualising-forecasts"><i class="fa fa-check"></i><b>5.2.7</b> Visualising forecasts</a></li>
<li class="chapter" data-level="5.2.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-facebook-closing-stock-price"><i class="fa fa-check"></i><b>5.2.8</b> Example: Facebook closing stock price</a></li>
<li class="chapter" data-level="5.2.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.9</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.10</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values"><i class="fa fa-check"></i><b>5.3.1</b> Fitted values</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.2</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#acf-of-residuals"><i class="fa fa-check"></i><b>5.4.1</b> ACF of residuals</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-google-daily-closing-stock-prices"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting Google daily closing stock prices</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-distributions"><i class="fa fa-check"></i><b>5.5.1</b> Forecast distributions</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.3</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.4</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#benchmark-methods"><i class="fa fa-check"></i><b>5.5.5</b> Benchmark methods</a></li>
<li class="chapter" data-level="5.5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.6</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector-1"><i class="fa fa-check"></i><b>5.7.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-point-forecast-accuracy"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#training-and-test-sets"><i class="fa fa-check"></i><b>5.8.1</b> Training and test sets</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#functions-to-subset-a-time-series"><i class="fa fa-check"></i><b>5.8.2</b> Functions to subset a time series</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.8.3</b> Forecast errors</a></li>
<li class="chapter" data-level="5.8.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.8.4</b> Scale-dependent errors</a></li>
<li class="chapter" data-level="5.8.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.8.5</b> Percentage errors</a></li>
<li class="chapter" data-level="5.8.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.8.6</b> Scaled errors</a></li>
<li class="chapter" data-level="5.8.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples"><i class="fa fa-check"></i><b>5.8.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-distributional-forecast-accuracy"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#quantile-scores"><i class="fa fa-check"></i><b>5.9.1</b> Quantile scores</a></li>
<li class="chapter" data-level="5.9.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#winkler-score"><i class="fa fa-check"></i><b>5.9.2</b> Winkler Score</a></li>
<li class="chapter" data-level="5.9.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#continuous-ranked-probability-score"><i class="fa fa-check"></i><b>5.9.3</b> Continuous Ranked Probability Score</a></li>
<li class="chapter" data-level="5.9.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-free-comparisons-using-skill-scores"><i class="fa fa-check"></i><b>5.9.4</b> Scale-free comparisons using skill scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.10.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#exercises-1"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values-1"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness-of-fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-the-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#acf-plot-of-residuals"><i class="fa fa-check"></i><b>7.3.1</b> ACF plot of residuals</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#histogram-of-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Histogram of residuals</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.3</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.4</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.5</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.6</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.3</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusted-r2"><i class="fa fa-check"></i><b>7.5.1</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross-validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#corrected-akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Corrected Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#schwarzs-bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.5</b> Schwarz’s Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>7.5.6</b> Stepwise regression</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.1</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals-1"><i class="fa fa-check"></i><b>7.6.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.7.1</b> Forecasting with a nonlinear trend</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>7.8.1</b> Correlation is not causation</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-correlated-predictors"><i class="fa fa-check"></i><b>7.8.2</b> Forecasting with correlated predictors</a></li>
<li class="chapter" data-level="7.8.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multicollinearity-and-forecasting"><i class="fa fa-check"></i><b>7.8.3</b> Multicollinearity and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimisation"><i class="fa fa-check"></i><b>8.1.4</b> Optimisation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.2</b> Damped trend methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-seasonality"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.3.1</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.3.2</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.3.3</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.3.4</b> Holt-Winters’ damped method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>8.6.1</b> Model selection</a></li>
<li class="chapter" data-level="8.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.6.2</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-2"><i class="fa fa-check"></i><b>8.7.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#excercises-3"><i class="fa fa-check"></i><b>8.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>9.1.1</b> Differencing</a></li>
<li class="chapter" data-level="9.1.2" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>9.1.2</b> Second-order differencing</a></li>
<li class="chapter" data-level="9.1.3" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>9.1.3</b> Seasonal differencing</a></li>
<li class="chapter" data-level="9.1.4" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>9.1.4</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive (AR) models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="arima-models.html"><a href="arima-models.html#ar1-model"><i class="fa fa-check"></i><b>9.3.1</b> AR(1) model</a></li>
<li class="chapter" data-level="9.3.2" data-path="arima-models.html"><a href="arima-models.html#ar2-model"><i class="fa fa-check"></i><b>9.3.2</b> AR(2) model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="arima-models.html"><a href="arima-models.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="arima-models.html"><a href="arima-models.html#example-egyptian-exports"><i class="fa fa-check"></i><b>9.5.1</b> Example: Egyptian exports</a></li>
<li class="chapter" data-level="9.5.2" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-plots"><i class="fa fa-check"></i><b>9.5.2</b> ACF and PACF plots</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-fable"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>9.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="9.7.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>9.7.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="9.7.3" data-path="arima-models.html"><a href="arima-models.html#example-central-african-republic-exports"><i class="fa fa-check"></i><b>9.7.3</b> Example: Central African Republic exports</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals-3"><i class="fa fa-check"></i><b>9.8.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="arima-models.html"><a href="arima-models.html#arima-model-notation"><i class="fa fa-check"></i><b>9.9.1</b> ARIMA Model Notation</a></li>
<li class="chapter" data-level="9.9.2" data-path="arima-models.html"><a href="arima-models.html#acfpacf"><i class="fa fa-check"></i><b>9.9.2</b> ACF/PACF</a></li>
<li class="chapter" data-level="9.9.3" data-path="arima-models.html"><a href="arima-models.html#example-monthly-us-leisure-and-hospitality-employment"><i class="fa fa-check"></i><b>9.9.3</b> Example: Monthly US leisure and hospitality employment</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="arima-models.html"><a href="arima-models.html#arima-vs-ets"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>9.10.1</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="9.10.2" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>9.10.2</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="arima-models.html"><a href="arima-models.html#exercises-3"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors-using-fable"><i class="fa fa-check"></i><b>10.1</b> Regression with ARIMA errors using <code>fable</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>10.1.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting-1"><i class="fa fa-check"></i><b>10.2</b> Forecasting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income-1"><i class="fa fa-check"></i><b>10.2.1</b> Example: US Personal Consumption and Income</a></li>
<li class="chapter" data-level="10.2.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>10.2.2</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#stochastic-and-deterministic-trends"><i class="fa fa-check"></i><b>10.3</b> Stochastic and deterministic trends</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-air-transport-passengers-australia"><i class="fa fa-check"></i><b>10.3.1</b> Example: Air transport passengers Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>10.4</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>10.5</b> Example: Australian eating out expenditure</a></li>
<li class="chapter" data-level="10.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>10.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-and-grouped-time-series"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-time-series"><i class="fa fa-check"></i><b>11.1.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="11.1.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-tourism-hierarchy"><i class="fa fa-check"></i><b>11.1.2</b> Example: Australian tourism hierarchy</a></li>
<li class="chapter" data-level="11.1.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#grouped-time-series"><i class="fa fa-check"></i><b>11.1.3</b> Grouped time series</a></li>
<li class="chapter" data-level="11.1.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-prison-population"><i class="fa fa-check"></i><b>11.1.4</b> Example: Australian prison population</a></li>
<li class="chapter" data-level="11.1.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#mixed-hierarchical-and-grouped-structure"><i class="fa fa-check"></i><b>11.1.5</b> Mixed hierarchical and grouped structure</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#single-level-approaches"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#the-bottom-up-approach"><i class="fa fa-check"></i><b>11.2.1</b> The bottom-up approach</a></li>
<li class="chapter" data-level="11.2.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#top-down-approaches"><i class="fa fa-check"></i><b>11.2.2</b> Top-down approaches</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecast-reconciliation"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-domestic-tourism"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#reconciled-distributional-forecasts"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-prison-population"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#complex-seasonality"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#stl-with-multiple-seasonal-periods"><i class="fa fa-check"></i><b>12.1.1</b> STL with multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#prophet-model"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-quarterly-cement-production"><i class="fa fa-check"></i><b>12.2.1</b> Example: Quarterly cement production</a></li>
<li class="chapter" data-level="12.2.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-half-hourly-electricity-demand"><i class="fa fa-check"></i><b>12.2.2</b> Example: Half-hourly electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#vector-autoregressions"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daluchkin?tab=repositories">All Repositories</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice (3rd ed)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-decomposition" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Time series decomposition<a href="time-series-decomposition.html#time-series-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><a href="https://otexts.com/fpp3/decomposition.html">The source of the chapter</a></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="time-series-decomposition.html#cb229-1" tabindex="-1"></a><span class="co"># loading libraries</span></span>
<span id="cb229-2"><a href="time-series-decomposition.html#cb229-2" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb229-3"><a href="time-series-decomposition.html#cb229-3" tabindex="-1"></a><span class="fu">library</span>(tsibbledata)</span>
<span id="cb229-4"><a href="time-series-decomposition.html#cb229-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb229-5"><a href="time-series-decomposition.html#cb229-5" tabindex="-1"></a><span class="co"># to read data</span></span>
<span id="cb229-6"><a href="time-series-decomposition.html#cb229-6" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb229-7"><a href="time-series-decomposition.html#cb229-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb229-8"><a href="time-series-decomposition.html#cb229-8" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb229-9"><a href="time-series-decomposition.html#cb229-9" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb229-10"><a href="time-series-decomposition.html#cb229-10" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb229-11"><a href="time-series-decomposition.html#cb229-11" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb229-12"><a href="time-series-decomposition.html#cb229-12" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<p>Components:</p>
<ul>
<li>Trend</li>
<li>Cyclic</li>
<li>Seasonal (some times there can be more than one seasonal component)</li>
<li>Remainder component</li>
</ul>
<div id="transformations-and-adjustments" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Transformations and adjustments<a href="time-series-decomposition.html#transformations-and-adjustments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/transformations.html">The source of the section</a></p>
<p>To remove the source of variation or make the pattern core consistent across the data set, the following adjustments and transformation will be considered:</p>
<ul>
<li>calendar adjustments</li>
<li>population adjustments</li>
<li>inflation adjustments</li>
<li>mathematical transformations</li>
</ul>
<div id="calendar-adjustments" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Calendar adjustments<a href="time-series-decomposition.html#calendar-adjustments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calendar adjustments of time series are important when dealing with time series data that are influenced by variations in the number of days in a month, public holidays, weekends, or other calendar-related factors. These adjustments help remove calendar effects and make the data more comparable over time.</p>
<blockquote>
<p>For example… It is easy to remove this variation by computing average sales per trading day in each month, rather than total sales in the month.</p>
</blockquote>
</div>
<div id="population-adjustments" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Population adjustments<a href="time-series-decomposition.html#population-adjustments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Any data that are affected by population changes can be adjusted to give per-capita data. That is, consider the data per person (or per thousand people, or per million people) rather than the total.</p>
</blockquote>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="time-series-decomposition.html#cb230-1" tabindex="-1"></a><span class="fu">head</span>(global_economy)</span></code></pre></div>
<pre><code>## # A tsibble: 6 x 9 [1Y]
## # Key:       Country [1]
##   Country     Code   Year         GDP Growth   CPI Imports Exports Population
##   &lt;fct&gt;       &lt;fct&gt; &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
## 1 Afghanistan AFG    1960  537777811.     NA    NA    7.02    4.13    8996351
## 2 Afghanistan AFG    1961  548888896.     NA    NA    8.10    4.45    9166764
## 3 Afghanistan AFG    1962  546666678.     NA    NA    9.35    4.88    9345868
## 4 Afghanistan AFG    1963  751111191.     NA    NA   16.9     9.17    9533954
## 5 Afghanistan AFG    1964  800000044.     NA    NA   18.1     8.89    9731361
## 6 Afghanistan AFG    1965 1006666638.     NA    NA   21.4    11.3     9938414</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="time-series-decomposition.html#cb232-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb232-2"><a href="time-series-decomposition.html#cb232-2" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Australia&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb232-3"><a href="time-series-decomposition.html#cb232-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(GDP<span class="sc">/</span>Population) <span class="sc">+</span></span>
<span id="cb232-4"><a href="time-series-decomposition.html#cb232-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">&quot;GDP per capita&quot;</span>, <span class="at">y =</span> <span class="st">&quot;$US&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-2-1.png" width="672" /></p>
</div>
<div id="inflation-adjustments" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Inflation adjustments<a href="time-series-decomposition.html#inflation-adjustments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>To make these adjustments, a price index is used. If <span class="math inline">\(z_t\)</span> denotes the price index and <span class="math inline">\(y_t\)</span> denotes the original house price in year <span class="math inline">\(t\)</span>, then <span class="math inline">\(x_t = y_t/z_t \times z_{2000}\)</span> gives the adjusted house price at year 2000 dollar values. Price indexes are often constructed by government agencies. For consumer goods, a common price index is the Consumer Price Index (or CPI).</p>
</blockquote>
<p>This allows us to compare the growth or decline of industries relative to a common price value. For example, looking at aggregate annual “newspaper and book” retail turnover from <code>aus_retail</code>, and adjusting the data for inflation using CPI from <code>global_economy</code> allows us to understand the changes over time.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="time-series-decomposition.html#cb233-1" tabindex="-1"></a><span class="co"># sum turnover for printing by year</span></span>
<span id="cb233-2"><a href="time-series-decomposition.html#cb233-2" tabindex="-1"></a>print_retail <span class="ot">&lt;-</span> aus_retail <span class="sc">|&gt;</span>  <span class="co"># monthly retail turnover in Australia in $M AUD</span></span>
<span id="cb233-3"><a href="time-series-decomposition.html#cb233-3" tabindex="-1"></a>  <span class="fu">filter</span>(Industry <span class="sc">==</span> <span class="st">&#39;Newspaper and book retailing&#39;</span>) <span class="sc">|&gt;</span> <span class="co"># filter printing</span></span>
<span id="cb233-4"><a href="time-series-decomposition.html#cb233-4" tabindex="-1"></a>  <span class="fu">index_by</span>(<span class="at">Year =</span> <span class="fu">year</span>(Month)) <span class="sc">|&gt;</span> <span class="co"># grouping by index (key: Month)</span></span>
<span id="cb233-5"><a href="time-series-decomposition.html#cb233-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Turnover =</span> <span class="fu">sum</span>(Turnover)) <span class="co"># summarise</span></span>
<span id="cb233-6"><a href="time-series-decomposition.html#cb233-6" tabindex="-1"></a></span>
<span id="cb233-7"><a href="time-series-decomposition.html#cb233-7" tabindex="-1"></a><span class="co"># get all economic data by year for Aus</span></span>
<span id="cb233-8"><a href="time-series-decomposition.html#cb233-8" tabindex="-1"></a>aus_economy <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb233-9"><a href="time-series-decomposition.html#cb233-9" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;AUS&#39;</span>)</span>
<span id="cb233-10"><a href="time-series-decomposition.html#cb233-10" tabindex="-1"></a></span>
<span id="cb233-11"><a href="time-series-decomposition.html#cb233-11" tabindex="-1"></a>print_retail <span class="sc">|&gt;</span></span>
<span id="cb233-12"><a href="time-series-decomposition.html#cb233-12" tabindex="-1"></a>  <span class="fu">left_join</span>(aus_economy, <span class="at">by=</span><span class="st">&#39;Year&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb233-13"><a href="time-series-decomposition.html#cb233-13" tabindex="-1"></a>  <span class="co"># Inflation adjustments</span></span>
<span id="cb233-14"><a href="time-series-decomposition.html#cb233-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Adjusted_turnover_base2010 =</span> Turnover <span class="sc">/</span> CPI <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb233-15"><a href="time-series-decomposition.html#cb233-15" tabindex="-1"></a>                                                    <span class="co"># ^^^ base value (2010)</span></span>
<span id="cb233-16"><a href="time-series-decomposition.html#cb233-16" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Turnover, Adjusted_turnover_base2010),</span>
<span id="cb233-17"><a href="time-series-decomposition.html#cb233-17" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Turnover&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb233-18"><a href="time-series-decomposition.html#cb233-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;Turnover&#39;</span>, <span class="st">&#39;Adjusted_turnover_base2010&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb233-19"><a href="time-series-decomposition.html#cb233-19" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y =</span> Turnover)) <span class="sc">+</span></span>
<span id="cb233-20"><a href="time-series-decomposition.html#cb233-20" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb233-21"><a href="time-series-decomposition.html#cb233-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb233-22"><a href="time-series-decomposition.html#cb233-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Turnover: Australian print media industry&#39;</span>,</span>
<span id="cb233-23"><a href="time-series-decomposition.html#cb233-23" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;$AU&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-3-1.png" width="672" /></p>
<blockquote>
<p>By adjusting for inflation using the CPI, we can see that Australia’s newspaper and book retailing industry has been in decline much longer than the original data suggests. The adjusted turnover is in 2010 Australian dollars, as CPI is 100 in 2010 in this data set.</p>
</blockquote>
</div>
<div id="mathematical-transformations" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Mathematical transformations<a href="time-series-decomposition.html#mathematical-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>If the data shows variation that increases or decreases with the level of the series, then a transformation can be useful.</p>
</blockquote>
<p>If we the original observations as <span class="math inline">\(y_1, ..., y_T\)</span> and the transformed observations as <span class="math inline">\(w_1, ..., w_T\)</span>, then <span class="math inline">\(w_t = log(y_t)\)</span>. Changes in a log value are relative (or percentage) changes on the original scale.</p>
<blockquote>
<p>If any value of the original series is zero or negative, then logarithms are not possible.</p>
</blockquote>
<div id="box-cox-transformations" class="section level4 hasAnchor" number="3.1.4.1">
<h4><span class="header-section-number">3.1.4.1</span> Box-Cox transformations<a href="time-series-decomposition.html#box-cox-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[ w_t =
\begin{cases}
ln(y_t) &amp; \lambda = 0; \\
\frac {(y_t + 1)^{\lambda}-1} {\lambda} &amp; otherwise
\end{cases} \]</span></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="time-series-decomposition.html#cb234-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb234-2"><a href="time-series-decomposition.html#cb234-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(Gas)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="time-series-decomposition.html#cb235-1" tabindex="-1"></a><span class="co"># the optimal lambda</span></span>
<span id="cb235-2"><a href="time-series-decomposition.html#cb235-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">BoxCox.lambda</span>(aus_production<span class="sc">$</span>Gas)</span>
<span id="cb235-3"><a href="time-series-decomposition.html#cb235-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;BoxCox lambda:&#39;</span>, lambda))</span></code></pre></div>
<pre><code>## [1] &quot;BoxCox lambda: 0.10618213199493&quot;</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="time-series-decomposition.html#cb237-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb237-2"><a href="time-series-decomposition.html#cb237-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gas_boxcox =</span> <span class="fu">BoxCox</span>(Gas, <span class="fu">BoxCox.lambda</span>(Gas))) <span class="sc">|&gt;</span></span>
<span id="cb237-3"><a href="time-series-decomposition.html#cb237-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Gas_boxcox) <span class="sc">+</span></span>
<span id="cb237-4"><a href="time-series-decomposition.html#cb237-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;BoxCox transformed gas&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-4-2.png" width="672" /></p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="time-series-decomposition.html#cb238-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb238-2"><a href="time-series-decomposition.html#cb238-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gas_boxcox =</span> <span class="fu">box_cox</span>(Gas, lambda)) <span class="sc">|&gt;</span></span>
<span id="cb238-3"><a href="time-series-decomposition.html#cb238-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gas_inv =</span> <span class="fu">inv_box_cox</span>(Gas_boxcox, lambda)) <span class="sc">|&gt;</span></span>
<span id="cb238-4"><a href="time-series-decomposition.html#cb238-4" tabindex="-1"></a>  <span class="fu">select</span>(Gas, Gas_boxcox, Gas_inv)</span></code></pre></div>
<pre><code>## # A tsibble: 218 x 4 [1Q]
##      Gas Gas_boxcox Gas_inv Quarter
##    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;qtr&gt;
##  1     5       1.76    5.00 1956 Q1
##  2     6       1.97    6.00 1956 Q2
##  3     7       2.16    7    1956 Q3
##  4     6       1.97    6.00 1956 Q4
##  5     5       1.76    5.00 1957 Q1
##  6     7       2.16    7    1957 Q2
##  7     7       2.16    7    1957 Q3
##  8     6       1.97    6.00 1957 Q4
##  9     5       1.76    5.00 1958 Q1
## 10     7       2.16    7    1958 Q2
## # ℹ 208 more rows</code></pre>
<p>Choosing <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="time-series-decomposition.html#cb240-1" tabindex="-1"></a><span class="co"># way 1 - forecast pkg</span></span>
<span id="cb240-2"><a href="time-series-decomposition.html#cb240-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;BoxCox lambda (BoxCox.lambda(...)):&#39;</span>, <span class="fu">BoxCox.lambda</span>(aus_production<span class="sc">$</span>Gas)))</span></code></pre></div>
<pre><code>## [1] &quot;BoxCox lambda (BoxCox.lambda(...)): 0.10618213199493&quot;</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="time-series-decomposition.html#cb242-1" tabindex="-1"></a><span class="co"># way 2 - feasts pkg</span></span>
<span id="cb242-2"><a href="time-series-decomposition.html#cb242-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;BoxCox lambda (guerrero(...)):&#39;</span>, <span class="fu">guerrero</span>(aus_production<span class="sc">$</span>Gas)))</span></code></pre></div>
<pre><code>## [1] &quot;BoxCox lambda (guerrero(...)): 0.106187916462318&quot;</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="time-series-decomposition.html#cb244-1" tabindex="-1"></a><span class="co"># way 3 - fabletools pkg</span></span>
<span id="cb244-2"><a href="time-series-decomposition.html#cb244-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb244-3"><a href="time-series-decomposition.html#cb244-3" tabindex="-1"></a>  <span class="fu">features</span>(Gas, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb244-4"><a href="time-series-decomposition.html#cb244-4" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb244-5"><a href="time-series-decomposition.html#cb244-5" tabindex="-1"></a></span>
<span id="cb244-6"><a href="time-series-decomposition.html#cb244-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;BoxCox lambda (features(..., features = guerrero)):&#39;</span>, lambda))</span></code></pre></div>
<pre><code>## [1] &quot;BoxCox lambda (features(..., features = guerrero)): 0.109517112981612&quot;</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="time-series-decomposition.html#cb246-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb246-2"><a href="time-series-decomposition.html#cb246-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">box_cox</span>(Gas, lambda)) <span class="sc">+</span></span>
<span id="cb246-3"><a href="time-series-decomposition.html#cb246-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb246-4"><a href="time-series-decomposition.html#cb246-4" tabindex="-1"></a>       <span class="at">title =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste0</span>(</span>
<span id="cb246-5"><a href="time-series-decomposition.html#cb246-5" tabindex="-1"></a>         <span class="st">&quot;Transformed gas production with $</span><span class="sc">\\</span><span class="st">lambda$ = &quot;</span>,</span>
<span id="cb246-6"><a href="time-series-decomposition.html#cb246-6" tabindex="-1"></a>         <span class="fu">round</span>(lambda,<span class="dv">2</span>))))</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-6-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="time-series-components" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Time series components<a href="time-series-decomposition.html#time-series-components" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/components.html">The source of the section</a></p>
<ul>
<li><strong>Trend</strong> pattern exists when there is a long-term increase or decrease in the data</li>
<li><strong>Cyclic</strong> pattern exists when data exhibit rises and falls that are not of fixed period (duration usually of at least 2 years)</li>
<li><strong>Seasonal</strong> pattern exists when a series is influenced by seasonal factors (quarter, month, day of the week)</li>
</ul>
<p>The <strong>additive</strong> decomposition of a time series is represented as:</p>
<p><span class="math display">\[Y_t = T_t + S_t + R_t\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_t\)</span> is the observed value at time <span class="math inline">\(t\)</span>,<br />
</li>
<li><span class="math inline">\(T_t\)</span> is the trend component,<br />
</li>
<li><span class="math inline">\(S_t\)</span> is the seasonal component,<br />
</li>
<li><span class="math inline">\(R_t\)</span> is the residual (or random) component.</li>
</ul>
<p><strong>Trend</strong> is a smoothly changing component of a time series.</p>
<p><strong>Seasonality</strong> is a strong periodic component with stable intensity.</p>
<p>The <strong>multiplicative</strong> decomposition of a time series is represented as:</p>
<p><span class="math display">\[Y_t = T_t \times S_t \times R_t\]</span></p>
<p>where:<br />
- <span class="math inline">\(Y_t\)</span> is the observed value at time <span class="math inline">\(t\)</span>,<br />
- <span class="math inline">\(T_t\)</span> is the trend component,<br />
- <span class="math inline">\(S_t\)</span> is the seasonal component,<br />
- <span class="math inline">\(R_t\)</span> is the residual (or random) component.</p>
<p>Transform additive to multiplicative:</p>
<p><span class="math display">\[ln(Y_t) = ln(T_t \times S_t \times R_t) = ln(T_t) + ln(S_t) + ln(R_t)\]</span> ### Example: Employment in the US retail sector</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="time-series-decomposition.html#cb247-1" tabindex="-1"></a>us_retail_employment <span class="ot">&lt;-</span> us_employment <span class="sc">|&gt;</span></span>
<span id="cb247-2"><a href="time-series-decomposition.html#cb247-2" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">year</span>(Month) <span class="sc">&gt;=</span> <span class="dv">1990</span>, Title <span class="sc">==</span> <span class="st">&#39;Retail Trade&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb247-3"><a href="time-series-decomposition.html#cb247-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Series_ID) </span>
<span id="cb247-4"><a href="time-series-decomposition.html#cb247-4" tabindex="-1"></a></span>
<span id="cb247-5"><a href="time-series-decomposition.html#cb247-5" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb247-6"><a href="time-series-decomposition.html#cb247-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed) <span class="sc">+</span></span>
<span id="cb247-7"><a href="time-series-decomposition.html#cb247-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total employment in US retail&#39;</span>,</span>
<span id="cb247-8"><a href="time-series-decomposition.html#cb247-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Persons, K&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-7-1.png" width="672" /></p>
<p>STL decomposition.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="time-series-decomposition.html#cb248-1" tabindex="-1"></a>dcmp <span class="ot">&lt;-</span> us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb248-2"><a href="time-series-decomposition.html#cb248-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Employed))</span>
<span id="cb248-3"><a href="time-series-decomposition.html#cb248-3" tabindex="-1"></a></span>
<span id="cb248-4"><a href="time-series-decomposition.html#cb248-4" tabindex="-1"></a>dcmp <span class="sc">|&gt;</span> <span class="fu">components</span>()</span></code></pre></div>
<pre><code>## # A dable: 357 x 7 [1M]
## # Key:     .model [1]
## # :        Employed = trend + season_year + remainder
##    .model    Month Employed  trend season_year remainder season_adjust
##    &lt;chr&gt;     &lt;mth&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
##  1 stl    1990 Jan   13256. 13288.      -33.0      0.836        13289.
##  2 stl    1990 Feb   12966. 13269.     -258.     -44.6          13224.
##  3 stl    1990 Mar   12938. 13250.     -290.     -22.1          13228.
##  4 stl    1990 Apr   13012. 13231.     -220.       1.05         13232.
##  5 stl    1990 May   13108. 13211.     -114.      11.3          13223.
##  6 stl    1990 Jun   13183. 13192.      -24.3     15.5          13207.
##  7 stl    1990 Jul   13170. 13172.      -23.2     21.6          13193.
##  8 stl    1990 Aug   13160. 13151.       -9.52    17.8          13169.
##  9 stl    1990 Sep   13113. 13131.      -39.5     22.0          13153.
## 10 stl    1990 Oct   13185. 13110.       61.6     13.2          13124.
## # ℹ 347 more rows</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="time-series-decomposition.html#cb250-1" tabindex="-1"></a>dcmp <span class="sc">|&gt;</span> </span>
<span id="cb250-2"><a href="time-series-decomposition.html#cb250-2" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb250-3"><a href="time-series-decomposition.html#cb250-3" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb250-4"><a href="time-series-decomposition.html#cb250-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb250-5"><a href="time-series-decomposition.html#cb250-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>trend), <span class="at">color =</span> <span class="st">&#39;orange&#39;</span>) <span class="sc">+</span></span>
<span id="cb250-6"><a href="time-series-decomposition.html#cb250-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Persons, K&#39;</span>,</span>
<span id="cb250-7"><a href="time-series-decomposition.html#cb250-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Total employment in US retail&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="time-series-decomposition.html#cb251-1" tabindex="-1"></a>dcmp <span class="sc">|&gt;</span> </span>
<span id="cb251-2"><a href="time-series-decomposition.html#cb251-2" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb251-3"><a href="time-series-decomposition.html#cb251-3" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-10-1.png" width="672" /></p>
<blockquote>
<p>Notice that the seasonal component changes over time, so that any two consecutive years have similar patterns, but years far apart may have different seasonal patterns.</p>
</blockquote>
<div id="seasonally-adjusted-data" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Seasonally adjusted data<a href="time-series-decomposition.html#seasonally-adjusted-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>If the seasonal component is removed from the original data, the resulting values are the “seasonally adjusted” data. For an additive decomposition, the seasonally adjusted data are given by <span class="math inline">\(y_t − S_t\)</span>, and for multiplicative data, the seasonally adjusted values are obtained using <span class="math inline">\(y_t/S_t\)</span>.</p>
</blockquote>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="time-series-decomposition.html#cb252-1" tabindex="-1"></a>dcmp <span class="sc">|&gt;</span></span>
<span id="cb252-2"><a href="time-series-decomposition.html#cb252-2" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb252-3"><a href="time-series-decomposition.html#cb252-3" tabindex="-1"></a>  <span class="fu">as_tsibble</span>() <span class="sc">|&gt;</span> <span class="co"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;!!!!!!!!!!!</span></span>
<span id="cb252-4"><a href="time-series-decomposition.html#cb252-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb252-5"><a href="time-series-decomposition.html#cb252-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>season_adjust), <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb252-6"><a href="time-series-decomposition.html#cb252-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Persons, K&#39;</span>,</span>
<span id="cb252-7"><a href="time-series-decomposition.html#cb252-7" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Total employment in US retail&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-11-1.png" width="672" /></p>
<blockquote>
<p>If the purpose is to look for turning points in a series, and interpret any changes in direction, then it is better to use the trend-cycle component rather than the seasonally adjusted data.</p>
</blockquote>
</div>
</div>
<div id="moving-averages" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Moving averages<a href="time-series-decomposition.html#moving-averages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/moving-averages.html">The source of the section</a></p>
<div id="moving-average-smoothing" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Moving average smoothing<a href="time-series-decomposition.html#moving-average-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(m\)</span>-MA, or a moving average of order m:</p>
<p><span class="math display">\[
\hat{T_t} = \frac {1} {m} \sum_{j=-k}^k y_{t+j}, \text{where} \space m = 2k + 1
\]</span></p>
<p>Moving average removes seasonal fluctuations and allows to estimate trend-cycle.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="time-series-decomposition.html#cb253-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb253-2"><a href="time-series-decomposition.html#cb253-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;AUS&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb253-3"><a href="time-series-decomposition.html#cb253-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Exports) <span class="sc">+</span></span>
<span id="cb253-4"><a href="time-series-decomposition.html#cb253-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total Australian exports&#39;</span>, <span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-12-1.png" width="672" /></p>
<p>Computing 5-MA.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="time-series-decomposition.html#cb254-1" tabindex="-1"></a><span class="co"># m = 5 =&gt; (5 - 1)/2 = 2 = k</span></span>
<span id="cb254-2"><a href="time-series-decomposition.html#cb254-2" tabindex="-1"></a></span>
<span id="cb254-3"><a href="time-series-decomposition.html#cb254-3" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb254-4"><a href="time-series-decomposition.html#cb254-4" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;AUS&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb254-5"><a href="time-series-decomposition.html#cb254-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">2</span>, <span class="at">.after =</span> <span class="dv">2</span>, </span>
<span id="cb254-6"><a href="time-series-decomposition.html#cb254-6" tabindex="-1"></a>                                    <span class="at">.complete =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb254-7"><a href="time-series-decomposition.html#cb254-7" tabindex="-1"></a>  <span class="fu">select</span>(Exports, <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>## # A tsibble: 58 x 3 [1Y]
##    Exports `5-MA`  Year
##      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1    13.0   NA    1960
##  2    12.4   NA    1961
##  3    13.9   13.5  1962
##  4    13.0   13.5  1963
##  5    14.9   13.6  1964
##  6    13.2   13.4  1965
##  7    12.9   13.3  1966
##  8    12.9   12.7  1967
##  9    12.3   12.6  1968
## 10    12.0   12.6  1969
## # ℹ 48 more rows</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="time-series-decomposition.html#cb256-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb256-2"><a href="time-series-decomposition.html#cb256-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;AUS&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb256-3"><a href="time-series-decomposition.html#cb256-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">2</span>, <span class="at">.after =</span> <span class="dv">2</span>, </span>
<span id="cb256-4"><a href="time-series-decomposition.html#cb256-4" tabindex="-1"></a>                                    <span class="at">.complete =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb256-5"><a href="time-series-decomposition.html#cb256-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Exports) <span class="sc">+</span></span>
<span id="cb256-6"><a href="time-series-decomposition.html#cb256-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb256-7"><a href="time-series-decomposition.html#cb256-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total Australian exports&#39;</span>, <span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-14-1.png" width="672" /></p>
<p>The order of the moving average determines the smoothness of the trend-cycle extimate.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="time-series-decomposition.html#cb258-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb258-2"><a href="time-series-decomposition.html#cb258-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;AUS&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb258-3"><a href="time-series-decomposition.html#cb258-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">3-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.after =</span> <span class="dv">1</span>, </span>
<span id="cb258-4"><a href="time-series-decomposition.html#cb258-4" tabindex="-1"></a>                                    <span class="at">.complete =</span> T),</span>
<span id="cb258-5"><a href="time-series-decomposition.html#cb258-5" tabindex="-1"></a>         <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">2</span>, <span class="at">.after =</span> <span class="dv">2</span>, </span>
<span id="cb258-6"><a href="time-series-decomposition.html#cb258-6" tabindex="-1"></a>                                    <span class="at">.complete =</span> T),</span>
<span id="cb258-7"><a href="time-series-decomposition.html#cb258-7" tabindex="-1"></a>         <span class="st">`</span><span class="at">7-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">3</span>, <span class="at">.after =</span> <span class="dv">3</span>, </span>
<span id="cb258-8"><a href="time-series-decomposition.html#cb258-8" tabindex="-1"></a>                                    <span class="at">.complete =</span> T),</span>
<span id="cb258-9"><a href="time-series-decomposition.html#cb258-9" tabindex="-1"></a>         <span class="st">`</span><span class="at">9-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">4</span>, <span class="at">.after =</span> <span class="dv">4</span>, </span>
<span id="cb258-10"><a href="time-series-decomposition.html#cb258-10" tabindex="-1"></a>                                    <span class="at">.complete =</span> T),</span>
<span id="cb258-11"><a href="time-series-decomposition.html#cb258-11" tabindex="-1"></a>         <span class="st">`</span><span class="at">11-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">5</span>, <span class="at">.after =</span> <span class="dv">5</span>, </span>
<span id="cb258-12"><a href="time-series-decomposition.html#cb258-12" tabindex="-1"></a>                                    <span class="at">.complete =</span> T),</span>
<span id="cb258-13"><a href="time-series-decomposition.html#cb258-13" tabindex="-1"></a>         <span class="st">`</span><span class="at">13-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Exports, mean, <span class="at">.before =</span> <span class="dv">6</span>, <span class="at">.after =</span> <span class="dv">6</span>, </span>
<span id="cb258-14"><a href="time-series-decomposition.html#cb258-14" tabindex="-1"></a>                                    <span class="at">.complete =</span> T)) <span class="sc">|&gt;</span></span>
<span id="cb258-15"><a href="time-series-decomposition.html#cb258-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">`</span><span class="at">3-MA</span><span class="st">`</span>, <span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>, <span class="st">`</span><span class="at">7-MA</span><span class="st">`</span>, <span class="st">`</span><span class="at">9-MA</span><span class="st">`</span>, <span class="st">`</span><span class="at">11-MA</span><span class="st">`</span>, <span class="st">`</span><span class="at">13-MA</span><span class="st">`</span>),</span>
<span id="cb258-16"><a href="time-series-decomposition.html#cb258-16" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;ma_value&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb258-17"><a href="time-series-decomposition.html#cb258-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&#39;3-MA&#39;</span>, <span class="st">&#39;5-MA&#39;</span>, <span class="st">&#39;7-MA&#39;</span>, </span>
<span id="cb258-18"><a href="time-series-decomposition.html#cb258-18" tabindex="-1"></a>                                      <span class="st">&#39;9-MA&#39;</span>, <span class="st">&#39;11-MA&#39;</span>, <span class="st">&#39;13-MA&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb258-19"><a href="time-series-decomposition.html#cb258-19" tabindex="-1"></a>  <span class="fu">autoplot</span>(Exports, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb258-20"><a href="time-series-decomposition.html#cb258-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ma_value), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb258-21"><a href="time-series-decomposition.html#cb258-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Total Australian exports&#39;</span>, <span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>) <span class="sc">+</span></span>
<span id="cb258-22"><a href="time-series-decomposition.html#cb258-22" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(name <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb258-23"><a href="time-series-decomposition.html#cb258-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-15-1.png" width="672" /></p>
<blockquote>
<p>This is so they are symmetric: in a moving average of order <span class="math inline">\(m = 2k + 1\)</span>, the middle observation, and <span class="math inline">\(k\)</span> observations on either side, are averaged. But if <span class="math inline">\(m\)</span> was even, it would no longer be symmetric.</p>
</blockquote>
</div>
<div id="moving-averages-of-moving-averages" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Moving averages of moving averages<a href="time-series-decomposition.html#moving-averages-of-moving-averages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To make an even-order moving average symmetric, apply a moving average to moving average.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="time-series-decomposition.html#cb259-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb259-2"><a href="time-series-decomposition.html#cb259-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">|&gt;</span></span>
<span id="cb259-3"><a href="time-series-decomposition.html#cb259-3" tabindex="-1"></a>  <span class="fu">select</span>(Quarter, Beer) <span class="sc">|&gt;</span></span>
<span id="cb259-4"><a href="time-series-decomposition.html#cb259-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">4-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Beer, mean, <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.after =</span> <span class="dv">2</span>,  </span>
<span id="cb259-5"><a href="time-series-decomposition.html#cb259-5" tabindex="-1"></a>                                     <span class="at">.complete =</span> <span class="cn">TRUE</span>),</span>
<span id="cb259-6"><a href="time-series-decomposition.html#cb259-6" tabindex="-1"></a>         <span class="st">`</span><span class="at">2x4-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(<span class="st">`</span><span class="at">4-MA</span><span class="st">`</span>, mean, <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.after =</span> <span class="dv">0</span>,  </span>
<span id="cb259-7"><a href="time-series-decomposition.html#cb259-7" tabindex="-1"></a>                                     <span class="at">.complete =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tsibble: 74 x 4 [1Q]
##    Quarter  Beer `4-MA` `2x4-MA`
##      &lt;qtr&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1 1992 Q1   443    NA       NA 
##  2 1992 Q2   410   451.      NA 
##  3 1992 Q3   420   449.     450 
##  4 1992 Q4   532   452.     450.
##  5 1993 Q1   433   449      450.
##  6 1993 Q2   421   444      446.
##  7 1993 Q3   410   448      446 
##  8 1993 Q4   512   438      443 
##  9 1994 Q1   449   441.     440.
## 10 1994 Q2   381   446      444.
## # ℹ 64 more rows</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="time-series-decomposition.html#cb261-1" tabindex="-1"></a><span class="fu">ma</span>((aus_production <span class="sc">|&gt;</span></span>
<span id="cb261-2"><a href="time-series-decomposition.html#cb261-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">|&gt;</span></span>
<span id="cb261-3"><a href="time-series-decomposition.html#cb261-3" tabindex="-1"></a>  <span class="fu">select</span>(Quarter, Beer))<span class="sc">$</span>Beer, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Time Series:
## Start = 1 
## End = 74 
## Frequency = 1 
##  [1]      NA      NA 450.000 450.125 450.250 446.500 446.000 443.000 439.625 443.625 443.125 443.625 446.125 443.875 440.375 437.000 433.500 429.625 430.875 433.750
## [21] 434.750 438.125 440.000 439.375 438.875 437.375 437.125 436.250 437.125 440.250 439.000 439.625 440.750 436.875 438.000 439.000 436.500 435.750 431.875 432.500
## [41] 434.750 435.250 437.875 435.250 433.625 433.500 431.500 432.750 432.875 427.250 420.375 419.625 420.750 423.750 430.000 430.625 428.125 428.875 428.625 426.875
## [61] 425.125 421.500 418.375 418.375 421.250 425.125 426.375 426.750 428.875 430.000 429.875 426.750      NA      NA</code></pre>
<p><span class="math inline">\(2 \times m\)</span>-MA:</p>
<p><span class="math display">\[
\hat{T_t} = \frac {1} {2} \left[ \frac {1} {m} \sum_{j=-k}^k y_{t+j} \right], \text{where} \space m = 2k
\]</span></p>
<blockquote>
<p>In general, an even order MA should be followed by an even order MA to make it symmetric. Similarly, an odd order MA should be followed by an odd order MA.</p>
</blockquote>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="time-series-decomposition.html#cb263-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb263-2"><a href="time-series-decomposition.html#cb263-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Quarter) <span class="sc">&gt;=</span> <span class="dv">1992</span>) <span class="sc">|&gt;</span></span>
<span id="cb263-3"><a href="time-series-decomposition.html#cb263-3" tabindex="-1"></a>  <span class="fu">select</span>(Quarter, Beer) <span class="sc">|&gt;</span></span>
<span id="cb263-4"><a href="time-series-decomposition.html#cb263-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">3-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Beer, mean, <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.after =</span> <span class="dv">1</span>,  </span>
<span id="cb263-5"><a href="time-series-decomposition.html#cb263-5" tabindex="-1"></a>                                     <span class="at">.complete =</span> <span class="cn">TRUE</span>),</span>
<span id="cb263-6"><a href="time-series-decomposition.html#cb263-6" tabindex="-1"></a>         <span class="st">`</span><span class="at">3x3-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(<span class="st">`</span><span class="at">3-MA</span><span class="st">`</span>, mean, <span class="at">.before =</span> <span class="dv">1</span>, <span class="at">.after =</span> <span class="dv">1</span>,  </span>
<span id="cb263-7"><a href="time-series-decomposition.html#cb263-7" tabindex="-1"></a>                                     <span class="at">.complete =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tsibble: 74 x 4 [1Q]
##    Quarter  Beer `3-MA` `3x3-MA`
##      &lt;qtr&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1 1992 Q1   443    NA       NA 
##  2 1992 Q2   410   424.      NA 
##  3 1992 Q3   420   454      447.
##  4 1992 Q4   532   462.     459.
##  5 1993 Q1   433   462      448.
##  6 1993 Q2   421   421.     444.
##  7 1993 Q3   410   448.     442 
##  8 1993 Q4   512   457      451.
##  9 1994 Q1   449   447.     441.
## 10 1994 Q2   381   418.     437.
## # ℹ 64 more rows</code></pre>
</div>
<div id="estimating-the-trend-cycle-with-seasonal-data" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Estimating the trend-cycle with seasonal data<a href="time-series-decomposition.html#estimating-the-trend-cycle-with-seasonal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>If the seasonal period is even and of order <span class="math inline">\(m\)</span>, we use a <span class="math inline">\(2 \times m\)</span>-MA to estimate the trend-cycle. If the seasonal period is odd and of order <span class="math inline">\(m\)</span>, we use a <span class="math inline">\(m\)</span>-MA to estimate the trend-cycle. For example, a 2×12-MA can be used to estimate the trend-cycle of monthly data with annual seasonality and a 7-MA can be used to estimate the trend-cycle of daily data with a weekly seasonality.</p>
</blockquote>
</div>
<div id="example-employment-in-the-us-retail-sector" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Example: Employment in the US retail sector<a href="time-series-decomposition.html#example-employment-in-the-us-retail-sector" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="time-series-decomposition.html#cb265-1" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb265-2"><a href="time-series-decomposition.html#cb265-2" tabindex="-1"></a>  <span class="fu">gg_season</span>(Employed)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-19-1.png" width="672" /></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="time-series-decomposition.html#cb266-1" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb266-2"><a href="time-series-decomposition.html#cb266-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">12-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(Employed, mean, <span class="at">.before=</span><span class="dv">5</span>,</span>
<span id="cb266-3"><a href="time-series-decomposition.html#cb266-3" tabindex="-1"></a>                                     <span class="at">.after =</span> <span class="dv">6</span>, <span class="at">.complete =</span> <span class="cn">TRUE</span>),</span>
<span id="cb266-4"><a href="time-series-decomposition.html#cb266-4" tabindex="-1"></a>         <span class="st">`</span><span class="at">2x12-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(<span class="st">`</span><span class="at">12-MA</span><span class="st">`</span>, mean, <span class="at">.before=</span><span class="dv">1</span>,</span>
<span id="cb266-5"><a href="time-series-decomposition.html#cb266-5" tabindex="-1"></a>                                     <span class="at">.after =</span> <span class="dv">0</span>, <span class="at">.complete =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb266-6"><a href="time-series-decomposition.html#cb266-6" tabindex="-1"></a><span class="fu">autoplot</span>(Employed, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb266-7"><a href="time-series-decomposition.html#cb266-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">2x12-MA</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb266-8"><a href="time-series-decomposition.html#cb266-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Persons (thousands)&quot;</span>,</span>
<span id="cb266-9"><a href="time-series-decomposition.html#cb266-9" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Total employment in US retail&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-19-2.png" width="672" /></p>
</div>
<div id="weighted-moving-averages" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Weighted moving averages<a href="time-series-decomposition.html#weighted-moving-averages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\hat{T_t} = \sum_{j=-k}^k a_j y_{t+j}, \text{where} \space k = (m - 1)/2
\]</span></p>
<p>and the weights are given by <span class="math inline">\([a_{−k}, ...,a_k]\)</span>. It is important that the weights all sum to one and that they are symmetric so that <span class="math inline">\(a_j = a_{−j}\)</span>. The simple <span class="math inline">\(m\)</span>-MA is a special case where all of the weights are equal to <span class="math inline">\(1/m\)</span>.</p>
<blockquote>
<p>A major advantage of weighted moving averages is that they yield a smoother estimate of the trend-cycle.</p>
</blockquote>
</div>
</div>
<div id="classical-decomposition" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Classical decomposition<a href="time-series-decomposition.html#classical-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/classical-decomposition.html">The source of the section</a></p>
<p>Classical decomposition:</p>
<ul>
<li>Additive decomposition</li>
<li>Multiplicative decomposition</li>
</ul>
<div id="additive-decomposition" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Additive decomposition<a href="time-series-decomposition.html#additive-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Step 1</strong><br />
Compute <span class="math inline">\(\hat T_t\)</span> using:</p>
<ul>
<li><span class="math inline">\(2 \times m\)</span>-MA, if <span class="math inline">\(m\)</span> is an even number</li>
<li><span class="math inline">\(m\)</span>-MA, if <span class="math inline">\(m\)</span> is an odd number</li>
</ul></li>
<li><p><strong>Step 2</strong><br />
Calculate the detrended series: <span class="math inline">\(y_t - \hat T_t\)</span></p></li>
<li><p><strong>Step 3</strong><br />
To estimate the seasonal component <span class="math inline">\(\hat S_t\)</span> for each season, simply average the detrended values for that season.</p></li>
<li><p><strong>Step 4</strong><br />
<span class="math display">\[
\hat R_t = y_t - \hat T_t - \hat S_t
\]</span></p></li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="time-series-decomposition.html#cb267-1" tabindex="-1"></a><span class="co"># classical decomposition</span></span>
<span id="cb267-2"><a href="time-series-decomposition.html#cb267-2" tabindex="-1"></a></span>
<span id="cb267-3"><a href="time-series-decomposition.html#cb267-3" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb267-4"><a href="time-series-decomposition.html#cb267-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">classical_decomposition</span>(Employed, <span class="at">type=</span><span class="st">&#39;add&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb267-5"><a href="time-series-decomposition.html#cb267-5" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb267-6"><a href="time-series-decomposition.html#cb267-6" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb267-7"><a href="time-series-decomposition.html#cb267-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Classical additive decomposition of total</span></span>
<span id="cb267-8"><a href="time-series-decomposition.html#cb267-8" tabindex="-1"></a><span class="st">                  US retail employment&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-20-1.png" width="672" /></p>
</div>
<div id="multiplicative-decomposition" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Multiplicative decomposition<a href="time-series-decomposition.html#multiplicative-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Step 1</strong><br />
Compute <span class="math inline">\(\hat T_t\)</span> using:</p>
<ul>
<li><span class="math inline">\(2 \times m\)</span>-MA, if <span class="math inline">\(m\)</span> is an even number</li>
<li><span class="math inline">\(m\)</span>-MA, if <span class="math inline">\(m\)</span> is an odd number</li>
</ul></li>
<li><p><strong>Step 2</strong><br />
Calculate the detrended series: <span class="math inline">\(y_t / \hat T_t\)</span></p></li>
<li><p><strong>Step 3</strong><br />
To estimate the seasonal component <span class="math inline">\(\hat S_t\)</span> for each season, simply average the detrended values for that season.</p></li>
<li><p><strong>Step 4</strong><br />
<span class="math display">\[
\hat R_t = y_t /( \hat T_t \hat S_t)
\]</span> ## STL decomposition</p></li>
</ul>
<p><a href="https://otexts.com/fpp3/stl.html">The source of the section</a></p>
<blockquote>
<p>STL decomposition only provides facilities for additive decompositions. A multiplicative decomposition can be obtained by first taking logs of the data, then back-transforming the components. Decompositions that are between additive and multiplicative can be obtained using a Box-Cox transformation of the data with <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span>. A value of $= 0 $ gives a <strong>multiplicative decomposition</strong> while <span class="math inline">\(\lambda = 1\)</span> gives an <strong>additive decomposition</strong>.</p>
</blockquote>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="time-series-decomposition.html#cb269-1" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb269-2"><a href="time-series-decomposition.html#cb269-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Employed <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb269-3"><a href="time-series-decomposition.html#cb269-3" tabindex="-1"></a>                    <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&#39;periodic&#39;</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb269-4"><a href="time-series-decomposition.html#cb269-4" tabindex="-1"></a>  <span class="fu">components</span>()</span></code></pre></div>
<pre><code>## # A dable: 357 x 7 [1M]
## # Key:     .model [1]
## # :        Employed = trend + season_year + remainder
##    .model    Month Employed  trend season_year remainder season_adjust
##    &lt;chr&gt;     &lt;mth&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
##  1 stl    1990 Jan   13256. 13250.      -83.1      88.7         13339.
##  2 stl    1990 Feb   12966. 13234.     -279.       11.1         13245.
##  3 stl    1990 Mar   12938. 13220.     -266.      -15.4         13204.
##  4 stl    1990 Apr   13012. 13206.     -190.       -3.00        13203.
##  5 stl    1990 May   13108. 13197.      -91.0       2.48        13199.
##  6 stl    1990 Jun   13183. 13189.       -9.67      3.44        13192.
##  7 stl    1990 Jul   13170. 13181.       -8.50     -2.14        13179.
##  8 stl    1990 Aug   13160. 13172.       -6.51     -6.04        13166.
##  9 stl    1990 Sep   13113. 13158.      -86.0      41.3         13199.
## 10 stl    1990 Oct   13185. 13139.       43.7       2.88        13141.
## # ℹ 347 more rows</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="time-series-decomposition.html#cb271-1" tabindex="-1"></a>us_retail_employment <span class="sc">|&gt;</span></span>
<span id="cb271-2"><a href="time-series-decomposition.html#cb271-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Employed <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb271-3"><a href="time-series-decomposition.html#cb271-3" tabindex="-1"></a>                    <span class="fu">season</span>(<span class="at">window =</span> <span class="st">&#39;periodic&#39;</span>), <span class="at">robust =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb271-4"><a href="time-series-decomposition.html#cb271-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb271-5"><a href="time-series-decomposition.html#cb271-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-22-1.png" width="672" /></p>
<p>The main parameters:</p>
<ul>
<li><code>trend(window = ?)</code> controls how rapidly the trend-cycle components can change.</li>
<li><code>season(window = ?)</code> controls how rapidly the seasonal components can change.</li>
</ul>
<blockquote>
<p>Both trend and seasonal windows should be <strong>odd</strong> numbers. Setting the seasonal window to be infinite is equivalent to forcing the seasonal component to be periodic.</p>
</blockquote>
</div>
</div>
<div id="excercises-2" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Excercises<a href="time-series-decomposition.html#excercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="time-series-decomposition.html#cb272-1" tabindex="-1"></a><span class="co"># Plot the GDP per capita for each country over time.</span></span>
<span id="cb272-2"><a href="time-series-decomposition.html#cb272-2" tabindex="-1"></a><span class="cf">for</span>(country <span class="cf">in</span> (global_economy <span class="sc">|&gt;</span> <span class="fu">distinct</span>(Country))<span class="sc">$</span>Country){</span>
<span id="cb272-3"><a href="time-series-decomposition.html#cb272-3" tabindex="-1"></a>  gdp <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb272-4"><a href="time-series-decomposition.html#cb272-4" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> country) <span class="sc">|&gt;</span></span>
<span id="cb272-5"><a href="time-series-decomposition.html#cb272-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_per_capita =</span> GDP <span class="sc">/</span> Population) <span class="sc">|&gt;</span></span>
<span id="cb272-6"><a href="time-series-decomposition.html#cb272-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(GDP_per_capita) <span class="sc">+</span></span>
<span id="cb272-7"><a href="time-series-decomposition.html#cb272-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Country <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb272-8"><a href="time-series-decomposition.html#cb272-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;GDP per capita&#39;</span>, <span class="at">subtitle =</span> country, <span class="at">y =</span>  <span class="st">&#39; $USD per capita&#39;</span>) <span class="sc">+</span></span>
<span id="cb272-9"><a href="time-series-decomposition.html#cb272-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb272-10"><a href="time-series-decomposition.html#cb272-10" tabindex="-1"></a>  <span class="fu">print</span>(gdp)</span>
<span id="cb272-11"><a href="time-series-decomposition.html#cb272-11" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-23-1.png" width="672" /></p>
<pre><code>## Warning: Removed 24 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-2.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-3.png" width="672" /></p>
<pre><code>## Warning: Removed 42 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-4.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-5.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-6.png" width="672" /></p>
<pre><code>## Warning: Removed 17 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-7.png" width="672" /></p>
<pre><code>## Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-8.png" width="672" /></p>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-9.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-10.png" width="672" /></p>
<pre><code>## Warning: Removed 26 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-11.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-12.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-13.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-14.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-15.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-16.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-17.png" width="672" /></p>
<pre><code>## Warning: Removed 14 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-18.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-19.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-20.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-21.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-22.png" width="672" /></p>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-23.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-24.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-25.png" width="672" /></p>
<pre><code>## Warning: Removed 34 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-26.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-27.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-28.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-29.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-30.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-31.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-32.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-33.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-34.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-35.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-36.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-37.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-38.png" width="672" /></p>
<pre><code>## Warning: Removed 56 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-39.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-40.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-41.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-42.png" width="672" /></p>
<pre><code>## Warning: Removed 48 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-43.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-44.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-45.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-46.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-47.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-48.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-49.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-50.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-51.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-52.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-53.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-54.png" width="672" /></p>
<pre><code>## Warning: Removed 15 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-55.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-56.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-57.png" width="672" /></p>
<pre><code>## Warning: Removed 25 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-58.png" width="672" /></p>
<pre><code>## Warning: Removed 17 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-59.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-60.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-61.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-62.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-63.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-64.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-65.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-66.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-67.png" width="672" /></p>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-68.png" width="672" /></p>
<pre><code>## Warning: Removed 32 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-69.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-70.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-71.png" width="672" /></p>
<pre><code>## Warning: Removed 21 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-72.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-73.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-74.png" width="672" /></p>
<pre><code>## Warning: Removed 29 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-75.png" width="672" /></p>
<pre><code>## Warning: Removed 29 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-76.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-77.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-78.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-79.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-80.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-81.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-82.png" width="672" /></p>
<pre><code>## Warning: Removed 22 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-83.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-84.png" width="672" /></p>
<pre><code>## Warning: Removed 6 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-85.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-86.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-87.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-88.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-89.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-90.png" width="672" /></p>
<pre><code>## Warning: Removed 11 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-91.png" width="672" /></p>
<pre><code>## Warning: Removed 17 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-92.png" width="672" /></p>
<pre><code>## Warning: Removed 42 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-93.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-94.png" width="672" /></p>
<pre><code>## Warning: Removed 26 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-95.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-96.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-97.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-98.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-99.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-100.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-101.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-102.png" width="672" /></p>
<pre><code>## Warning: Removed 31 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-103.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-104.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-105.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-106.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-107.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-108.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-109.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-110.png" width="672" /></p>
<pre><code>## Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-111.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-112.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-113.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-114.png" width="672" /></p>
<pre><code>## Warning: Removed 36 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-115.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-116.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-117.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-118.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-119.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-120.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-121.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-122.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-123.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-124.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-125.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-126.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-127.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-128.png" width="672" /></p>
<pre><code>## Warning: Removed 24 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-129.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-130.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-131.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-132.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-133.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-134.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-135.png" width="672" /></p>
<pre><code>## Warning: Removed 28 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-136.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-137.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-138.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-139.png" width="672" /></p>
<pre><code>## Warning: Removed 11 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-140.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-141.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-142.png" width="672" /></p>
<pre><code>## Warning: Removed 21 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-143.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-144.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-145.png" width="672" /></p>
<pre><code>## Warning: Removed 22 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-146.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-147.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-148.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-149.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-150.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-151.png" width="672" /></p>
<pre><code>## Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-152.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-153.png" width="672" /></p>
<pre><code>## Warning: Removed 21 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-154.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-155.png" width="672" /></p>
<pre><code>## Warning: Removed 16 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-156.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-157.png" width="672" /></p>
<pre><code>## Warning: Removed 23 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-158.png" width="672" /></p>
<pre><code>## Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-159.png" width="672" /></p>
<pre><code>## Warning: Removed 33 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-160.png" width="672" /></p>
<pre><code>## Warning: Removed 33 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-161.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-162.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-163.png" width="672" /></p>
<pre><code>## Warning: Removed 11 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-164.png" width="672" /></p>
<pre><code>## Warning: Removed 21 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-165.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-166.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-167.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-168.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-169.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-170.png" width="672" /></p>
<pre><code>## Warning: Removed 47 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-171.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-172.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-173.png" width="672" /></p>
<pre><code>## Warning: Removed 22 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-174.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-175.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-176.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-177.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-178.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-179.png" width="672" /></p>
<pre><code>## Warning: Removed 42 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-180.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-181.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-182.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-183.png" width="672" /></p>
<pre><code>## Warning: Removed 15 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-184.png" width="672" /></p>
<pre><code>## Warning: Removed 15 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-185.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-186.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-187.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-188.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-189.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-190.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-191.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-192.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-193.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-194.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-195.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-196.png" width="672" /></p>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-197.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-198.png" width="672" /></p>
<pre><code>## Warning: Removed 27 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-199.png" width="672" /></p>
<pre><code>## Warning: Removed 29 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-200.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-201.png" width="672" /></p>
<pre><code>## Warning: Removed 22 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-202.png" width="672" /></p>
<pre><code>## Warning: Removed 39 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-203.png" width="672" /></p>
<pre><code>## Warning: Removed 41 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-204.png" width="672" /></p>
<pre><code>## Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-205.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-206.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-207.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-208.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-209.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-210.png" width="672" /></p>
<pre><code>## Warning: Removed 20 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-211.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-212.png" width="672" /></p>
<pre><code>## Warning: Removed 35 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-213.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-214.png" width="672" /></p>
<pre><code>## Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-215.png" width="672" /></p>
<pre><code>## Warning: Removed 53 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-216.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-217.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-218.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-219.png" width="672" /></p>
<pre><code>## Warning: Removed 52 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-220.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-221.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-222.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-223.png" width="672" /></p>
<pre><code>## Warning: Removed 17 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-224.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-225.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-226.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-227.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-228.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-229.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-230.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-231.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-232.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-233.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-234.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-235.png" width="672" /></p>
<pre><code>## Warning: Removed 28 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-236.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-237.png" width="672" /></p>
<pre><code>## Warning: Removed 40 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-238.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-239.png" width="672" /></p>
<pre><code>## Warning: Removed 15 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-240.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-241.png" width="672" /></p>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-242.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-243.png" width="672" /></p>
<pre><code>## Warning: Removed 27 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-244.png" width="672" /></p>
<pre><code>## Warning: Removed 58 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-245.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-246.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-247.png" width="672" /></p>
<pre><code>## Warning: Removed 27 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-248.png" width="672" /></p>
<pre><code>## Warning: Removed 15 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-249.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-250.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-251.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-252.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-253.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-254.png" width="672" /></p>
<pre><code>## Warning: Removed 19 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-255.png" width="672" /></p>
<pre><code>## Warning: Removed 3 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-256.png" width="672" /></p>
<pre><code>## Warning: Removed 25 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-257.png" width="672" /></p>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-258.png" width="672" /></p>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-259.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-260.png" width="672" /></p>
<pre><code>## Warning: Removed 30 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-23-261.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-262.png" width="672" /><img src="figure_html/ch03-ts-decomposition-23-263.png" width="672" /></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="time-series-decomposition.html#cb407-1" tabindex="-1"></a><span class="co">#Which country has the highest GDP per capita?</span></span>
<span id="cb407-2"><a href="time-series-decomposition.html#cb407-2" tabindex="-1"></a></span>
<span id="cb407-3"><a href="time-series-decomposition.html#cb407-3" tabindex="-1"></a>highest_countries <span class="ot">&lt;-</span> (global_economy <span class="sc">|&gt;</span></span>
<span id="cb407-4"><a href="time-series-decomposition.html#cb407-4" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">GDP_per_capita =</span> GDP <span class="sc">/</span> Population) <span class="sc">|&gt;</span></span>
<span id="cb407-5"><a href="time-series-decomposition.html#cb407-5" tabindex="-1"></a>                  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(global_economy<span class="sc">$</span>Year)) <span class="sc">|&gt;</span></span>
<span id="cb407-6"><a href="time-series-decomposition.html#cb407-6" tabindex="-1"></a>                  <span class="fu">arrange</span>(<span class="fu">desc</span>(GDP_per_capita)) <span class="sc">|&gt;</span></span>
<span id="cb407-7"><a href="time-series-decomposition.html#cb407-7" tabindex="-1"></a>                  <span class="fu">select</span>(Country, GDP_per_capita) <span class="sc">|&gt;</span></span>
<span id="cb407-8"><a href="time-series-decomposition.html#cb407-8" tabindex="-1"></a>                  <span class="fu">head</span>(<span class="dv">10</span>))<span class="sc">$</span>Country</span>
<span id="cb407-9"><a href="time-series-decomposition.html#cb407-9" tabindex="-1"></a></span>
<span id="cb407-10"><a href="time-series-decomposition.html#cb407-10" tabindex="-1"></a><span class="cf">for</span>(country <span class="cf">in</span> highest_countries){</span>
<span id="cb407-11"><a href="time-series-decomposition.html#cb407-11" tabindex="-1"></a>  gdp <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb407-12"><a href="time-series-decomposition.html#cb407-12" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> country) <span class="sc">|&gt;</span></span>
<span id="cb407-13"><a href="time-series-decomposition.html#cb407-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_per_capita =</span> GDP <span class="sc">/</span> Population) <span class="sc">|&gt;</span></span>
<span id="cb407-14"><a href="time-series-decomposition.html#cb407-14" tabindex="-1"></a>  <span class="fu">autoplot</span>(GDP_per_capita) <span class="sc">+</span></span>
<span id="cb407-15"><a href="time-series-decomposition.html#cb407-15" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Country <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb407-16"><a href="time-series-decomposition.html#cb407-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;GDP per capita&#39;</span>, <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&#39;#&#39;</span>, <span class="fu">which</span>(highest_countries <span class="sc">==</span> country, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>), country), <span class="at">y =</span>  <span class="st">&#39; $USD per capita&#39;</span>) <span class="sc">+</span></span>
<span id="cb407-17"><a href="time-series-decomposition.html#cb407-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb407-18"><a href="time-series-decomposition.html#cb407-18" tabindex="-1"></a>  <span class="fu">print</span>(gdp)</span>
<span id="cb407-19"><a href="time-series-decomposition.html#cb407-19" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-24-1.png" width="672" /></p>
<pre><code>## Warning: Removed 22 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-24-2.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-3.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-4.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-5.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-6.png" width="672" /></p>
<pre><code>## Warning: Removed 10 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-24-7.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-8.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-9.png" width="672" /><img src="figure_html/ch03-ts-decomposition-24-10.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="time-series-decomposition.html#cb410-1" tabindex="-1"></a><span class="co"># United States GDP from global_economy.</span></span>
<span id="cb410-2"><a href="time-series-decomposition.html#cb410-2" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb410-3"><a href="time-series-decomposition.html#cb410-3" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&#39;United States&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb410-4"><a href="time-series-decomposition.html#cb410-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(GDP) <span class="sc">+</span></span>
<span id="cb410-5"><a href="time-series-decomposition.html#cb410-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;GDP of United States&#39;</span>, <span class="at">y =</span> <span class="st">&#39;$US&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="time-series-decomposition.html#cb411-1" tabindex="-1"></a><span class="co"># =&gt; transformation does not needed</span></span></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="time-series-decomposition.html#cb412-1" tabindex="-1"></a><span class="co"># Slaughter of Victorian “Bulls, bullocks and steers” in aus_livestock.</span></span>
<span id="cb412-2"><a href="time-series-decomposition.html#cb412-2" tabindex="-1"></a></span>
<span id="cb412-3"><a href="time-series-decomposition.html#cb412-3" tabindex="-1"></a>aus_livestock <span class="sc">|&gt;</span></span>
<span id="cb412-4"><a href="time-series-decomposition.html#cb412-4" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&#39;Victoria&#39;</span>, Animal <span class="sc">==</span> <span class="st">&#39;Bulls, bullocks and steers&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb412-5"><a href="time-series-decomposition.html#cb412-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Count) <span class="sc">+</span></span>
<span id="cb412-6"><a href="time-series-decomposition.html#cb412-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Slaughter of Bulls, bullocks and steers&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Victoria&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="time-series-decomposition.html#cb413-1" tabindex="-1"></a><span class="co"># =&gt; Apply transformation to make variance constant</span></span>
<span id="cb413-2"><a href="time-series-decomposition.html#cb413-2" tabindex="-1"></a></span>
<span id="cb413-3"><a href="time-series-decomposition.html#cb413-3" tabindex="-1"></a>bulls <span class="ot">&lt;-</span> aus_livestock <span class="sc">|&gt;</span></span>
<span id="cb413-4"><a href="time-series-decomposition.html#cb413-4" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&#39;Victoria&#39;</span>, Animal <span class="sc">==</span> <span class="st">&#39;Bulls, bullocks and steers&#39;</span>)</span>
<span id="cb413-5"><a href="time-series-decomposition.html#cb413-5" tabindex="-1"></a></span>
<span id="cb413-6"><a href="time-series-decomposition.html#cb413-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Optimal lambda: &#39;</span>, <span class="fu">BoxCox.lambda</span>(bulls<span class="sc">$</span>Count)))</span></code></pre></div>
<pre><code>## [1] &quot;Optimal lambda:  0.161509864493434&quot;</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="time-series-decomposition.html#cb415-1" tabindex="-1"></a>bulls <span class="sc">|&gt;</span></span>
<span id="cb415-2"><a href="time-series-decomposition.html#cb415-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Count_boxcox =</span> <span class="fu">box_cox</span>(Count, <span class="at">lambda=</span><span class="fu">BoxCox.lambda</span>(bulls<span class="sc">$</span>Count))) <span class="sc">|&gt;</span></span>
<span id="cb415-3"><a href="time-series-decomposition.html#cb415-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Count_boxcox) <span class="sc">+</span></span>
<span id="cb415-4"><a href="time-series-decomposition.html#cb415-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Slaughter of Bulls, bullocks and steers (BoxCox)&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Victoria&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-26-2.png" width="672" /></p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="time-series-decomposition.html#cb416-1" tabindex="-1"></a><span class="co"># =&gt; Variance became more constant</span></span></code></pre></div>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="time-series-decomposition.html#cb417-1" tabindex="-1"></a><span class="co"># Victorian Electricity Demand from vic_elec.</span></span>
<span id="cb417-2"><a href="time-series-decomposition.html#cb417-2" tabindex="-1"></a></span>
<span id="cb417-3"><a href="time-series-decomposition.html#cb417-3" tabindex="-1"></a>vic_elec <span class="sc">|&gt;</span></span>
<span id="cb417-4"><a href="time-series-decomposition.html#cb417-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Demand) <span class="sc">+</span></span>
<span id="cb417-5"><a href="time-series-decomposition.html#cb417-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Victorian Electricity Demand&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Victoria&#39;</span>, <span class="at">y=</span><span class="st">&#39;GWh&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="time-series-decomposition.html#cb418-1" tabindex="-1"></a><span class="co"># apply transformation</span></span>
<span id="cb418-2"><a href="time-series-decomposition.html#cb418-2" tabindex="-1"></a></span>
<span id="cb418-3"><a href="time-series-decomposition.html#cb418-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> vic_elec <span class="sc">|&gt;</span></span>
<span id="cb418-4"><a href="time-series-decomposition.html#cb418-4" tabindex="-1"></a>  <span class="fu">features</span>(Demand, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb418-5"><a href="time-series-decomposition.html#cb418-5" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb418-6"><a href="time-series-decomposition.html#cb418-6" tabindex="-1"></a></span>
<span id="cb418-7"><a href="time-series-decomposition.html#cb418-7" tabindex="-1"></a>vic_elec <span class="sc">|&gt;</span></span>
<span id="cb418-8"><a href="time-series-decomposition.html#cb418-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Demand_cb =</span> <span class="fu">BoxCox</span>(Demand, <span class="at">lambda =</span> lambda)) <span class="sc">|&gt;</span></span>
<span id="cb418-9"><a href="time-series-decomposition.html#cb418-9" tabindex="-1"></a>  <span class="fu">autoplot</span>(Demand_cb) <span class="sc">+</span></span>
<span id="cb418-10"><a href="time-series-decomposition.html#cb418-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Victorian Electricity Demand (BoxCox)&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Victoria&#39;</span>, <span class="at">y=</span><span class="st">&#39;GWh&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-27-2.png" width="672" /></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="time-series-decomposition.html#cb419-1" tabindex="-1"></a><span class="co"># =&gt; Peaks became lower</span></span></code></pre></div>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="time-series-decomposition.html#cb420-1" tabindex="-1"></a><span class="co"># Gas production from aus_production.</span></span>
<span id="cb420-2"><a href="time-series-decomposition.html#cb420-2" tabindex="-1"></a></span>
<span id="cb420-3"><a href="time-series-decomposition.html#cb420-3" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb420-4"><a href="time-series-decomposition.html#cb420-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Gas) <span class="sc">+</span></span>
<span id="cb420-5"><a href="time-series-decomposition.html#cb420-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb420-6"><a href="time-series-decomposition.html#cb420-6" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Gas production in Australia&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="time-series-decomposition.html#cb421-1" tabindex="-1"></a><span class="co"># =&gt; Apply transformation</span></span>
<span id="cb421-2"><a href="time-series-decomposition.html#cb421-2" tabindex="-1"></a></span>
<span id="cb421-3"><a href="time-series-decomposition.html#cb421-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb421-4"><a href="time-series-decomposition.html#cb421-4" tabindex="-1"></a>  <span class="fu">features</span>(Gas, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb421-5"><a href="time-series-decomposition.html#cb421-5" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb421-6"><a href="time-series-decomposition.html#cb421-6" tabindex="-1"></a></span>
<span id="cb421-7"><a href="time-series-decomposition.html#cb421-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Optimal BoxCox lambda:&#39;</span>, lambda))</span></code></pre></div>
<pre><code>## [1] &quot;Optimal BoxCox lambda: 0.109517112981612&quot;</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="time-series-decomposition.html#cb423-1" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb423-2"><a href="time-series-decomposition.html#cb423-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(Gas, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb423-3"><a href="time-series-decomposition.html#cb423-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">box_cox</span>(Gas, lambda)), <span class="at">color=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb423-4"><a href="time-series-decomposition.html#cb423-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb423-5"><a href="time-series-decomposition.html#cb423-5" tabindex="-1"></a>       <span class="at">title =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste0</span>(</span>
<span id="cb423-6"><a href="time-series-decomposition.html#cb423-6" tabindex="-1"></a>         <span class="st">&quot;Transformed gas production with $</span><span class="sc">\\</span><span class="st">lambda$ = &quot;</span>,</span>
<span id="cb423-7"><a href="time-series-decomposition.html#cb423-7" tabindex="-1"></a>         <span class="fu">round</span>(lambda,<span class="dv">2</span>))))</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-28-2.png" width="672" /></p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="time-series-decomposition.html#cb424-1" tabindex="-1"></a><span class="co"># =&gt; Variance became more constant</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="time-series-decomposition.html#cb425-1" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb425-2"><a href="time-series-decomposition.html#cb425-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(Volume) <span class="sc">+</span></span>
<span id="cb425-3"><a href="time-series-decomposition.html#cb425-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Monthly Canadian gas production&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Billions of cubic metres&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="time-series-decomposition.html#cb426-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb426-2"><a href="time-series-decomposition.html#cb426-2" tabindex="-1"></a>  <span class="fu">features</span>(Volume, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb426-3"><a href="time-series-decomposition.html#cb426-3" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb426-4"><a href="time-series-decomposition.html#cb426-4" tabindex="-1"></a></span>
<span id="cb426-5"><a href="time-series-decomposition.html#cb426-5" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb426-6"><a href="time-series-decomposition.html#cb426-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Volume_bc =</span> <span class="fu">box_cox</span>(Volume, <span class="at">lambda=</span>lambda)) <span class="sc">|&gt;</span></span>
<span id="cb426-7"><a href="time-series-decomposition.html#cb426-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(Volume, <span class="at">color=</span><span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb426-8"><a href="time-series-decomposition.html#cb426-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>Volume_bc), <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb426-9"><a href="time-series-decomposition.html#cb426-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Monthly Canadian gas production&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Billions of cubic metres&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-29-2.png" width="672" /></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="time-series-decomposition.html#cb427-1" tabindex="-1"></a><span class="co"># =&gt; BoxCox is unhelpful due to seasonality</span></span>
<span id="cb427-2"><a href="time-series-decomposition.html#cb427-2" tabindex="-1"></a></span>
<span id="cb427-3"><a href="time-series-decomposition.html#cb427-3" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb427-4"><a href="time-series-decomposition.html#cb427-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Volume <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window=</span><span class="dv">21</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window=</span><span class="st">&#39;periodic&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb427-5"><a href="time-series-decomposition.html#cb427-5" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb427-6"><a href="time-series-decomposition.html#cb427-6" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-29-3.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="time-series-decomposition.html#cb428-1" tabindex="-1"></a>myseries <span class="ot">&lt;-</span> aus_retail <span class="sc">|&gt;</span></span>
<span id="cb428-2"><a href="time-series-decomposition.html#cb428-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Series ID</span><span class="st">`</span> <span class="sc">==</span> <span class="fu">sample</span>(aus_retail<span class="sc">$</span><span class="st">`</span><span class="at">Series ID</span><span class="st">`</span>,<span class="dv">1</span>))</span>
<span id="cb428-3"><a href="time-series-decomposition.html#cb428-3" tabindex="-1"></a></span>
<span id="cb428-4"><a href="time-series-decomposition.html#cb428-4" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> myseries <span class="sc">|&gt;</span></span>
<span id="cb428-5"><a href="time-series-decomposition.html#cb428-5" tabindex="-1"></a>  <span class="fu">features</span>(Turnover, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb428-6"><a href="time-series-decomposition.html#cb428-6" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb428-7"><a href="time-series-decomposition.html#cb428-7" tabindex="-1"></a></span>
<span id="cb428-8"><a href="time-series-decomposition.html#cb428-8" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb428-9"><a href="time-series-decomposition.html#cb428-9" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">box_cox</span>(Turnover, lambda))</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-30-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="time-series-decomposition.html#cb429-1" tabindex="-1"></a><span class="co"># Tobacco from aus_production</span></span>
<span id="cb429-2"><a href="time-series-decomposition.html#cb429-2" tabindex="-1"></a></span>
<span id="cb429-3"><a href="time-series-decomposition.html#cb429-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb429-4"><a href="time-series-decomposition.html#cb429-4" tabindex="-1"></a>  <span class="fu">features</span>(Tobacco, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb429-5"><a href="time-series-decomposition.html#cb429-5" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb429-6"><a href="time-series-decomposition.html#cb429-6" tabindex="-1"></a></span>
<span id="cb429-7"><a href="time-series-decomposition.html#cb429-7" tabindex="-1"></a>aus_production <span class="sc">|&gt;</span></span>
<span id="cb429-8"><a href="time-series-decomposition.html#cb429-8" tabindex="-1"></a>  <span class="fu">autoplot</span>(Tobacco, <span class="at">color =</span> <span class="st">&#39;gray&#39;</span>) <span class="sc">+</span></span>
<span id="cb429-9"><a href="time-series-decomposition.html#cb429-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">box_cox</span>(Tobacco, <span class="at">lambda=</span>lambda)), <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb429-10"><a href="time-series-decomposition.html#cb429-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb429-11"><a href="time-series-decomposition.html#cb429-11" tabindex="-1"></a>       <span class="at">title =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste0</span>(</span>
<span id="cb429-12"><a href="time-series-decomposition.html#cb429-12" tabindex="-1"></a>         <span class="st">&quot;Transformed tobacco production with $</span><span class="sc">\\</span><span class="st">lambda$ = &quot;</span>,</span>
<span id="cb429-13"><a href="time-series-decomposition.html#cb429-13" tabindex="-1"></a>         <span class="fu">round</span>(lambda,<span class="dv">2</span>))))</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="time-series-decomposition.html#cb430-1" tabindex="-1"></a><span class="co"># Economy class passengers between Melbourne and Sydney from ansett</span></span>
<span id="cb430-2"><a href="time-series-decomposition.html#cb430-2" tabindex="-1"></a></span>
<span id="cb430-3"><a href="time-series-decomposition.html#cb430-3" tabindex="-1"></a>pass_mel_syd <span class="ot">&lt;-</span> ansett <span class="sc">|&gt;</span></span>
<span id="cb430-4"><a href="time-series-decomposition.html#cb430-4" tabindex="-1"></a>  <span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">&#39;Economy&#39;</span>, Airports <span class="sc">==</span> <span class="st">&#39;MEL-SYD&#39;</span>)</span>
<span id="cb430-5"><a href="time-series-decomposition.html#cb430-5" tabindex="-1"></a></span>
<span id="cb430-6"><a href="time-series-decomposition.html#cb430-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> pass_mel_syd <span class="sc">|&gt;</span></span>
<span id="cb430-7"><a href="time-series-decomposition.html#cb430-7" tabindex="-1"></a>  <span class="fu">features</span>(Passengers, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb430-8"><a href="time-series-decomposition.html#cb430-8" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb430-9"><a href="time-series-decomposition.html#cb430-9" tabindex="-1"></a></span>
<span id="cb430-10"><a href="time-series-decomposition.html#cb430-10" tabindex="-1"></a>pass_mel_syd  <span class="sc">|&gt;</span></span>
<span id="cb430-11"><a href="time-series-decomposition.html#cb430-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pass_bc =</span> <span class="fu">box_cox</span>(Passengers, lambda)) <span class="sc">|&gt;</span></span>
<span id="cb430-12"><a href="time-series-decomposition.html#cb430-12" tabindex="-1"></a>  <span class="fu">autoplot</span>(Pass_bc, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb430-13"><a href="time-series-decomposition.html#cb430-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb430-14"><a href="time-series-decomposition.html#cb430-14" tabindex="-1"></a>       <span class="at">title =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste0</span>(</span>
<span id="cb430-15"><a href="time-series-decomposition.html#cb430-15" tabindex="-1"></a>         <span class="st">&quot;Transformed a number of passangers with $</span><span class="sc">\\</span><span class="st">lambda$ = &quot;</span>,</span>
<span id="cb430-16"><a href="time-series-decomposition.html#cb430-16" tabindex="-1"></a>         <span class="fu">round</span>(lambda,<span class="dv">2</span>))),</span>
<span id="cb430-17"><a href="time-series-decomposition.html#cb430-17" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Economy class passengers between Melbourne and Sydney&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-32-1.png" width="672" /></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="time-series-decomposition.html#cb431-1" tabindex="-1"></a><span class="co"># Pedestrian counts at Southern Cross Station from pedestrian</span></span>
<span id="cb431-2"><a href="time-series-decomposition.html#cb431-2" tabindex="-1"></a></span>
<span id="cb431-3"><a href="time-series-decomposition.html#cb431-3" tabindex="-1"></a>south_cross <span class="ot">&lt;-</span> pedestrian <span class="sc">|&gt;</span></span>
<span id="cb431-4"><a href="time-series-decomposition.html#cb431-4" tabindex="-1"></a>  <span class="fu">filter</span>(Sensor <span class="sc">==</span> <span class="st">&#39;Southern Cross Station&#39;</span>)</span>
<span id="cb431-5"><a href="time-series-decomposition.html#cb431-5" tabindex="-1"></a></span>
<span id="cb431-6"><a href="time-series-decomposition.html#cb431-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> south_cross <span class="sc">|&gt;</span></span>
<span id="cb431-7"><a href="time-series-decomposition.html#cb431-7" tabindex="-1"></a>  <span class="fu">features</span>(Count, <span class="at">features =</span> guerrero) <span class="sc">|&gt;</span> </span>
<span id="cb431-8"><a href="time-series-decomposition.html#cb431-8" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb431-9"><a href="time-series-decomposition.html#cb431-9" tabindex="-1"></a></span>
<span id="cb431-10"><a href="time-series-decomposition.html#cb431-10" tabindex="-1"></a>south_cross  <span class="sc">|&gt;</span></span>
<span id="cb431-11"><a href="time-series-decomposition.html#cb431-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Count_bc =</span> <span class="fu">box_cox</span>(Count, lambda)) <span class="sc">|&gt;</span></span>
<span id="cb431-12"><a href="time-series-decomposition.html#cb431-12" tabindex="-1"></a>  <span class="fu">autoplot</span>(Count_bc, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>) <span class="sc">+</span></span>
<span id="cb431-13"><a href="time-series-decomposition.html#cb431-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb431-14"><a href="time-series-decomposition.html#cb431-14" tabindex="-1"></a>       <span class="at">title =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste0</span>(</span>
<span id="cb431-15"><a href="time-series-decomposition.html#cb431-15" tabindex="-1"></a>         <span class="st">&quot;Transformed a number of pedestrians with $</span><span class="sc">\\</span><span class="st">lambda$ = &quot;</span>,</span>
<span id="cb431-16"><a href="time-series-decomposition.html#cb431-16" tabindex="-1"></a>         <span class="fu">round</span>(lambda,<span class="dv">2</span>))),</span>
<span id="cb431-17"><a href="time-series-decomposition.html#cb431-17" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Southern Cross Station&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-33-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="time-series-decomposition.html#cb432-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">sample.int</span>(<span class="dv">7</span>))</span>
<span id="cb432-2"><a href="time-series-decomposition.html#cb432-2" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.067</span>, <span class="fl">0.133</span>, <span class="fl">0.200</span>, <span class="fl">0.200</span>, <span class="fl">0.200</span>, <span class="fl">0.133</span>, <span class="fl">0.067</span>)</span>
<span id="cb432-3"><a href="time-series-decomposition.html#cb432-3" tabindex="-1"></a></span>
<span id="cb432-4"><a href="time-series-decomposition.html#cb432-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;3x5-MA = &#39;</span>, </span>
<span id="cb432-5"><a href="time-series-decomposition.html#cb432-5" tabindex="-1"></a>            <span class="fu">round</span>((df <span class="sc">|&gt;</span></span>
<span id="cb432-6"><a href="time-series-decomposition.html#cb432-6" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(value, mean, </span>
<span id="cb432-7"><a href="time-series-decomposition.html#cb432-7" tabindex="-1"></a>                                                    <span class="at">.before =</span> <span class="dv">2</span>, </span>
<span id="cb432-8"><a href="time-series-decomposition.html#cb432-8" tabindex="-1"></a>                                                    <span class="at">.after =</span> <span class="dv">2</span>,</span>
<span id="cb432-9"><a href="time-series-decomposition.html#cb432-9" tabindex="-1"></a>                                                    <span class="at">.complete =</span> <span class="cn">TRUE</span>),</span>
<span id="cb432-10"><a href="time-series-decomposition.html#cb432-10" tabindex="-1"></a>                         <span class="st">`</span><span class="at">3x5-MA</span><span class="st">`</span> <span class="ot">=</span> slider<span class="sc">::</span><span class="fu">slide_dbl</span>(<span class="st">`</span><span class="at">5-MA</span><span class="st">`</span>, mean, </span>
<span id="cb432-11"><a href="time-series-decomposition.html#cb432-11" tabindex="-1"></a>                                                      <span class="at">.before =</span> <span class="dv">1</span>, </span>
<span id="cb432-12"><a href="time-series-decomposition.html#cb432-12" tabindex="-1"></a>                                                      <span class="at">.after =</span> <span class="dv">1</span>,</span>
<span id="cb432-13"><a href="time-series-decomposition.html#cb432-13" tabindex="-1"></a>                                                    <span class="at">.complete =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb432-14"><a href="time-series-decomposition.html#cb432-14" tabindex="-1"></a>                  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">3x5-MA</span><span class="st">`</span>)))<span class="sc">$</span><span class="st">`</span><span class="at">3x5-MA</span><span class="st">`</span>, <span class="dv">2</span>),</span>
<span id="cb432-15"><a href="time-series-decomposition.html#cb432-15" tabindex="-1"></a>      <span class="st">&#39;, 7-term weighted MA = &#39;</span>, </span>
<span id="cb432-16"><a href="time-series-decomposition.html#cb432-16" tabindex="-1"></a>      <span class="fu">round</span>((<span class="fu">cbind</span>(df, w) <span class="sc">|&gt;</span></span>
<span id="cb432-17"><a href="time-series-decomposition.html#cb432-17" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="st">`</span><span class="at">7-term MA</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(value <span class="sc">*</span> w)))<span class="sc">$</span><span class="st">`</span><span class="at">7-term MA</span><span class="st">`</span>, <span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;3x5-MA =  4 , 7-term weighted MA =  4&quot;</code></pre>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="time-series-decomposition.html#cb434-1" tabindex="-1"></a>gas <span class="ot">&lt;-</span> <span class="fu">tail</span>(aus_production, <span class="dv">5</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(Gas)</span>
<span id="cb434-2"><a href="time-series-decomposition.html#cb434-2" tabindex="-1"></a></span>
<span id="cb434-3"><a href="time-series-decomposition.html#cb434-3" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb434-4"><a href="time-series-decomposition.html#cb434-4" tabindex="-1"></a></span>
<span id="cb434-5"><a href="time-series-decomposition.html#cb434-5" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb434-6"><a href="time-series-decomposition.html#cb434-6" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `.vars = Gas`</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="time-series-decomposition.html#cb436-1" tabindex="-1"></a><span class="co"># =&gt; Seasonal fluctuations: summer - less gas production, winter - more, </span></span>
<span id="cb436-2"><a href="time-series-decomposition.html#cb436-2" tabindex="-1"></a><span class="co">#                           trend-cycle - increasing trend</span></span></code></pre></div>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="time-series-decomposition.html#cb437-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb437-2"><a href="time-series-decomposition.html#cb437-2" tabindex="-1"></a></span>
<span id="cb437-3"><a href="time-series-decomposition.html#cb437-3" tabindex="-1"></a>c_dec <span class="ot">&lt;-</span> gas <span class="sc">|&gt;</span></span>
<span id="cb437-4"><a href="time-series-decomposition.html#cb437-4" tabindex="-1"></a>          <span class="fu">model</span>(<span class="at">c_dec =</span> <span class="fu">classical_decomposition</span>(Gas, <span class="at">type=</span><span class="st">&#39;mul&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb437-5"><a href="time-series-decomposition.html#cb437-5" tabindex="-1"></a>          <span class="fu">components</span>()</span>
<span id="cb437-6"><a href="time-series-decomposition.html#cb437-6" tabindex="-1"></a></span>
<span id="cb437-7"><a href="time-series-decomposition.html#cb437-7" tabindex="-1"></a>c_dec <span class="sc">|&gt;</span></span>
<span id="cb437-8"><a href="time-series-decomposition.html#cb437-8" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="time-series-decomposition.html#cb439-1" tabindex="-1"></a><span class="co"># c. </span></span>
<span id="cb439-2"><a href="time-series-decomposition.html#cb439-2" tabindex="-1"></a></span>
<span id="cb439-3"><a href="time-series-decomposition.html#cb439-3" tabindex="-1"></a><span class="co"># Do the results support the graphical interpretation from part a? - YES</span></span></code></pre></div>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="time-series-decomposition.html#cb440-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb440-2"><a href="time-series-decomposition.html#cb440-2" tabindex="-1"></a></span>
<span id="cb440-3"><a href="time-series-decomposition.html#cb440-3" tabindex="-1"></a>c_dec <span class="sc">|&gt;</span></span>
<span id="cb440-4"><a href="time-series-decomposition.html#cb440-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(season_adjust)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="time-series-decomposition.html#cb441-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb441-2"><a href="time-series-decomposition.html#cb441-2" tabindex="-1"></a></span>
<span id="cb441-3"><a href="time-series-decomposition.html#cb441-3" tabindex="-1"></a>gas<span class="sc">$</span>Gas[<span class="fu">length</span>(gas<span class="sc">$</span>Gas) <span class="sc">/</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb441-4"><a href="time-series-decomposition.html#cb441-4" tabindex="-1"></a></span>
<span id="cb441-5"><a href="time-series-decomposition.html#cb441-5" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb441-6"><a href="time-series-decomposition.html#cb441-6" tabindex="-1"></a>      <span class="fu">model</span>(<span class="at">c_dec =</span> <span class="fu">classical_decomposition</span>(Gas, <span class="at">type=</span><span class="st">&#39;mul&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb441-7"><a href="time-series-decomposition.html#cb441-7" tabindex="-1"></a>      <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb441-8"><a href="time-series-decomposition.html#cb441-8" tabindex="-1"></a>      <span class="fu">autoplot</span>(season_adjust)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-38-1.png" width="672" /></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="time-series-decomposition.html#cb442-1" tabindex="-1"></a><span class="co"># f.</span></span>
<span id="cb442-2"><a href="time-series-decomposition.html#cb442-2" tabindex="-1"></a></span>
<span id="cb442-3"><a href="time-series-decomposition.html#cb442-3" tabindex="-1"></a>gas <span class="ot">&lt;-</span> <span class="fu">tail</span>(aus_production, <span class="dv">5</span><span class="sc">*</span><span class="dv">4</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(Gas)</span>
<span id="cb442-4"><a href="time-series-decomposition.html#cb442-4" tabindex="-1"></a>gas<span class="sc">$</span>Gas[<span class="fu">length</span>(gas<span class="sc">$</span>Gas)] <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb442-5"><a href="time-series-decomposition.html#cb442-5" tabindex="-1"></a></span>
<span id="cb442-6"><a href="time-series-decomposition.html#cb442-6" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb442-7"><a href="time-series-decomposition.html#cb442-7" tabindex="-1"></a>      <span class="fu">model</span>(<span class="at">c_dec =</span> <span class="fu">classical_decomposition</span>(Gas, <span class="at">type=</span><span class="st">&#39;mul&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb442-8"><a href="time-series-decomposition.html#cb442-8" tabindex="-1"></a>      <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb442-9"><a href="time-series-decomposition.html#cb442-9" tabindex="-1"></a>      <span class="fu">autoplot</span>(season_adjust)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="time-series-decomposition.html#cb443-1" tabindex="-1"></a><span class="co"># =&gt; the outlier in the middle of the time series changes seasonal pattern</span></span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="time-series-decomposition.html#cb444-1" tabindex="-1"></a><span class="co"># X-11 does not work properly on the MAC OS (in my case)</span></span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>The decomposition of the Australian quarterly labor force data into trend, seasonal, and remainder components reveals distinct patterns. In the first plot (Figure 3.19), the trend component shows a steady increase in the labor force over time, with a slight dip around the 1991/1992 period, indicating the effects of the recession. The seasonal component reflects regular fluctuations across the quarters, but these fluctuations are relatively small in magnitude, suggesting that the seasonal variation in labor force participation is limited compared to the overall trend. In the second plot (Figure 3.20), which displays the seasonal component, we can observe that the recession of 1991/1992 is indeed visible as a notable deviation from the baseline, particularly in the downward spikes during that period.</li>
<li>The scale of the reminder component is much smaller than the trend, but the recession’s impact is clearly captured as a short-term anomaly, confirming the influence of the economic downturn on the labor market. Overall, the recession is most visible in the trend and remainder components.</li>
</ol></li>
<li></li>
</ol>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="time-series-decomposition.html#cb445-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb445-2"><a href="time-series-decomposition.html#cb445-2" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb445-3"><a href="time-series-decomposition.html#cb445-3" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `.vars = Volume`</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="time-series-decomposition.html#cb447-1" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb447-2"><a href="time-series-decomposition.html#cb447-2" tabindex="-1"></a>  <span class="fu">gg_season</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = Volume`</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-41-2.png" width="672" /></p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="time-series-decomposition.html#cb449-1" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb449-2"><a href="time-series-decomposition.html#cb449-2" tabindex="-1"></a>  <span class="fu">gg_subseries</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = Volume`</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-41-3.png" width="672" /></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="time-series-decomposition.html#cb451-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb451-2"><a href="time-series-decomposition.html#cb451-2" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb451-3"><a href="time-series-decomposition.html#cb451-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Volume <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window=</span><span class="dv">11</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window=</span><span class="dv">21</span>))) <span class="sc">|&gt;</span></span>
<span id="cb451-4"><a href="time-series-decomposition.html#cb451-4" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb451-5"><a href="time-series-decomposition.html#cb451-5" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="time-series-decomposition.html#cb452-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb452-2"><a href="time-series-decomposition.html#cb452-2" tabindex="-1"></a></span>
<span id="cb452-3"><a href="time-series-decomposition.html#cb452-3" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb452-4"><a href="time-series-decomposition.html#cb452-4" tabindex="-1"></a>  <span class="fu">gg_season</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = Volume`</code></pre>
<p><img src="figure_html/ch03-ts-decomposition-43-1.png" width="672" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="time-series-decomposition.html#cb454-1" tabindex="-1"></a><span class="co">#d.</span></span>
<span id="cb454-2"><a href="time-series-decomposition.html#cb454-2" tabindex="-1"></a></span>
<span id="cb454-3"><a href="time-series-decomposition.html#cb454-3" tabindex="-1"></a>canadian_gas <span class="sc">|&gt;</span></span>
<span id="cb454-4"><a href="time-series-decomposition.html#cb454-4" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">stl =</span> <span class="fu">STL</span>(Volume <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window=</span><span class="dv">11</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window=</span><span class="dv">21</span>))) <span class="sc">|&gt;</span></span>
<span id="cb454-5"><a href="time-series-decomposition.html#cb454-5" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb454-6"><a href="time-series-decomposition.html#cb454-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(season_adjust)</span></code></pre></div>
<p><img src="figure_html/ch03-ts-decomposition-44-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series-features.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
