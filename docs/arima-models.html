<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 ARIMA models | Forecasting: Principles and Practice (3rd ed)</title>
  <meta name="description" content="Chapter 9 ARIMA models | Forecasting: Principles and Practice (3rd ed)" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 ARIMA models | Forecasting: Principles and Practice (3rd ed)" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/daluchkin/fpp3_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 ARIMA models | Forecasting: Principles and Practice (3rd ed)" />
  
  
  

<meta name="author" content="Dmitry Luchkin" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exponential-smoothing.html"/>
<link rel="next" href="dynamic-regression-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice (3rd ed)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#what-can-be-forecast"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#forecasting-goals-and-planning"><i class="fa fa-check"></i><b>1.2</b> Forecasting, goals and planning</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#determining-what-to-forecast"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#forecasting-data-and-methods"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#some-case-studies"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="getting-started.html"><a href="getting-started.html#the-basic-steps-in-a-forecasting-task"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting"><i class="fa fa-check"></i><b>1.6.1</b> Summary: Five Basic Steps of Forecasting</a></li>
<li class="chapter" data-level="1.6.2" data-path="getting-started.html"><a href="getting-started.html#summary-five-basic-steps-of-forecasting-1"><i class="fa fa-check"></i><b>1.6.2</b> Summary: Five Basic Steps of Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="getting-started.html"><a href="getting-started.html#the-statistical-forecasting-perspective"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="getting-started.html"><a href="getting-started.html#excercises"><i class="fa fa-check"></i><b>1.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-object"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> object</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-index-variable"><i class="fa fa-check"></i><b>2.1.1</b> The index variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-key-variable"><i class="fa fa-check"></i><b>2.1.2</b> The key variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#working-with-tsibble-object"><i class="fa fa-check"></i><b>2.1.3</b> Working with <code>tsibble</code> object</a></li>
<li class="chapter" data-level="2.1.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#read-a-csv-file-and-convert-to-a-tsibble"><i class="fa fa-check"></i><b>2.1.4</b> Read a csv file and convert to a tsibble</a></li>
<li class="chapter" data-level="2.1.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#the-seasonal-period"><i class="fa fa-check"></i><b>2.1.5</b> The seasonal period</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plot"><i class="fa fa-check"></i><b>2.2</b> Time plot</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-series-patterns"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplots"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#correlation"><i class="fa fa-check"></i><b>2.6.1</b> Correlation</a></li>
<li class="chapter" data-level="2.6.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.2</b> Scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.8.1</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="time-series-graphics.html"><a href="time-series-graphics.html#white-moise"><i class="fa fa-check"></i><b>2.9</b> White moise</a></li>
<li class="chapter" data-level="2.10" data-path="time-series-graphics.html"><a href="time-series-graphics.html#excercises-1"><i class="fa fa-check"></i><b>2.10</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformations-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformations and adjustments</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#mathematical-transformations"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#time-series-components"><i class="fa fa-check"></i><b>3.2</b> Time series components</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seasonally-adjusted-data"><i class="fa fa-check"></i><b>3.2.1</b> Seasonally adjusted data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.3</b> Moving averages</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-average-smoothing"><i class="fa fa-check"></i><b>3.3.1</b> Moving average smoothing</a></li>
<li class="chapter" data-level="3.3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.3.2</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-with-seasonal-data"><i class="fa fa-check"></i><b>3.3.3</b> Estimating the trend-cycle with seasonal data</a></li>
<li class="chapter" data-level="3.3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>3.3.4</b> Example: Employment in the US retail sector</a></li>
<li class="chapter" data-level="3.3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.3.5</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.4</b> Classical decomposition</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#additive-decomposition"><i class="fa fa-check"></i><b>3.4.1</b> Additive decomposition</a></li>
<li class="chapter" data-level="3.4.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#multiplicative-decomposition"><i class="fa fa-check"></i><b>3.4.2</b> Multiplicative decomposition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#excercises-2"><i class="fa fa-check"></i><b>3.5</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#some-simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Some simple statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.1.1</b> ACF features</a></li>
<li class="chapter" data-level="4.1.2" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.1.2</b> STL features</a></li>
<li class="chapter" data-level="4.1.3" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.1.3</b> Other features</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#exploring-australian-tourism-data"><i class="fa fa-check"></i><b>4.2</b> Exploring Australian tourism data</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#exercises"><i class="fa fa-check"></i><b>4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#plot-the-data-visualise"><i class="fa fa-check"></i><b>5.1.2</b> Plot the data (visualise)</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naiïve-method"><i class="fa fa-check"></i><b>5.2.2</b> Naiïve method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naïve-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naïve method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#model-fitting"><i class="fa fa-check"></i><b>5.2.5</b> Model fitting</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#producing-forecasts"><i class="fa fa-check"></i><b>5.2.6</b> Producing forecasts</a></li>
<li class="chapter" data-level="5.2.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualising-forecasts"><i class="fa fa-check"></i><b>5.2.7</b> Visualising forecasts</a></li>
<li class="chapter" data-level="5.2.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-facebook-closing-stock-price"><i class="fa fa-check"></i><b>5.2.8</b> Example: Facebook closing stock price</a></li>
<li class="chapter" data-level="5.2.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.9</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.10</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values"><i class="fa fa-check"></i><b>5.3.1</b> Fitted values</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.2</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#acf-of-residuals"><i class="fa fa-check"></i><b>5.4.1</b> ACF of residuals</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-google-daily-closing-stock-prices"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting Google daily closing stock prices</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#distributional-forecasts-and-prediction-intervals"><i class="fa fa-check"></i><b>5.5</b> Distributional forecasts and prediction intervals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-distributions"><i class="fa fa-check"></i><b>5.5.1</b> Forecast distributions</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.3</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.4</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#benchmark-methods"><i class="fa fa-check"></i><b>5.5.5</b> Benchmark methods</a></li>
<li class="chapter" data-level="5.5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.6</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.6</b> Forecasting using transformations</a></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.7</b> Forecasting with decomposition</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector-1"><i class="fa fa-check"></i><b>5.7.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-point-forecast-accuracy"><i class="fa fa-check"></i><b>5.8</b> Evaluating point forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#training-and-test-sets"><i class="fa fa-check"></i><b>5.8.1</b> Training and test sets</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#functions-to-subset-a-time-series"><i class="fa fa-check"></i><b>5.8.2</b> Functions to subset a time series</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.8.3</b> Forecast errors</a></li>
<li class="chapter" data-level="5.8.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.8.4</b> Scale-dependent errors</a></li>
<li class="chapter" data-level="5.8.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.8.5</b> Percentage errors</a></li>
<li class="chapter" data-level="5.8.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.8.6</b> Scaled errors</a></li>
<li class="chapter" data-level="5.8.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples"><i class="fa fa-check"></i><b>5.8.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-distributional-forecast-accuracy"><i class="fa fa-check"></i><b>5.9</b> Evaluating distributional forecast accuracy</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#quantile-scores"><i class="fa fa-check"></i><b>5.9.1</b> Quantile scores</a></li>
<li class="chapter" data-level="5.9.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#winkler-score"><i class="fa fa-check"></i><b>5.9.2</b> Winkler Score</a></li>
<li class="chapter" data-level="5.9.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#continuous-ranked-probability-score"><i class="fa fa-check"></i><b>5.9.3</b> Continuous Ranked Probability Score</a></li>
<li class="chapter" data-level="5.9.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-free-comparisons-using-skill-scores"><i class="fa fa-check"></i><b>5.9.4</b> Scale-free comparisons using skill scores</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.10</b> Time series cross-validation</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.10.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#exercises-1"><i class="fa fa-check"></i><b>5.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values-1"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness-of-fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-the-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating the regression model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#acf-plot-of-residuals"><i class="fa fa-check"></i><b>7.3.1</b> ACF plot of residuals</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#histogram-of-residuals"><i class="fa fa-check"></i><b>7.3.2</b> Histogram of residuals</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.3</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.4</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.5</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.6</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.3</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusted-r2"><i class="fa fa-check"></i><b>7.5.1</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross-validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#corrected-akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Corrected Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#schwarzs-bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.5</b> Schwarz’s Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>7.5.6</b> Stepwise regression</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.1</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals-1"><i class="fa fa-check"></i><b>7.6.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.7</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.7.1</b> Forecasting with a nonlinear trend</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.8</b> Correlation, causation and forecasting</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>7.8.1</b> Correlation is not causation</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-correlated-predictors"><i class="fa fa-check"></i><b>7.8.2</b> Forecasting with correlated predictors</a></li>
<li class="chapter" data-level="7.8.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multicollinearity-and-forecasting"><i class="fa fa-check"></i><b>7.8.3</b> Multicollinearity and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimisation"><i class="fa fa-check"></i><b>8.1.4</b> Optimisation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend"><i class="fa fa-check"></i><b>8.2</b> Methods with trend</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.2</b> Damped trend methods</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-seasonality"><i class="fa fa-check"></i><b>8.3</b> Methods with seasonality</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.3.1</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.3.2</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.3.3</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.3.4</b> Holt-Winters’ damped method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.6</b> Estimation and model selection</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>8.6.1</b> Model selection</a></li>
<li class="chapter" data-level="8.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.6.2</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.7</b> Forecasting with ETS models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-2"><i class="fa fa-check"></i><b>8.7.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#excercises-3"><i class="fa fa-check"></i><b>8.8</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>9</b> ARIMA models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>9.1</b> Stationarity and differencing</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>9.1.1</b> Differencing</a></li>
<li class="chapter" data-level="9.1.2" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>9.1.2</b> Second-order differencing</a></li>
<li class="chapter" data-level="9.1.3" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>9.1.3</b> Seasonal differencing</a></li>
<li class="chapter" data-level="9.1.4" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>9.1.4</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive (AR) models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="arima-models.html"><a href="arima-models.html#ar1-model"><i class="fa fa-check"></i><b>9.3.1</b> AR(1) model</a></li>
<li class="chapter" data-level="9.3.2" data-path="arima-models.html"><a href="arima-models.html#ar2-model"><i class="fa fa-check"></i><b>9.3.2</b> AR(2) model</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="arima-models.html"><a href="arima-models.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a></li>
<li class="chapter" data-level="9.5" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>9.5</b> Non-seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="arima-models.html"><a href="arima-models.html#example-egyptian-exports"><i class="fa fa-check"></i><b>9.5.1</b> Example: Egyptian exports</a></li>
<li class="chapter" data-level="9.5.2" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-plots"><i class="fa fa-check"></i><b>9.5.2</b> ACF and PACF plots</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>9.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="9.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-fable"><i class="fa fa-check"></i><b>9.7</b> ARIMA modelling in <code>fable</code></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>9.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="9.7.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>9.7.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="9.7.3" data-path="arima-models.html"><a href="arima-models.html#example-central-african-republic-exports"><i class="fa fa-check"></i><b>9.7.3</b> Example: Central African Republic exports</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>9.8</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals-3"><i class="fa fa-check"></i><b>9.8.1</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>9.9</b> Seasonal ARIMA models</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="arima-models.html"><a href="arima-models.html#arima-model-notation"><i class="fa fa-check"></i><b>9.9.1</b> ARIMA Model Notation</a></li>
<li class="chapter" data-level="9.9.2" data-path="arima-models.html"><a href="arima-models.html#acfpacf"><i class="fa fa-check"></i><b>9.9.2</b> ACF/PACF</a></li>
<li class="chapter" data-level="9.9.3" data-path="arima-models.html"><a href="arima-models.html#example-monthly-us-leisure-and-hospitality-employment"><i class="fa fa-check"></i><b>9.9.3</b> Example: Monthly US leisure and hospitality employment</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="arima-models.html"><a href="arima-models.html#arima-vs-ets"><i class="fa fa-check"></i><b>9.10</b> ARIMA vs ETS</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>9.10.1</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="9.10.2" data-path="arima-models.html"><a href="arima-models.html#comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>9.10.2</b> Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="arima-models.html"><a href="arima-models.html#exercises-3"><i class="fa fa-check"></i><b>9.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>10</b> Dynamic regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors-using-fable"><i class="fa fa-check"></i><b>10.1</b> Regression with ARIMA errors using <code>fable</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>10.1.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting-1"><i class="fa fa-check"></i><b>10.2</b> Forecasting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income-1"><i class="fa fa-check"></i><b>10.2.1</b> Example: US Personal Consumption and Income</a></li>
<li class="chapter" data-level="10.2.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>10.2.2</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#stochastic-and-deterministic-trends"><i class="fa fa-check"></i><b>10.3</b> Stochastic and deterministic trends</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-air-transport-passengers-australia"><i class="fa fa-check"></i><b>10.3.1</b> Example: Air transport passengers Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>10.4</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="10.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>10.5</b> Example: Australian eating out expenditure</a></li>
<li class="chapter" data-level="10.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>10.6</b> Lagged predictors</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>10.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html"><i class="fa fa-check"></i><b>11</b> Forecasting hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-and-grouped-time-series"><i class="fa fa-check"></i><b>11.1</b> Hierarchical and grouped time series</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#hierarchical-time-series"><i class="fa fa-check"></i><b>11.1.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="11.1.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-tourism-hierarchy"><i class="fa fa-check"></i><b>11.1.2</b> Example: Australian tourism hierarchy</a></li>
<li class="chapter" data-level="11.1.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#grouped-time-series"><i class="fa fa-check"></i><b>11.1.3</b> Grouped time series</a></li>
<li class="chapter" data-level="11.1.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#example-australian-prison-population"><i class="fa fa-check"></i><b>11.1.4</b> Example: Australian prison population</a></li>
<li class="chapter" data-level="11.1.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#mixed-hierarchical-and-grouped-structure"><i class="fa fa-check"></i><b>11.1.5</b> Mixed hierarchical and grouped structure</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#single-level-approaches"><i class="fa fa-check"></i><b>11.2</b> Single level approaches</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#the-bottom-up-approach"><i class="fa fa-check"></i><b>11.2.1</b> The bottom-up approach</a></li>
<li class="chapter" data-level="11.2.2" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#top-down-approaches"><i class="fa fa-check"></i><b>11.2.2</b> Top-down approaches</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecast-reconciliation"><i class="fa fa-check"></i><b>11.3</b> Forecast reconciliation</a></li>
<li class="chapter" data-level="11.4" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-domestic-tourism"><i class="fa fa-check"></i><b>11.4</b> Forecasting Australian domestic tourism</a></li>
<li class="chapter" data-level="11.5" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#reconciled-distributional-forecasts"><i class="fa fa-check"></i><b>11.5</b> Reconciled distributional forecasts</a></li>
<li class="chapter" data-level="11.6" data-path="forecasting-hierarchical-and-grouped-time-series.html"><a href="forecasting-hierarchical-and-grouped-time-series.html#forecasting-australian-prison-population"><i class="fa fa-check"></i><b>11.6</b> Forecasting Australian prison population</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html"><i class="fa fa-check"></i><b>12</b> Advanced forecasting methods</a>
<ul>
<li class="chapter" data-level="12.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#complex-seasonality"><i class="fa fa-check"></i><b>12.1</b> Complex seasonality</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#stl-with-multiple-seasonal-periods"><i class="fa fa-check"></i><b>12.1.1</b> STL with multiple seasonal periods</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#prophet-model"><i class="fa fa-check"></i><b>12.2</b> Prophet model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-quarterly-cement-production"><i class="fa fa-check"></i><b>12.2.1</b> Example: Quarterly cement production</a></li>
<li class="chapter" data-level="12.2.2" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#example-half-hourly-electricity-demand"><i class="fa fa-check"></i><b>12.2.2</b> Example: Half-hourly electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="advanced-forecasting-methods.html"><a href="advanced-forecasting-methods.html#vector-autoregressions"><i class="fa fa-check"></i><b>12.3</b> Vector autoregressions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/daluchkin?tab=repositories">All Repositories</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice (3rd ed)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="arima-models" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> ARIMA models<a href="arima-models.html#arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><a href="https://otexts.com/fpp3/arima.html">The source of the chapter</a></p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="arima-models.html#cb980-1" tabindex="-1"></a><span class="co"># loading libraries</span></span>
<span id="cb980-2"><a href="arima-models.html#cb980-2" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb980-3"><a href="arima-models.html#cb980-3" tabindex="-1"></a><span class="fu">library</span>(tsibbledata)</span>
<span id="cb980-4"><a href="arima-models.html#cb980-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb980-5"><a href="arima-models.html#cb980-5" tabindex="-1"></a><span class="co"># to read data</span></span>
<span id="cb980-6"><a href="arima-models.html#cb980-6" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb980-7"><a href="arima-models.html#cb980-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb980-8"><a href="arima-models.html#cb980-8" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb980-9"><a href="arima-models.html#cb980-9" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb980-10"><a href="arima-models.html#cb980-10" tabindex="-1"></a><span class="fu">library</span>(fpp3)</span>
<span id="cb980-11"><a href="arima-models.html#cb980-11" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb980-12"><a href="arima-models.html#cb980-12" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<div id="stationarity-and-differencing" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Stationarity and differencing<a href="arima-models.html#stationarity-and-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/stationarity.html">The source of the section</a></p>
<p>A stationary series is:</p>
<ul>
<li>Roughly horizontal =&gt; no trend</li>
<li>Constant variance</li>
<li>No patterns predictable in the long-term =&gt; no seasonality</li>
</ul>
<p><img src="https://otexts.com/fpp3/fpp_files/figure-html/stationary-1.png" /></p>
<ol style="list-style-type: lower-alpha">
<li>Non-stationary: trend</li>
<li><strong>Stationary</strong></li>
<li>Non-stationary: trend</li>
<li>Non-stationary: seasonality</li>
<li>Non-stationary: trend</li>
<li>Non-stationary: trend</li>
<li><strong>Stationary</strong>, cycling</li>
<li>Non-stationary: seasonality</li>
<li>Non-stationary: seasonality, trend, increasing variance</li>
</ol>
<p>So stationary series has no predictable patters in the long-term.</p>
<ul>
<li>Transformation helps to stabilize the variance</li>
<li>For ARIMA modelling, we also need to stabilize the mean</li>
</ul>
<p>Identifying non-stationary series:</p>
<ol style="list-style-type: decimal">
<li>Time plot</li>
<li>The ACF of stationary data drops to zero relatively quickly.</li>
<li>The ACF of non-stationary data decreases slowly.</li>
<li>For non-stationary data, the value of <span class="math inline">\(r_1\)</span> is often large and positive.</li>
</ol>
<div id="differencing" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Differencing<a href="arima-models.html#differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Observe a plot.</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="arima-models.html#cb981-1" tabindex="-1"></a>google_2018 <span class="ot">&lt;-</span> gafa_stock <span class="sc">|&gt;</span></span>
<span id="cb981-2"><a href="arima-models.html#cb981-2" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">==</span> <span class="st">&#39;GOOG&#39;</span>, <span class="fu">year</span>(Date) <span class="sc">==</span> <span class="dv">2018</span>)</span>
<span id="cb981-3"><a href="arima-models.html#cb981-3" tabindex="-1"></a></span>
<span id="cb981-4"><a href="arima-models.html#cb981-4" tabindex="-1"></a>google_2018 <span class="sc">|&gt;</span></span>
<span id="cb981-5"><a href="arima-models.html#cb981-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Close) <span class="sc">+</span></span>
<span id="cb981-6"><a href="arima-models.html#cb981-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Closing stock price ($USD)&#39;</span>, <span class="at">title =</span> <span class="st">&#39;Google closing stock price&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-2-1.png" width="672" /></p>
<p>Observe an ACF.</p>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="arima-models.html#cb982-1" tabindex="-1"></a>google_2018 <span class="sc">|&gt;</span></span>
<span id="cb982-2"><a href="arima-models.html#cb982-2" tabindex="-1"></a>  <span class="fu">ACF</span>(Close) <span class="sc">|&gt;</span></span>
<span id="cb982-3"><a href="arima-models.html#cb982-3" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb982-4"><a href="arima-models.html#cb982-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;ACF&#39;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Google closing stock price&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Provided data has an irregular interval, results should be treated with caution. Computing ACF by observation.</code></pre>
<p><img src="figure_html/ch09-ts-arima-3-1.png" width="672" /></p>
<p><strong>Observations:</strong></p>
<ul>
<li><p>Slow decreasing</p></li>
<li><p>Large and positive ACF at the first lag.</p></li>
</ul>
<p>Observe an ACF of the differenced data.</p>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="arima-models.html#cb984-1" tabindex="-1"></a>google_2018 <span class="sc">|&gt;</span></span>
<span id="cb984-2"><a href="arima-models.html#cb984-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">close_diff =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb984-3"><a href="arima-models.html#cb984-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(close_diff) <span class="sc">+</span></span>
<span id="cb984-4"><a href="arima-models.html#cb984-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&#39;Change in google closing stock price ($USD)&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="arima-models.html#cb986-1" tabindex="-1"></a>google_2018 <span class="sc">|&gt;</span></span>
<span id="cb986-2"><a href="arima-models.html#cb986-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">close_diff =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb986-3"><a href="arima-models.html#cb986-3" tabindex="-1"></a>  <span class="fu">ACF</span>(close_diff) <span class="sc">|&gt;</span></span>
<span id="cb986-4"><a href="arima-models.html#cb986-4" tabindex="-1"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Changes in Google closing stock price&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Provided data has an irregular interval, results should be treated with caution. Computing ACF by observation.</code></pre>
<p><img src="figure_html/ch09-ts-arima-5-1.png" width="672" /></p>
<blockquote>
<p>Transformations such as logarithms can help to stabilise the variance of a time series. Differencing can help stabilise the mean of a time series by removing changes in the level of a time series, and therefore eliminating (or reducing) trend and seasonality.</p>
</blockquote>
<blockquote>
<p>For a stationary time series, the ACF will drop to zero relatively quickly, while the ACF of non-stationary data decreases slowly.</p>
</blockquote>
<p>The formal test to check data stationarity:<br />
</p>
<p>Ljung-Box test: + <strong>H0</strong>: There is <strong>no autocorrelation</strong> in the time series data at the specified lags. + <strong>H1</strong>: There is <strong>autocorrelation</strong> in the time series data at the specified lags. This means that some autocorrelation exists, indicating that the residuals are not independent.</p>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="arima-models.html#cb988-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb988-2"><a href="arima-models.html#cb988-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_close =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb988-3"><a href="arima-models.html#cb988-3" tabindex="-1"></a>  <span class="fu">features</span>(diff_close, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Symbol lb_stat lb_pvalue
##   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 GOOG      7.91     0.637</code></pre>
<p><span class="math inline">\(p\)</span>-value = 0.6, we are fail to reject <span class="math inline">\(H_0\)</span>.</p>
<p>Differencing:</p>
<ul>
<li>Differencing helps to stabilize the mean</li>
<li>The differenced series is the change between each observation in the original series: <span class="math inline">\(y&#39;_t = y_t - y_{t-1}\)</span></li>
<li>The4 differenced series will have only <span class="math inline">\(T-1\)</span> values since it is not possible to calculate a difference <span class="math inline">\(y&#39;_1\)</span> for the first observation</li>
</ul>
</div>
<div id="second-order-differencing" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Second-order differencing<a href="arima-models.html#second-order-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Occasionally the differenced data will not appear stationaty and it may be necessary to difference the data second time:</li>
</ul>
<p><span class="math display">\[
y&#39;&#39;_t = y&#39;_t - y&#39;_{t-1} = (y_t - y_{t-1}) - (y_{t-1} - y_{t-2}) = y_t - 2y_{t-1} + y_{t-2}
\]</span></p>
</div>
<div id="seasonal-differencing" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Seasonal differencing<a href="arima-models.html#seasonal-differencing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A seasonal differencing is the differencing between an observation and the corresponding observation from the previous period.</li>
</ul>
<p><span class="math display">\[
y&#39;_t = y_t - y_{t-m}
\]</span></p>
<p>where <span class="math inline">\(m\)</span> is a number of seasons.</p>
<ul>
<li>For monthly data <span class="math inline">\(m\)</span> = 12</li>
<li>For quarterly data <span class="math inline">\(m\)</span> = 4</li>
<li>Seasonal differenced series will have <span class="math inline">\(T-m\)</span> observations.</li>
</ul>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="arima-models.html#cb990-1" tabindex="-1"></a>a10 <span class="ot">&lt;-</span> PBS <span class="sc">|&gt;</span></span>
<span id="cb990-2"><a href="arima-models.html#cb990-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&#39;A10&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb990-3"><a href="arima-models.html#cb990-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Cost =</span> <span class="fu">sum</span>(Cost) <span class="sc">/</span> <span class="fl">1e6</span>)</span>
<span id="cb990-4"><a href="arima-models.html#cb990-4" tabindex="-1"></a></span>
<span id="cb990-5"><a href="arima-models.html#cb990-5" tabindex="-1"></a>a10 <span class="sc">|&gt;</span></span>
<span id="cb990-6"><a href="arima-models.html#cb990-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(Cost)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-7-1.png" width="672" /></p>
<ul>
<li>The series is non-stationary</li>
<li>The variance is changing, it is lower at the earlier observations and higher at the last ones.</li>
</ul>
<p>Apply log transformation to stabilize the variance:</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="arima-models.html#cb991-1" tabindex="-1"></a>a10 <span class="sc">|&gt;</span></span>
<span id="cb991-2"><a href="arima-models.html#cb991-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">log</span>(Cost))</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-8-1.png" width="672" /></p>
<p>Deal with the seasonal component:</p>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="arima-models.html#cb992-1" tabindex="-1"></a>a10 <span class="sc">|&gt;</span></span>
<span id="cb992-2"><a href="arima-models.html#cb992-2" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="fu">log</span>(Cost) <span class="sc">|&gt;</span> <span class="fu">difference</span>(<span class="dv">12</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-9-1.png" width="672" /></p>
<p>It is possibly stationary. Apply formal tests.</p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="arima-models.html#cb994-1" tabindex="-1"></a>a10 <span class="sc">|&gt;</span></span>
<span id="cb994-2"><a href="arima-models.html#cb994-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Sales ($ million)</span><span class="st">`</span> <span class="ot">=</span> Cost) <span class="sc">|&gt;</span></span>
<span id="cb994-3"><a href="arima-models.html#cb994-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">Sales ($ million)</span><span class="st">`</span>), </span>
<span id="cb994-4"><a href="arima-models.html#cb994-4" tabindex="-1"></a>         <span class="st">`</span><span class="at">Annual change in log sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span>, <span class="dv">12</span>)) <span class="sc">|&gt;</span></span>
<span id="cb994-5"><a href="arima-models.html#cb994-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Sales ($ million)</span><span class="st">`</span>, </span>
<span id="cb994-6"><a href="arima-models.html#cb994-6" tabindex="-1"></a>                        <span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span>,</span>
<span id="cb994-7"><a href="arima-models.html#cb994-7" tabindex="-1"></a>                        <span class="st">`</span><span class="at">Annual change in log sales</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb994-8"><a href="arima-models.html#cb994-8" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb994-9"><a href="arima-models.html#cb994-9" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb994-10"><a href="arima-models.html#cb994-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Antidiabetic drug sales&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-10-1.png" width="672" /></p>
<blockquote>
<p>Sometimes it is necessary to take both a seasonal difference and a first difference to obtain stationary data.</p>
</blockquote>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="arima-models.html#cb996-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> PBS <span class="sc">|&gt;</span></span>
<span id="cb996-2"><a href="arima-models.html#cb996-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&#39;H02&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb996-3"><a href="arima-models.html#cb996-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Cost =</span> <span class="fu">sum</span>(Cost) <span class="sc">/</span> <span class="fl">1e6</span>) <span class="sc">|&gt;</span></span>
<span id="cb996-4"><a href="arima-models.html#cb996-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Sales ($million)</span><span class="st">`</span> <span class="ot">=</span> Cost)</span>
<span id="cb996-5"><a href="arima-models.html#cb996-5" tabindex="-1"></a></span>
<span id="cb996-6"><a href="arima-models.html#cb996-6" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb996-7"><a href="arima-models.html#cb996-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Sales ($million)</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb996-8"><a href="arima-models.html#cb996-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Corticosteroid drug sales&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Raw data&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-11-1.png" width="672" /></p>
<ul>
<li>Data is non-stationary</li>
<li>The variance is unstable during the series.</li>
</ul>
<p>Transform the data to stabilize the variance.</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="arima-models.html#cb997-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> h02 <span class="sc">|&gt;</span></span>
<span id="cb997-2"><a href="arima-models.html#cb997-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">log</span>(<span class="st">`</span><span class="at">Sales ($million)</span><span class="st">`</span>))</span>
<span id="cb997-3"><a href="arima-models.html#cb997-3" tabindex="-1"></a></span>
<span id="cb997-4"><a href="arima-models.html#cb997-4" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb997-5"><a href="arima-models.html#cb997-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb997-6"><a href="arima-models.html#cb997-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Corticosteroid drug sales&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Log Sales data&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-12-1.png" width="672" /></p>
<ul>
<li>The variance is stable</li>
<li>There is strong seasonality in the series</li>
</ul>
<p>Apply seasonal differencing to the logged data.</p>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="arima-models.html#cb998-1" tabindex="-1"></a><span class="fu">frequency</span>(h02)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="arima-models.html#cb1000-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> h02 <span class="sc">|&gt;</span></span>
<span id="cb1000-2"><a href="arima-models.html#cb1000-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Annual change in log Sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Log Sales</span><span class="st">`</span>, <span class="dv">12</span>))</span>
<span id="cb1000-3"><a href="arima-models.html#cb1000-3" tabindex="-1"></a></span>
<span id="cb1000-4"><a href="arima-models.html#cb1000-4" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb1000-5"><a href="arima-models.html#cb1000-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Annual change in log Sales</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb1000-6"><a href="arima-models.html#cb1000-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Corticosteroid drug sales&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Annual change in log Sales&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-14-1.png" width="672" /></p>
<ul>
<li>Seasonal differenced data is closer to being stationary</li>
<li>Remaining non-stationarity can be removed with further first difference</li>
</ul>
<p>Apply the first difference to the annual change.</p>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="arima-models.html#cb1002-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> h02 <span class="sc">|&gt;</span></span>
<span id="cb1002-2"><a href="arima-models.html#cb1002-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Doubly differenced log Sales</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Annual change in log Sales</span><span class="st">`</span>, <span class="dv">1</span>))</span>
<span id="cb1002-3"><a href="arima-models.html#cb1002-3" tabindex="-1"></a></span>
<span id="cb1002-4"><a href="arima-models.html#cb1002-4" tabindex="-1"></a>h02 <span class="sc">|&gt;</span></span>
<span id="cb1002-5"><a href="arima-models.html#cb1002-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="st">`</span><span class="at">Doubly differenced log Sales</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb1002-6"><a href="arima-models.html#cb1002-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Corticosteroid drug sales&#39;</span>, <span class="at">subtitle =</span> <span class="st">&#39;Doubly differenced log Sales&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-15-1.png" width="672" /></p>
</div>
<div id="unit-root-tests" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Unit root tests<a href="arima-models.html#unit-root-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are statistical hypothesis tests of stationarity that are designed for determining whether differencing is required.</p>
<ol style="list-style-type: decimal">
<li>Augment Dickey Fuller test:
<ul>
<li><span class="math inline">\(H_0\)</span>: The data are non-stationary</li>
<li><span class="math inline">\(H_A\)</span>: The data are stationary</li>
</ul></li>
<li>Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test:
<ul>
<li><span class="math inline">\(H_0\)</span>: The data are stationary</li>
<li><span class="math inline">\(H_A\)</span>: The data are non-stationary</li>
</ul></li>
</ol>
<p>If <span class="math inline">\(p\)</span>-value is less than 0.05 in KPSS test, it suggests that differencing is required.</p>
<div class="sourceCode" id="cb1004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1004-1"><a href="arima-models.html#cb1004-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb1004-2"><a href="arima-models.html#cb1004-2" tabindex="-1"></a>  <span class="fu">features</span>(Close, unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Symbol kpss_stat kpss_pvalue
##   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 GOOG        3.56        0.01</code></pre>
<p><span class="math inline">\(p\)</span>-value = 0.01 =&gt; <span class="math inline">\(H_0\)</span> is rejected and the data are not stationary.</p>
<div class="sourceCode" id="cb1006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1006-1"><a href="arima-models.html#cb1006-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb1006-2"><a href="arima-models.html#cb1006-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_close =</span> <span class="fu">difference</span>(Close)) <span class="sc">|&gt;</span></span>
<span id="cb1006-3"><a href="arima-models.html#cb1006-3" tabindex="-1"></a>  <span class="fu">features</span>(diff_close, unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Symbol kpss_stat kpss_pvalue
##   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 GOOG      0.0989         0.1</code></pre>
<p>The differenced data are stationary now.</p>
<div class="sourceCode" id="cb1008"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1008-1"><a href="arima-models.html#cb1008-1" tabindex="-1"></a>google_2015 <span class="sc">|&gt;</span></span>
<span id="cb1008-2"><a href="arima-models.html#cb1008-2" tabindex="-1"></a>  <span class="fu">features</span>(Close, unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   Symbol ndiffs
##   &lt;chr&gt;   &lt;int&gt;
## 1 GOOG        1</code></pre>
<p>One difference is required to make the <code>google_2015</code> data stationary.</p>
<p>To determine whether seasonal differencing is required use <code>unitroot_ns</code>. No seasonal differences are suggested if <span class="math inline">\(F_S &lt; 0.64\)</span>, otherwise one seasonal difference is suggested.</p>
<div class="sourceCode" id="cb1010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1010-1"><a href="arima-models.html#cb1010-1" tabindex="-1"></a>aus_total_retail <span class="ot">&lt;-</span> aus_retail <span class="sc">|&gt;</span></span>
<span id="cb1010-2"><a href="arima-models.html#cb1010-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Turnover =</span> <span class="fu">sum</span>(Turnover))</span>
<span id="cb1010-3"><a href="arima-models.html#cb1010-3" tabindex="-1"></a></span>
<span id="cb1010-4"><a href="arima-models.html#cb1010-4" tabindex="-1"></a>aus_total_retail <span class="sc">|&gt;</span></span>
<span id="cb1010-5"><a href="arima-models.html#cb1010-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_turnover =</span> <span class="fu">log</span>(Turnover)) <span class="sc">|&gt;</span></span>
<span id="cb1010-6"><a href="arima-models.html#cb1010-6" tabindex="-1"></a>  <span class="fu">features</span>(log_turnover, unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   nsdiffs
##     &lt;int&gt;
## 1       1</code></pre>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="arima-models.html#cb1012-1" tabindex="-1"></a>aus_total_retail <span class="sc">|&gt;</span></span>
<span id="cb1012-2"><a href="arima-models.html#cb1012-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_turnover =</span> <span class="fu">difference</span>(<span class="fu">log</span>(Turnover), <span class="dv">12</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1012-3"><a href="arima-models.html#cb1012-3" tabindex="-1"></a>  <span class="fu">features</span>(log_turnover, unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   ndiffs
##    &lt;int&gt;
## 1      1</code></pre>
</div>
</div>
<div id="backshift-notation" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Backshift notation<a href="arima-models.html#backshift-notation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/backshift.html">The source of the section</a></p>
<p>Shifting the data back <strong>one</strong> period:</p>
<p><span class="math display">\[
By_t = y_{t-1}
\]</span></p>
<p>Shifting the data back <strong>two</strong> periods:</p>
<p><span class="math display">\[
B(By_t) = B^2y_t = y_{t-1}
\]</span> Shifting the data back <span class="math inline">\(m\)</span> periods:</p>
<p><span class="math display">\[
B^my_t = y_{t-m}
\]</span></p>
<p>A first difference:</p>
<p><span class="math display">\[
y&#39;_t = y_t - y_{t-1} = y_t - By_t = (1-B)y_t
\]</span></p>
<p>Second-order differences:</p>
<p><span class="math display">\[
y&#39;&#39;_t = (y_t - y_{t-1}) - (y_{t-1} - t_{t-2}) = y_t - y_{t-1} - y_{t-1} + y_{t-2} = y_t - 2y_{t-1} + y_{t-2} = (1-2B + B^2)y_t = (1-B)^2y_t
\]</span> <span class="math inline">\(d\)</span>th-order difference:</p>
<p><span class="math display">\[
(1 - B)^dy_t
\]</span> A seasonal difference followed by a first difference:</p>
<p><span class="math display">\[
(1-B)(1-B^m)y_t = (1-B-B^m+B^{m+1})y_t = y_t - y_{t-1} - y_{t-m} + y_{t-m-1}
\]</span></p>
</div>
<div id="autoregressive-ar-models" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Autoregressive (AR) models<a href="arima-models.html#autoregressive-ar-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/AR.html">The source of the section</a></p>
<p>In an autoregression model a linear combionation of past values of the variable are used.</p>
<p>Autoregression model <strong>AR(p)</strong> of order <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
y_t = c + \phi_1y_{t-1} + \phi_2y_{t-2} +...+\phi_ty_{t-p} + \varepsilon_t
\]</span></p>
<div id="ar1-model" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> AR(1) model<a href="arima-models.html#ar1-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An autoregressive model of order 1.</p>
<p><span class="math display">\[
y_t = c + \phi_1y_{t-1} + \varepsilon_t
\]</span></p>
<ul>
<li>When <span class="math inline">\(\phi_1 = 0\)</span>, <span class="math inline">\(y_t\)</span> is equivalent to a white noise: <span class="math inline">\(y_t = \varepsilon_t\)</span></li>
<li>When <span class="math inline">\(\phi_1 = 1\)</span> and <span class="math inline">\(c = 0\)</span>, <span class="math inline">\(y_t\)</span> is equivalent to a random walk: <span class="math inline">\(y_t = y_{t-1} + \varepsilon_t\)</span></li>
<li>When <span class="math inline">\(\phi_1 = 1\)</span> and <span class="math inline">\(c \ne 0\)</span>, <span class="math inline">\(y_t\)</span> is equivalent to a random walk with drift: <span class="math inline">\(y_t = c + y_{t-1} + \varepsilon_t\)</span></li>
<li>Constraints: <span class="math inline">\(-1 &lt; \phi_1 &lt; 1\)</span>, the closer <span class="math inline">\(\phi_1\)</span> is to the bounds the more the process wanders above or below it’s unconditional mean</li>
<li>When <span class="math inline">\(\phi &lt; 0\)</span>, <span class="math inline">\(y_t\)</span> tends to oscillate around the mean.</li>
<li><span class="math inline">\(c\)</span> is related to the mean of <span class="math inline">\(y_t\)</span></li>
<li><span class="math inline">\(\mathbb E(y_t) = \mu\)</span></li>
<li><span class="math inline">\(\mu = c + \phi_1\mu\)</span></li>
<li><span class="math inline">\(\mu = \frac c {1-\phi_1}\)</span></li>
<li>AR(1): ARIMA(1, 0, 0)</li>
</ul>
</div>
<div id="ar2-model" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> AR(2) model<a href="arima-models.html#ar2-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Constraints:</p>
<ul>
<li><span class="math inline">\(-1 &lt; \phi_2 &lt; 1, \phi_1+\phi_2 &lt; 1, \phi_2 - \phi_1 &lt; 1\)</span></li>
</ul>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="arima-models.html#cb1014-1" tabindex="-1"></a>ar_processes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1014-2"><a href="arima-models.html#cb1014-2" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb1014-3"><a href="arima-models.html#cb1014-3" tabindex="-1"></a>  <span class="co"># y_t = 18 - 0.8 * y_t-1 + epsilon_t</span></span>
<span id="cb1014-4"><a href="arima-models.html#cb1014-4" tabindex="-1"></a>  <span class="at">ar1 =</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb1014-5"><a href="arima-models.html#cb1014-5" tabindex="-1"></a>                  <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="sc">-</span><span class="fl">0.8</span>)) <span class="sc">+</span> <span class="dv">18</span>,</span>
<span id="cb1014-6"><a href="arima-models.html#cb1014-6" tabindex="-1"></a>  <span class="co"># y_t = 8 + 1.3 * y_t-1 - 0.7 * y_t-2 + epsilon_t</span></span>
<span id="cb1014-7"><a href="arima-models.html#cb1014-7" tabindex="-1"></a>  <span class="at">ar2 =</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb1014-8"><a href="arima-models.html#cb1014-8" tabindex="-1"></a>                  <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="sc">-</span><span class="fl">0.7</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb1014-9"><a href="arima-models.html#cb1014-9" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> n)</span>
<span id="cb1014-10"><a href="arima-models.html#cb1014-10" tabindex="-1"></a></span>
<span id="cb1014-11"><a href="arima-models.html#cb1014-11" tabindex="-1"></a>ar_processes <span class="sc">|&gt;</span></span>
<span id="cb1014-12"><a href="arima-models.html#cb1014-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ar1, ar2)) <span class="sc">|&gt;</span></span>
<span id="cb1014-13"><a href="arima-models.html#cb1014-13" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1014-14"><a href="arima-models.html#cb1014-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1015-1"><a href="arima-models.html#cb1015-1" tabindex="-1"></a>ar_processes <span class="sc">|&gt;</span></span>
<span id="cb1015-2"><a href="arima-models.html#cb1015-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(ar1, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) </span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-22-1.png" width="672" /></p>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="arima-models.html#cb1016-1" tabindex="-1"></a>ar_processes <span class="sc">|&gt;</span></span>
<span id="cb1016-2"><a href="arima-models.html#cb1016-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(ar2, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) </span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-23-1.png" width="672" /></p>
</div>
</div>
<div id="moving-average-models" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Moving average models<a href="arima-models.html#moving-average-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/MA.html">The source of the section</a></p>
<p>A moving average model MA(q) uses past forecast errors in a regression-like model.</p>
<p><span class="math display">\[
y_t = c + \varepsilon_t + \theta_1\varepsilon_{t-1}+ \theta_2\varepsilon_{t-2} +...+ \theta_q\varepsilon_{t-q}
\]</span></p>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1017-1"><a href="arima-models.html#cb1017-1" tabindex="-1"></a>ma_processes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1017-2"><a href="arima-models.html#cb1017-2" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb1017-3"><a href="arima-models.html#cb1017-3" tabindex="-1"></a>  <span class="co"># y_t = 20 + epsilon_t + 0.8 * epsilon_t-1</span></span>
<span id="cb1017-4"><a href="arima-models.html#cb1017-4" tabindex="-1"></a>  <span class="at">ma1 =</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb1017-5"><a href="arima-models.html#cb1017-5" tabindex="-1"></a>                  <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ma =</span> <span class="fl">0.8</span>)) <span class="sc">+</span> <span class="dv">20</span>,</span>
<span id="cb1017-6"><a href="arima-models.html#cb1017-6" tabindex="-1"></a>  <span class="co"># y_t = epsilon_t - epsilon_t-1 + 0.8 * epsilon_t-2</span></span>
<span id="cb1017-7"><a href="arima-models.html#cb1017-7" tabindex="-1"></a>  <span class="at">ma2 =</span> <span class="fu">arima.sim</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb1017-8"><a href="arima-models.html#cb1017-8" tabindex="-1"></a>                  <span class="at">model =</span> <span class="fu">list</span>(<span class="at">ma =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.8</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb1017-9"><a href="arima-models.html#cb1017-9" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> n)</span>
<span id="cb1017-10"><a href="arima-models.html#cb1017-10" tabindex="-1"></a></span>
<span id="cb1017-11"><a href="arima-models.html#cb1017-11" tabindex="-1"></a>ma_processes <span class="sc">|&gt;</span></span>
<span id="cb1017-12"><a href="arima-models.html#cb1017-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ma1, ma2)) <span class="sc">|&gt;</span></span>
<span id="cb1017-13"><a href="arima-models.html#cb1017-13" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1017-14"><a href="arima-models.html#cb1017-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="arima-models.html#cb1018-1" tabindex="-1"></a>ma_processes <span class="sc">|&gt;</span></span>
<span id="cb1018-2"><a href="arima-models.html#cb1018-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(ma1, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) </span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="arima-models.html#cb1019-1" tabindex="-1"></a>ma_processes <span class="sc">|&gt;</span></span>
<span id="cb1019-2"><a href="arima-models.html#cb1019-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(ma2, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) </span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-26-1.png" width="672" /></p>
</div>
<div id="non-seasonal-arima-models" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Non-seasonal ARIMA models<a href="arima-models.html#non-seasonal-arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/non-seasonal-arima.html">The source of the section</a></p>
<p>A non-seasonal ARIMA model (AutoRegressive Integrated Moving Average) can be written as</p>
<p><span class="math display">\[
y&#39;_t = c + \phi_1y&#39;_{t-1} +...+\phi_py&#39;_{t-p} + \theta_1\varepsilon_{t-1}+...+\theta_q\varepsilon_{t-q} + \varepsilon_t
\]</span> where <span class="math inline">\(y&#39;_t\)</span> is the differenced series and is called an <span class="math inline">\(ARIMA(p, d, q)\)</span> model where</p>
<ul>
<li><span class="math inline">\(p\)</span> = order of autoregressive part</li>
<li><span class="math inline">\(d\)</span> = degree of first differencing involved</li>
<li><span class="math inline">\(q\)</span> = order of the moving average part</li>
</ul>
<p>Special cases of ARIMA models:</p>
<ul>
<li><strong>White noise</strong>: ARIMA(0,0,0) with no constant</li>
<li><strong>Random walk</strong>: ARIMA(0,<strong>1</strong>,0) with <strong>no constant</strong></li>
<li><strong>Random walk with drift</strong>: ARIMA(0,<strong>1</strong>,0) with <strong>a constant</strong></li>
<li><strong>Autoregression</strong>: ARIMA(<strong>p</strong>,0,0)</li>
<li><strong>Moving average</strong>: ARIMA(0,0,<strong>q</strong>)</li>
</ul>
<div id="example-egyptian-exports" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Example: Egyptian exports<a href="arima-models.html#example-egyptian-exports" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1020-1"><a href="arima-models.html#cb1020-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1020-2"><a href="arima-models.html#cb1020-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;EGY&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1020-3"><a href="arima-models.html#cb1020-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Exports) <span class="sc">+</span></span>
<span id="cb1020-4"><a href="arima-models.html#cb1020-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>, <span class="at">title =</span> <span class="st">&#39;Egyptian exports&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="arima-models.html#cb1021-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1021-2"><a href="arima-models.html#cb1021-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;EGY&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1021-3"><a href="arima-models.html#cb1021-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Exports, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) <span class="sc">+</span></span>
<span id="cb1021-4"><a href="arima-models.html#cb1021-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>, <span class="at">title =</span> <span class="st">&#39;Egyptian exports&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-28-1.png" width="672" /></p>
<p>Find the best model.</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="arima-models.html#cb1022-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1022-2"><a href="arima-models.html#cb1022-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;EGY&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1022-3"><a href="arima-models.html#cb1022-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">auto =</span> <span class="fu">ARIMA</span>(Exports)) <span class="sc">|&gt;</span></span>
<span id="cb1022-4"><a href="arima-models.html#cb1022-4" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Exports 
## Model: ARIMA(2,0,1) w/ mean 
## 
## Coefficients:
##          ar1      ar2      ma1  constant
##       1.6764  -0.8034  -0.6896    2.5623
## s.e.  0.1111   0.0928   0.1492    0.1161
## 
## sigma^2 estimated as 8.046:  log likelihood=-141.57
## AIC=293.13   AICc=294.29   BIC=303.43</code></pre>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1024-1"><a href="arima-models.html#cb1024-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1024-2"><a href="arima-models.html#cb1024-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;EGY&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1024-3"><a href="arima-models.html#cb1024-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">auto =</span> <span class="fu">ARIMA</span>(Exports)) <span class="sc">|&gt;</span></span>
<span id="cb1024-4"><a href="arima-models.html#cb1024-4" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1024-5"><a href="arima-models.html#cb1024-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(global_economy) <span class="sc">+</span></span>
<span id="cb1024-6"><a href="arima-models.html#cb1024-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;ARIMA(2,0,1) model forecast of Egyptian exports&#39;</span>, <span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-30-1.png" width="672" /></p>
</div>
<div id="acf-and-pacf-plots" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> ACF and PACF plots<a href="arima-models.html#acf-and-pacf-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using ACF and PACF plots to determine the initial values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</p>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="arima-models.html#cb1025-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1025-2"><a href="arima-models.html#cb1025-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&quot;EGY&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1025-3"><a href="arima-models.html#cb1025-3" tabindex="-1"></a>  <span class="fu">ACF</span>(Exports) <span class="sc">|&gt;</span></span>
<span id="cb1025-4"><a href="arima-models.html#cb1025-4" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb1026"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1026-1"><a href="arima-models.html#cb1026-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1026-2"><a href="arima-models.html#cb1026-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&quot;EGY&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1026-3"><a href="arima-models.html#cb1026-3" tabindex="-1"></a>  <span class="fu">PACF</span>(Exports) <span class="sc">|&gt;</span></span>
<span id="cb1026-4"><a href="arima-models.html#cb1026-4" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-32-1.png" width="672" /></p>
<p>Interpretation of ACF and PACF to find initial <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> values:</p>
<ul>
<li>The data might follow an <span class="math inline">\(ARIMA(p, d, 0)\)</span> if:
<ul>
<li>the ACF demonstrates exponentially decaying of sinusoidal</li>
<li>the PACF demonstrates a significant spike at lag <span class="math inline">\(p\)</span> abd none beyond lag <span class="math inline">\(p\)</span></li>
</ul></li>
<li>The data might follow an <span class="math inline">\(ARIMA(0, d, q)\)</span> if:
<ul>
<li>the PACF demonstrates exponentially decaying of sinusoidal</li>
<li>the ACF demonstrates a significant spike at lag <span class="math inline">\(q\)</span> abd none beyond lag <span class="math inline">\(q\)</span></li>
</ul></li>
</ul>
<p>Find the best model:</p>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="arima-models.html#cb1027-1" tabindex="-1"></a><span class="co"># 1. plot the data and determine the initial values</span></span>
<span id="cb1027-2"><a href="arima-models.html#cb1027-2" tabindex="-1"></a>eg_data <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb1027-3"><a href="arima-models.html#cb1027-3" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;EGY&#39;</span>) </span>
<span id="cb1027-4"><a href="arima-models.html#cb1027-4" tabindex="-1"></a></span>
<span id="cb1027-5"><a href="arima-models.html#cb1027-5" tabindex="-1"></a>eg_data <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>(Exports, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1028-1"><a href="arima-models.html#cb1028-1" tabindex="-1"></a><span class="co"># 2. find the best model</span></span>
<span id="cb1028-2"><a href="arima-models.html#cb1028-2" tabindex="-1"></a>eg_data <span class="sc">|&gt;</span></span>
<span id="cb1028-3"><a href="arima-models.html#cb1028-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Exports <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>))) <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Exports 
## Model: ARIMA(2,0,1) w/ mean 
## 
## Coefficients:
##          ar1      ar2      ma1  constant
##       1.6764  -0.8034  -0.6896    2.5623
## s.e.  0.1111   0.0928   0.1492    0.1161
## 
## sigma^2 estimated as 8.046:  log likelihood=-141.57
## AIC=293.13   AICc=294.29   BIC=303.43</code></pre>
</div>
</div>
<div id="estimation-and-order-selection" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Estimation and order selection<a href="arima-models.html#estimation-and-order-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/arima-estimation.html">The source of the section</a></p>
<p>Good models are obtained by minimising the AIC, AICc or BIC. Using the AICc is more prefered.</p>
<p>It is important to note that these information criteria tend not to be good guides to selecting the appropriate order of differencing (<span class="math inline">\(d\)</span>) of a model, but only for selecting the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</p>
</div>
<div id="arima-modelling-in-fable" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> ARIMA modelling in <code>fable</code><a href="arima-models.html#arima-modelling-in-fable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/arima-r.html">The source of the section</a></p>
<div id="how-does-arima-work" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> How does ARIMA() work?<a href="arima-models.html#how-does-arima-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Hyndman-Khandakar algorithm for automatic ARIMA modelling:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Determine the number of differences <span class="math inline">\(0 \le d \le 2\)</span> using repeated KPSS tests:</p>
<p><span class="math inline">\(H_0\)</span>: The time series is stationary.<br />
<span class="math inline">\(H_1\)</span>: The time series is non-stationary.<br />
<br />
If <span class="math inline">\(H_0\)</span> is not rejected, then work with the origin series, otherwise (If <span class="math inline">\(H_0\)</span> is rejected, then a differencing is needed), apply the test to the first differenced series. Repeat the step, if <span class="math inline">\(H_0\)</span> is rejected, then work with the second differenced test, otherwise, work with the first differenced series.</p></li>
<li><p>Determine the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> by minimising the AICc after diffferencing the data <span class="math inline">\(d\)</span> times using a stepwise search:</p>
<ol style="list-style-type: lower-alpha">
<li>Fit initial models: <span class="math inline">\(ARIMA(0:2, d, 0:2)\)</span> + constant (if <span class="math inline">\(d \le 1\)</span>). If <span class="math inline">\(d \le 1\)</span> then fitted one more model <span class="math inline">\(ARIMA(0, d, 0)\)</span> without constant.</li>
<li>The best model with the smallest AICc is set as current model.</li>
<li>Consider variations of the current model:
<ul>
<li><p>try <span class="math inline">\(p \pm 1\)</span></p></li>
<li><p>try <span class="math inline">\(q \pm 1\)</span></p></li>
<li><p>include\exclude a constant from the current model The variation of the model which AICc is the smallest is set as the new current model.</p></li>
</ul></li>
<li>Repeat <strong>Step 2 (c.)</strong> until no lower AICc can be found.</li>
</ol></li>
</ol>
</div>
<div id="modelling-procedure" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Modelling procedure<a href="arima-models.html#modelling-procedure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general approach for non-seasonal time series data:</p>
<p><img src="https://otexts.com/fpp3/figs/arimaflowchart.png" /></p>
</div>
<div id="example-central-african-republic-exports" class="section level3 hasAnchor" number="9.7.3">
<h3><span class="header-section-number">9.7.3</span> Example: Central African Republic exports<a href="arima-models.html#example-central-african-republic-exports" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Plot the data.</li>
</ol>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="arima-models.html#cb1030-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1030-2"><a href="arima-models.html#cb1030-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;CAF&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1030-3"><a href="arima-models.html#cb1030-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(Exports) <span class="sc">+</span></span>
<span id="cb1030-4"><a href="arima-models.html#cb1030-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Central African Republic exports&#39;</span>, <span class="at">y =</span> <span class="st">&#39;% of GDP&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1031-1"><a href="arima-models.html#cb1031-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1031-2"><a href="arima-models.html#cb1031-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;CAF&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1031-3"><a href="arima-models.html#cb1031-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Exports, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>) </span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-36-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li><p>The variance is not changing, so a Box-Cox transformation does not needed.</p></li>
<li><p>Teh data are not stationary, take a first difference of the data.</p></li>
</ol>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="arima-models.html#cb1032-1" tabindex="-1"></a>global_economy <span class="sc">|&gt;</span></span>
<span id="cb1032-2"><a href="arima-models.html#cb1032-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;CAF&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1032-3"><a href="arima-models.html#cb1032-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Exports), <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-37-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>The differenced data are now stationary.</li>
</ol>
<ul>
<li>The PACF suggests an AR(2) model, ARIMA(2,1,0) is an initial model</li>
<li>The ACF suggests an MA(3) model, ARIMA(0, 1, 3) is an alternative model</li>
</ul>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="arima-models.html#cb1035-1" tabindex="-1"></a>CAF_fit <span class="ot">&lt;-</span>  global_economy <span class="sc">|&gt;</span></span>
<span id="cb1035-2"><a href="arima-models.html#cb1035-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;CAF&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1035-3"><a href="arima-models.html#cb1035-3" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima210 =</span> <span class="fu">ARIMA</span>(Exports <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb1035-4"><a href="arima-models.html#cb1035-4" tabindex="-1"></a>        <span class="at">arima013 =</span> <span class="fu">ARIMA</span>(Exports <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)),</span>
<span id="cb1035-5"><a href="arima-models.html#cb1035-5" tabindex="-1"></a>        <span class="at">stepwise =</span> <span class="fu">ARIMA</span>(Exports),</span>
<span id="cb1035-6"><a href="arima-models.html#cb1035-6" tabindex="-1"></a>        <span class="at">search =</span> <span class="fu">ARIMA</span>(Exports, <span class="at">stepwise =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1035-7"><a href="arima-models.html#cb1035-7" tabindex="-1"></a></span>
<span id="cb1035-8"><a href="arima-models.html#cb1035-8" tabindex="-1"></a>CAF_fit <span class="sc">|&gt;</span></span>
<span id="cb1035-9"><a href="arima-models.html#cb1035-9" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Country, <span class="at">names_to =</span> <span class="st">&#39;Model Name&#39;</span>,</span>
<span id="cb1035-10"><a href="arima-models.html#cb1035-10" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Orders&#39;</span>)</span></code></pre></div>
<pre><code>## # A mable: 4 x 3
## # Key:     Country, Model Name [4]
##   Country                  `Model Name`         Orders
##   &lt;fct&gt;                    &lt;chr&gt;               &lt;model&gt;
## 1 Central African Republic arima210     &lt;ARIMA(2,1,0)&gt;
## 2 Central African Republic arima013     &lt;ARIMA(0,1,3)&gt;
## 3 Central African Republic stepwise     &lt;ARIMA(2,1,2)&gt;
## 4 Central African Republic search       &lt;ARIMA(3,1,0)&gt;</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>ARIMA(3,1,0) has lowest AICc</li>
</ol>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="arima-models.html#cb1037-1" tabindex="-1"></a>CAF_fit <span class="sc">|&gt;</span></span>
<span id="cb1037-2"><a href="arima-models.html#cb1037-2" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb1037-3"><a href="arima-models.html#cb1037-3" tabindex="-1"></a>  <span class="fu">arrange</span>(AICc) <span class="sc">|&gt;</span></span>
<span id="cb1037-4"><a href="arima-models.html#cb1037-4" tabindex="-1"></a>  <span class="fu">select</span>(.model<span class="sc">:</span>BIC)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##   .model   sigma2 log_lik   AIC  AICc   BIC
##   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 search     6.52   -133.  274.  275.  282.
## 2 arima210   6.71   -134.  275.  275.  281.
## 3 arima013   6.54   -133.  274.  275.  282.
## 4 stepwise   6.42   -132.  274.  275.  284.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>The residuals look like white noise.</li>
</ol>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="arima-models.html#cb1039-1" tabindex="-1"></a>CAF_fit <span class="sc">|&gt;</span></span>
<span id="cb1039-2"><a href="arima-models.html#cb1039-2" tabindex="-1"></a>  <span class="fu">select</span>(search) <span class="sc">|&gt;</span></span>
<span id="cb1039-3"><a href="arima-models.html#cb1039-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-40-1.png" width="672" /></p>
<p>A portmanteau test (with K = p + q = 3 + 0 = 3) suggests that the residuals are white noise too.</p>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="arima-models.html#cb1040-1" tabindex="-1"></a><span class="fu">augment</span>(CAF_fit) <span class="sc">|&gt;</span></span>
<span id="cb1040-2"><a href="arima-models.html#cb1040-2" tabindex="-1"></a>  <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">&#39;search&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1040-3"><a href="arima-models.html#cb1040-3" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">dof =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   Country                  .model lb_stat lb_pvalue
##   &lt;fct&gt;                    &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 Central African Republic search    5.75     0.569</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Forecasts from the model.</li>
</ol>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1042-1"><a href="arima-models.html#cb1042-1" tabindex="-1"></a>CAF_fit <span class="sc">|&gt;</span></span>
<span id="cb1042-2"><a href="arima-models.html#cb1042-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb1042-3"><a href="arima-models.html#cb1042-3" tabindex="-1"></a>  <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">&#39;search&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1042-4"><a href="arima-models.html#cb1042-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(global_economy)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-42-1.png" width="672" /></p>
</div>
</div>
<div id="forecasting" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Forecasting<a href="arima-models.html#forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/arima-forecasting.html">The source of the section</a></p>
<div id="prediction-intervals-3" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Prediction intervals<a href="arima-models.html#prediction-intervals-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The prediction intervals for ARIMA models are based on assumptions that the residuals are uncorrelated and normally distributed. If either of these assumptions does not hold, then the prediction intervals may be incorrect. For this reason, always plot the ACF and histogram of the residuals to check the assumptions before producing prediction intervals.</p>
</blockquote>
<p>If the residuals are uncorrelated but not normally distributed, then bootstrapped intervals can be obtained instead. This is easily achieved by simply adding <code>bootstrap=TRUE</code> in the <code>forecast()</code> function.</p>
</div>
</div>
<div id="seasonal-arima-models" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Seasonal ARIMA models<a href="arima-models.html#seasonal-arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/seasonal-arima.html">The source of the section</a></p>
<div id="arima-model-notation" class="section level3 hasAnchor" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> ARIMA Model Notation<a href="arima-models.html#arima-model-notation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\text{ARIMA} \quad
\left( \underbrace{(p, d, q)}_{\text{Non-seasonal part of the model}},
\underbrace{(P, D, Q)_m}_{\text{Seasonal part of the model}} \right)
\]</span></p>
<p>where <span class="math inline">\(m\)</span> is the seasonal period (number of observations per year).</p>
</div>
<div id="acfpacf" class="section level3 hasAnchor" number="9.9.2">
<h3><span class="header-section-number">9.9.2</span> ACF/PACF<a href="arima-models.html#acfpacf" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The seasonal part of an AR or MA model will be seen in the seasonal lags of the PACF and ACF.</p>
</blockquote>
<p><span class="math inline">\(ARIMA(0,0,0)(0,0,1)_{12}\)</span> model:</p>
<ul>
<li>ACF: a significant spike at lag 12 only</li>
<li>PACF: exponential decay in the seasonal lags (12, 24, 36,…)</li>
</ul>
<p><span class="math inline">\(ARIMA(0,0,0)(1,0,0)_{12}\)</span> model:</p>
<ul>
<li>ACF: exponential decay in the seasonal lags (12, 24, 36,…)</li>
<li>PACF: a single significant spike at lag 12</li>
</ul>
</div>
<div id="example-monthly-us-leisure-and-hospitality-employment" class="section level3 hasAnchor" number="9.9.3">
<h3><span class="header-section-number">9.9.3</span> Example: Monthly US leisure and hospitality employment<a href="arima-models.html#example-monthly-us-leisure-and-hospitality-employment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1043-1"><a href="arima-models.html#cb1043-1" tabindex="-1"></a>leisure <span class="ot">&lt;-</span> us_employment <span class="sc">|&gt;</span></span>
<span id="cb1043-2"><a href="arima-models.html#cb1043-2" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">==</span> <span class="st">&quot;Leisure and Hospitality&quot;</span>,</span>
<span id="cb1043-3"><a href="arima-models.html#cb1043-3" tabindex="-1"></a>         <span class="fu">year</span>(Month) <span class="sc">&gt;</span> <span class="dv">2000</span>) <span class="sc">|&gt;</span></span>
<span id="cb1043-4"><a href="arima-models.html#cb1043-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employed =</span> Employed<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb1043-5"><a href="arima-models.html#cb1043-5" tabindex="-1"></a>  <span class="fu">select</span>(Month, Employed)</span>
<span id="cb1043-6"><a href="arima-models.html#cb1043-6" tabindex="-1"></a><span class="fu">autoplot</span>(leisure, Employed) <span class="sc">+</span></span>
<span id="cb1043-7"><a href="arima-models.html#cb1043-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</span>
<span id="cb1043-8"><a href="arima-models.html#cb1043-8" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-43-1.png" width="672" /></p>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1044-1"><a href="arima-models.html#cb1044-1" tabindex="-1"></a>leisure <span class="sc">|&gt;</span></span>
<span id="cb1044-2"><a href="arima-models.html#cb1044-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Employed, <span class="dv">12</span>),</span>
<span id="cb1044-3"><a href="arima-models.html#cb1044-3" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb1044-4"><a href="arima-models.html#cb1044-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Seasonally differenced&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1047-1"><a href="arima-models.html#cb1047-1" tabindex="-1"></a>leisure <span class="sc">|&gt;</span></span>
<span id="cb1047-2"><a href="arima-models.html#cb1047-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(Employed, <span class="dv">12</span>) <span class="sc">|&gt;</span> <span class="fu">difference</span>(),</span>
<span id="cb1047-3"><a href="arima-models.html#cb1047-3" tabindex="-1"></a>               <span class="at">plot_type=</span><span class="st">&#39;partial&#39;</span>, <span class="at">lag=</span><span class="dv">36</span>) <span class="sc">+</span></span>
<span id="cb1047-4"><a href="arima-models.html#cb1047-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Double differenced&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="arima-models.html#cb1050-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> leisure <span class="sc">|&gt;</span></span>
<span id="cb1050-2"><a href="arima-models.html#cb1050-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1050-3"><a href="arima-models.html#cb1050-3" tabindex="-1"></a>    <span class="at">arima012011 =</span> <span class="fu">ARIMA</span>(Employed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1050-4"><a href="arima-models.html#cb1050-4" tabindex="-1"></a>    <span class="at">arima210011 =</span> <span class="fu">ARIMA</span>(Employed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1050-5"><a href="arima-models.html#cb1050-5" tabindex="-1"></a>    <span class="at">arima212111 =</span> <span class="fu">ARIMA</span>(Employed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1050-6"><a href="arima-models.html#cb1050-6" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Employed, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1050-7"><a href="arima-models.html#cb1050-7" tabindex="-1"></a>  )</span>
<span id="cb1050-8"><a href="arima-models.html#cb1050-8" tabindex="-1"></a></span>
<span id="cb1050-9"><a href="arima-models.html#cb1050-9" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb1050-10"><a href="arima-models.html#cb1050-10" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Model name&quot;</span>,</span>
<span id="cb1050-11"><a href="arima-models.html#cb1050-11" tabindex="-1"></a>                     <span class="at">values_to =</span> <span class="st">&quot;Orders&quot;</span>)</span></code></pre></div>
<pre><code>## # A mable: 4 x 2
## # Key:     Model name [4]
##   `Model name`                    Orders
##   &lt;chr&gt;                          &lt;model&gt;
## 1 arima012011  &lt;ARIMA(0,1,2)(0,1,1)[12]&gt;
## 2 arima210011  &lt;ARIMA(2,1,0)(0,1,1)[12]&gt;
## 3 arima212111  &lt;ARIMA(2,1,2)(1,1,1)[12]&gt;
## 4 auto         &lt;ARIMA(2,1,0)(1,1,1)[12]&gt;</code></pre>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1052-1"><a href="arima-models.html#cb1052-1" tabindex="-1"></a><span class="fu">glance</span>(fit) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(AICc) <span class="sc">|&gt;</span> <span class="fu">select</span>(.model<span class="sc">:</span>BIC)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##   .model       sigma2 log_lik   AIC  AICc   BIC
##   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 auto        0.00142    395. -780. -780. -763.
## 2 arima210011 0.00145    392. -776. -776. -763.
## 3 arima212111 0.00143    395. -776. -775. -752.
## 4 arima012011 0.00146    391. -775. -775. -761.</code></pre>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1054-1"><a href="arima-models.html#cb1054-1" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">select</span>(auto) <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag=</span><span class="dv">36</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="arima-models.html#cb1055-1" tabindex="-1"></a><span class="fu">augment</span>(fit) <span class="sc">|&gt;</span></span>
<span id="cb1055-2"><a href="arima-models.html#cb1055-2" tabindex="-1"></a>  <span class="fu">filter</span>(.model <span class="sc">==</span> <span class="st">&quot;auto&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1055-3"><a href="arima-models.html#cb1055-3" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag=</span><span class="dv">24</span>, <span class="at">dof=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model lb_stat lb_pvalue
##   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 auto      16.6     0.680</code></pre>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="arima-models.html#cb1057-1" tabindex="-1"></a><span class="fu">forecast</span>(fit, <span class="at">h=</span><span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb1057-2"><a href="arima-models.html#cb1057-2" tabindex="-1"></a>  <span class="fu">filter</span>(.model<span class="sc">==</span><span class="st">&#39;auto&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1057-3"><a href="arima-models.html#cb1057-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(leisure) <span class="sc">+</span></span>
<span id="cb1057-4"><a href="arima-models.html#cb1057-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US employment: leisure and hospitality&quot;</span>,</span>
<span id="cb1057-5"><a href="arima-models.html#cb1057-5" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Number of people (millions)&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-50-1.png" width="672" /></p>
</div>
</div>
<div id="arima-vs-ets" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> ARIMA vs ETS<a href="arima-models.html#arima-vs-ets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://otexts.com/fpp3/arima-ets.html">The source of the section</a></p>
<div id="comparing-arima-and-ets-on-non-seasonal-data" class="section level3 hasAnchor" number="9.10.1">
<h3><span class="header-section-number">9.10.1</span> Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data<a href="arima-models.html#comparing-arima-and-ets-on-non-seasonal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="arima-models.html#cb1058-1" tabindex="-1"></a>aus_economy <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb1058-2"><a href="arima-models.html#cb1058-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&quot;AUS&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1058-3"><a href="arima-models.html#cb1058-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Population =</span> Population<span class="sc">/</span><span class="fl">1e6</span>)</span>
<span id="cb1058-4"><a href="arima-models.html#cb1058-4" tabindex="-1"></a></span>
<span id="cb1058-5"><a href="arima-models.html#cb1058-5" tabindex="-1"></a>aus_economy <span class="sc">|&gt;</span></span>
<span id="cb1058-6"><a href="arima-models.html#cb1058-6" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb1058-7"><a href="arima-models.html#cb1058-7" tabindex="-1"></a>  <span class="fu">stretch_tsibble</span>(<span class="at">.init =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1058-8"><a href="arima-models.html#cb1058-8" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1058-9"><a href="arima-models.html#cb1058-9" tabindex="-1"></a>    <span class="fu">ETS</span>(Population),</span>
<span id="cb1058-10"><a href="arima-models.html#cb1058-10" tabindex="-1"></a>    <span class="fu">ARIMA</span>(Population)</span>
<span id="cb1058-11"><a href="arima-models.html#cb1058-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1058-12"><a href="arima-models.html#cb1058-12" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb1058-13"><a href="arima-models.html#cb1058-13" tabindex="-1"></a>  <span class="fu">accuracy</span>(aus_economy) <span class="sc">|&gt;</span></span>
<span id="cb1058-14"><a href="arima-models.html#cb1058-14" tabindex="-1"></a>  <span class="fu">select</span>(.model, RMSE<span class="sc">:</span>MAPE)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   .model              RMSE    MAE   MPE  MAPE
##   &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 ARIMA(Population) 0.194  0.0789 0.277 0.509
## 2 ETS(Population)   0.0774 0.0543 0.112 0.327</code></pre>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="arima-models.html#cb1060-1" tabindex="-1"></a>aus_economy <span class="sc">|&gt;</span></span>
<span id="cb1060-2"><a href="arima-models.html#cb1060-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ETS</span>(Population)) <span class="sc">|&gt;</span></span>
<span id="cb1060-3"><a href="arima-models.html#cb1060-3" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1060-4"><a href="arima-models.html#cb1060-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(aus_economy <span class="sc">|&gt;</span> <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2000</span>)) <span class="sc">+</span></span>
<span id="cb1060-5"><a href="arima-models.html#cb1060-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Australian population&quot;</span>,</span>
<span id="cb1060-6"><a href="arima-models.html#cb1060-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;People (millions)&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-52-1.png" width="672" /></p>
</div>
<div id="comparing-arima-and-ets-on-seasonal-data" class="section level3 hasAnchor" number="9.10.2">
<h3><span class="header-section-number">9.10.2</span> Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data<a href="arima-models.html#comparing-arima-and-ets-on-seasonal-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="arima-models.html#cb1061-1" tabindex="-1"></a>cement <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb1061-2"><a href="arima-models.html#cb1061-2" tabindex="-1"></a>  <span class="fu">select</span>(Cement) <span class="sc">|&gt;</span></span>
<span id="cb1061-3"><a href="arima-models.html#cb1061-3" tabindex="-1"></a>  <span class="fu">filter_index</span>(<span class="st">&quot;1988 Q1&quot;</span> <span class="sc">~</span> .)</span>
<span id="cb1061-4"><a href="arima-models.html#cb1061-4" tabindex="-1"></a>train <span class="ot">&lt;-</span> cement <span class="sc">|&gt;</span> <span class="fu">filter_index</span>(. <span class="sc">~</span> <span class="st">&quot;2007 Q4&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1062-1"><a href="arima-models.html#cb1062-1" tabindex="-1"></a>fit_arima <span class="ot">&lt;-</span> train <span class="sc">|&gt;</span> <span class="fu">model</span>(<span class="fu">ARIMA</span>(Cement))</span>
<span id="cb1062-2"><a href="arima-models.html#cb1062-2" tabindex="-1"></a><span class="fu">report</span>(fit_arima)</span></code></pre></div>
<pre><code>## Series: Cement 
## Model: ARIMA(1,0,1)(2,1,1)[4] w/ drift 
## 
## Coefficients:
##          ar1      ma1   sar1     sar2     sma1  constant
##       0.8886  -0.2366  0.081  -0.2345  -0.8979    5.3884
## s.e.  0.0842   0.1334  0.157   0.1392   0.1780    1.4844
## 
## sigma^2 estimated as 11456:  log likelihood=-463.52
## AIC=941.03   AICc=942.68   BIC=957.35</code></pre>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="arima-models.html#cb1064-1" tabindex="-1"></a>fit_arima <span class="sc">|&gt;</span> <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="arima-models.html#cb1065-1" tabindex="-1"></a><span class="fu">augment</span>(fit_arima) <span class="sc">|&gt;</span></span>
<span id="cb1065-2"><a href="arima-models.html#cb1065-2" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">16</span>, <span class="at">dof =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model        lb_stat lb_pvalue
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;
## 1 ARIMA(Cement)    6.37     0.847</code></pre>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="arima-models.html#cb1067-1" tabindex="-1"></a>fit_ets <span class="ot">&lt;-</span> train <span class="sc">|&gt;</span> <span class="fu">model</span>(<span class="fu">ETS</span>(Cement))</span>
<span id="cb1067-2"><a href="arima-models.html#cb1067-2" tabindex="-1"></a><span class="fu">report</span>(fit_ets)</span></code></pre></div>
<pre><code>## Series: Cement 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.7533714 
##     gamma = 0.0001000093 
## 
##   Initial states:
##      l[0]     s[0]    s[-1]    s[-2]     s[-3]
##  1694.712 1.031179 1.045209 1.011424 0.9121874
## 
##   sigma^2:  0.0034
## 
##      AIC     AICc      BIC 
## 1104.095 1105.650 1120.769</code></pre>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="arima-models.html#cb1069-1" tabindex="-1"></a>fit_ets <span class="sc">|&gt;</span></span>
<span id="cb1069-2"><a href="arima-models.html#cb1069-2" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>(<span class="at">lag_max =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-58-1.png" width="672" /></p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="arima-models.html#cb1070-1" tabindex="-1"></a><span class="fu">augment</span>(fit_ets) <span class="sc">|&gt;</span></span>
<span id="cb1070-2"><a href="arima-models.html#cb1070-2" tabindex="-1"></a>  <span class="fu">features</span>(.innov, ljung_box, <span class="at">lag =</span> <span class="dv">16</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .model      lb_stat lb_pvalue
##   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;
## 1 ETS(Cement)    10.0     0.865</code></pre>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1072-1"><a href="arima-models.html#cb1072-1" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb1072-2"><a href="arima-models.html#cb1072-2" tabindex="-1"></a>    fit_arima <span class="sc">|&gt;</span> <span class="fu">accuracy</span>(),</span>
<span id="cb1072-3"><a href="arima-models.html#cb1072-3" tabindex="-1"></a>    fit_ets <span class="sc">|&gt;</span> <span class="fu">accuracy</span>(),</span>
<span id="cb1072-4"><a href="arima-models.html#cb1072-4" tabindex="-1"></a>    fit_arima <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">accuracy</span>(cement),</span>
<span id="cb1072-5"><a href="arima-models.html#cb1072-5" tabindex="-1"></a>    fit_ets <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">accuracy</span>(cement)</span>
<span id="cb1072-6"><a href="arima-models.html#cb1072-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb1072-7"><a href="arima-models.html#cb1072-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ME, <span class="sc">-</span>MPE, <span class="sc">-</span>ACF1)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 7
##   .model        .type     RMSE   MAE  MAPE  MASE RMSSE
##   &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 ARIMA(Cement) Training  100.  79.9  4.37 0.546 0.582
## 2 ETS(Cement)   Training  103.  80.0  4.41 0.547 0.596
## 3 ARIMA(Cement) Test      216. 186.   8.68 1.27  1.26 
## 4 ETS(Cement)   Test      222. 191.   8.85 1.30  1.29</code></pre>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="arima-models.html#cb1074-1" tabindex="-1"></a>cement <span class="sc">|&gt;</span></span>
<span id="cb1074-2"><a href="arima-models.html#cb1074-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Cement)) <span class="sc">|&gt;</span></span>
<span id="cb1074-3"><a href="arima-models.html#cb1074-3" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="st">&quot;3 years&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1074-4"><a href="arima-models.html#cb1074-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(cement) <span class="sc">+</span></span>
<span id="cb1074-5"><a href="arima-models.html#cb1074-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cement production in Australia&quot;</span>,</span>
<span id="cb1074-6"><a href="arima-models.html#cb1074-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Tonnes (&#39;000)&quot;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-61-1.png" width="672" /></p>
</div>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="9.11">
<h2><span class="header-section-number">9.11</span> Exercises<a href="arima-models.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1075-1"><a href="arima-models.html#cb1075-1" tabindex="-1"></a>gafa_stock <span class="sc">|&gt;</span></span>
<span id="cb1075-2"><a href="arima-models.html#cb1075-2" tabindex="-1"></a>  <span class="fu">filter</span>(Symbol <span class="sc">==</span> <span class="st">&#39;AMZN&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1075-3"><a href="arima-models.html#cb1075-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Close, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Provided data has an irregular interval, results should be treated with caution. Computing ACF by observation.
## Provided data has an irregular interval, results should be treated with caution. Computing ACF by observation.</code></pre>
<p><img src="figure_html/ch09-ts-arima-62-1.png" width="672" /></p>
<ul>
<li>ACF: Slowly decaying or very high values for initial lags.</li>
<li>PACF: Large spike at lag 1, followed by small or zero values at higher lags.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1077-1"><a href="arima-models.html#cb1077-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb1077-2"><a href="arima-models.html#cb1077-2" tabindex="-1"></a></span>
<span id="cb1077-3"><a href="arima-models.html#cb1077-3" tabindex="-1"></a>turk <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb1077-4"><a href="arima-models.html#cb1077-4" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;TUR&#39;</span>)</span>
<span id="cb1077-5"><a href="arima-models.html#cb1077-5" tabindex="-1"></a></span>
<span id="cb1077-6"><a href="arima-models.html#cb1077-6" tabindex="-1"></a>turk <span class="sc">|&gt;</span></span>
<span id="cb1077-7"><a href="arima-models.html#cb1077-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(GDP) <span class="sc">+</span></span>
<span id="cb1077-8"><a href="arima-models.html#cb1077-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Turkish GDP&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-63-1.png" width="672" /></p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="arima-models.html#cb1078-1" tabindex="-1"></a><span class="co"># get to know the stationarity</span></span>
<span id="cb1078-2"><a href="arima-models.html#cb1078-2" tabindex="-1"></a>turk <span class="sc">%&gt;%</span> </span>
<span id="cb1078-3"><a href="arima-models.html#cb1078-3" tabindex="-1"></a>  <span class="fu">features</span>(GDP, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Country kpss_stat kpss_pvalue
##   &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 Turkey       1.22        0.01</code></pre>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="arima-models.html#cb1080-1" tabindex="-1"></a><span class="co"># =&gt; H0 is rejected - the data are non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1081-1"><a href="arima-models.html#cb1081-1" tabindex="-1"></a><span class="co"># find optimal lambda for box cox transformation</span></span>
<span id="cb1081-2"><a href="arima-models.html#cb1081-2" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> turk <span class="sc">%&gt;%</span> </span>
<span id="cb1081-3"><a href="arima-models.html#cb1081-3" tabindex="-1"></a>  <span class="fu">features</span>(GDP, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1081-4"><a href="arima-models.html#cb1081-4" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1081-5"><a href="arima-models.html#cb1081-5" tabindex="-1"></a></span>
<span id="cb1081-6"><a href="arima-models.html#cb1081-6" tabindex="-1"></a><span class="co"># stabilize the variance </span></span>
<span id="cb1081-7"><a href="arima-models.html#cb1081-7" tabindex="-1"></a>turk <span class="ot">&lt;-</span> turk <span class="sc">|&gt;</span></span>
<span id="cb1081-8"><a href="arima-models.html#cb1081-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">transformed_GDP =</span> <span class="fu">box_cox</span>(GDP, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1081-9"><a href="arima-models.html#cb1081-9" tabindex="-1"></a></span>
<span id="cb1081-10"><a href="arima-models.html#cb1081-10" tabindex="-1"></a><span class="co"># get to know the order of differencing of the transformed (stable variance) data</span></span>
<span id="cb1081-11"><a href="arima-models.html#cb1081-11" tabindex="-1"></a>turk <span class="sc">%&gt;%</span> </span>
<span id="cb1081-12"><a href="arima-models.html#cb1081-12" tabindex="-1"></a>  <span class="fu">features</span>(transformed_GDP, <span class="at">features =</span> unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   Country ndiffs
##   &lt;fct&gt;    &lt;int&gt;
## 1 Turkey       1</code></pre>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="arima-models.html#cb1083-1" tabindex="-1"></a><span class="co"># diff the transformed data</span></span>
<span id="cb1083-2"><a href="arima-models.html#cb1083-2" tabindex="-1"></a>turk <span class="ot">&lt;-</span> turk <span class="sc">|&gt;</span></span>
<span id="cb1083-3"><a href="arima-models.html#cb1083-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_GDP =</span> <span class="fu">difference</span>(transformed_GDP))</span>
<span id="cb1083-4"><a href="arima-models.html#cb1083-4" tabindex="-1"></a></span>
<span id="cb1083-5"><a href="arima-models.html#cb1083-5" tabindex="-1"></a><span class="co"># get to know the stationarity of the differenced transformed data</span></span>
<span id="cb1083-6"><a href="arima-models.html#cb1083-6" tabindex="-1"></a>turk <span class="sc">|&gt;</span></span>
<span id="cb1083-7"><a href="arima-models.html#cb1083-7" tabindex="-1"></a>  <span class="fu">features</span>(diff_GDP, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Country kpss_stat kpss_pvalue
##   &lt;fct&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1 Turkey     0.0889         0.1</code></pre>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="arima-models.html#cb1085-1" tabindex="-1"></a><span class="co"># =&gt; the data is now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="arima-models.html#cb1086-1" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb1086-2"><a href="arima-models.html#cb1086-2" tabindex="-1"></a></span>
<span id="cb1086-3"><a href="arima-models.html#cb1086-3" tabindex="-1"></a>turk <span class="sc">|&gt;</span></span>
<span id="cb1086-4"><a href="arima-models.html#cb1086-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&#39;GDP&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1086-5"><a href="arima-models.html#cb1086-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">GDP (Box-Cox)</span><span class="st">`</span> <span class="ot">=</span> transformed_GDP, <span class="st">`</span><span class="at">GDP (Differenced)</span><span class="st">`</span> <span class="ot">=</span> diff_GDP) <span class="sc">|&gt;</span></span>
<span id="cb1086-6"><a href="arima-models.html#cb1086-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&#39;GDP&#39;</span>), <span class="at">names_to =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1086-7"><a href="arima-models.html#cb1086-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1086-8"><a href="arima-models.html#cb1086-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-67-1.png" width="672" /></p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="arima-models.html#cb1088-1" tabindex="-1"></a>turk <span class="sc">|&gt;</span></span>
<span id="cb1088-2"><a href="arima-models.html#cb1088-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&#39;GDP&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1088-3"><a href="arima-models.html#cb1088-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">GDP (Box-Cox)</span><span class="st">`</span> <span class="ot">=</span> transformed_GDP, <span class="st">`</span><span class="at">GDP (Differenced)</span><span class="st">`</span> <span class="ot">=</span> diff_GDP) <span class="sc">|&gt;</span></span>
<span id="cb1088-4"><a href="arima-models.html#cb1088-4" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="st">`</span><span class="at">GDP (Differenced)</span><span class="st">`</span>, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-68-1.png" width="672" /></p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="arima-models.html#cb1091-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1091-2"><a href="arima-models.html#cb1091-2" tabindex="-1"></a></span>
<span id="cb1091-3"><a href="arima-models.html#cb1091-3" tabindex="-1"></a>tas <span class="ot">&lt;-</span> aus_accommodation <span class="sc">|&gt;</span></span>
<span id="cb1091-4"><a href="arima-models.html#cb1091-4" tabindex="-1"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">&#39;Tasmania&#39;</span>)</span>
<span id="cb1091-5"><a href="arima-models.html#cb1091-5" tabindex="-1"></a></span>
<span id="cb1091-6"><a href="arima-models.html#cb1091-6" tabindex="-1"></a>tas <span class="sc">|&gt;</span></span>
<span id="cb1091-7"><a href="arima-models.html#cb1091-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(Takings) <span class="sc">+</span></span>
<span id="cb1091-8"><a href="arima-models.html#cb1091-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Accommodation takings in the state of Tasmania&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="arima-models.html#cb1092-1" tabindex="-1"></a><span class="co"># the data have  strong seasonality and variable variance</span></span>
<span id="cb1092-2"><a href="arima-models.html#cb1092-2" tabindex="-1"></a></span>
<span id="cb1092-3"><a href="arima-models.html#cb1092-3" tabindex="-1"></a><span class="co"># 1. Stable the variance by Box-Cox transformation</span></span>
<span id="cb1092-4"><a href="arima-models.html#cb1092-4" tabindex="-1"></a><span class="co">#    1.1. Find optimal lambda for box cox transformation</span></span>
<span id="cb1092-5"><a href="arima-models.html#cb1092-5" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> tas <span class="sc">%&gt;%</span> </span>
<span id="cb1092-6"><a href="arima-models.html#cb1092-6" tabindex="-1"></a>  <span class="fu">features</span>(Takings, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1092-7"><a href="arima-models.html#cb1092-7" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1092-8"><a href="arima-models.html#cb1092-8" tabindex="-1"></a></span>
<span id="cb1092-9"><a href="arima-models.html#cb1092-9" tabindex="-1"></a><span class="co">#    1.2. Stabilize the variance </span></span>
<span id="cb1092-10"><a href="arima-models.html#cb1092-10" tabindex="-1"></a>tas <span class="ot">&lt;-</span> tas <span class="sc">|&gt;</span></span>
<span id="cb1092-11"><a href="arima-models.html#cb1092-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Takings (Box-Cox)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">box_cox</span>(Takings, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1092-12"><a href="arima-models.html#cb1092-12" tabindex="-1"></a></span>
<span id="cb1092-13"><a href="arima-models.html#cb1092-13" tabindex="-1"></a></span>
<span id="cb1092-14"><a href="arima-models.html#cb1092-14" tabindex="-1"></a><span class="co"># 2. Get to know the order of seasonal and first differencing is it&#39;s needed</span></span>
<span id="cb1092-15"><a href="arima-models.html#cb1092-15" tabindex="-1"></a><span class="co">#   2.1. Get to know the order of seasonal defferencing</span></span>
<span id="cb1092-16"><a href="arima-models.html#cb1092-16" tabindex="-1"></a>tas <span class="sc">|&gt;</span> </span>
<span id="cb1092-17"><a href="arima-models.html#cb1092-17" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Takings (Box-Cox)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   State    nsdiffs
##   &lt;chr&gt;      &lt;int&gt;
## 1 Tasmania       1</code></pre>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="arima-models.html#cb1094-1" tabindex="-1"></a><span class="co">#   2.2 Make seasonal differencing</span></span>
<span id="cb1094-2"><a href="arima-models.html#cb1094-2" tabindex="-1"></a>tas <span class="ot">&lt;-</span> tas <span class="sc">|&gt;</span></span>
<span id="cb1094-3"><a href="arima-models.html#cb1094-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Takings (sdiff)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Takings (Box-Cox)</span><span class="st">`</span>, <span class="at">lag =</span> <span class="dv">4</span>))</span>
<span id="cb1094-4"><a href="arima-models.html#cb1094-4" tabindex="-1"></a><span class="co">#   2.3. Get to know the order of first differencing of seasonal differenced transformed data</span></span>
<span id="cb1094-5"><a href="arima-models.html#cb1094-5" tabindex="-1"></a>tas <span class="sc">|&gt;</span> </span>
<span id="cb1094-6"><a href="arima-models.html#cb1094-6" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Takings (sdiff)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   State    ndiffs
##   &lt;chr&gt;     &lt;int&gt;
## 1 Tasmania      0</code></pre>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1096-1"><a href="arima-models.html#cb1096-1" tabindex="-1"></a><span class="co"># =&gt; the first differencing is not needed</span></span></code></pre></div>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="arima-models.html#cb1097-1" tabindex="-1"></a><span class="co"># 3. Get to know the stationarity of the seasonal differenced transformed data</span></span>
<span id="cb1097-2"><a href="arima-models.html#cb1097-2" tabindex="-1"></a>tas <span class="sc">|&gt;</span></span>
<span id="cb1097-3"><a href="arima-models.html#cb1097-3" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Takings (sdiff)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   State    kpss_stat kpss_pvalue
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 Tasmania     0.198         0.1</code></pre>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1099-1"><a href="arima-models.html#cb1099-1" tabindex="-1"></a><span class="co"># =&gt; the data is now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="arima-models.html#cb1100-1" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb1100-2"><a href="arima-models.html#cb1100-2" tabindex="-1"></a></span>
<span id="cb1100-3"><a href="arima-models.html#cb1100-3" tabindex="-1"></a>tas <span class="sc">|&gt;</span></span>
<span id="cb1100-4"><a href="arima-models.html#cb1100-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&#39;Takings&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1100-5"><a href="arima-models.html#cb1100-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Takings (Differenced)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Takings (sdiff)</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb1100-6"><a href="arima-models.html#cb1100-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&#39;Takings&#39;</span>), <span class="at">names_to =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1100-7"><a href="arima-models.html#cb1100-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1100-8"><a href="arima-models.html#cb1100-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1102-1"><a href="arima-models.html#cb1102-1" tabindex="-1"></a>tas <span class="sc">|&gt;</span></span>
<span id="cb1102-2"><a href="arima-models.html#cb1102-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&#39;Takings&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1102-3"><a href="arima-models.html#cb1102-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Takings (Differenced)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Takings (sdiff)</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb1102-4"><a href="arima-models.html#cb1102-4" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="st">`</span><span class="at">Takings (Differenced)</span><span class="st">`</span>, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-74-1.png" width="672" /></p>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1105-1"><a href="arima-models.html#cb1105-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1105-2"><a href="arima-models.html#cb1105-2" tabindex="-1"></a></span>
<span id="cb1105-3"><a href="arima-models.html#cb1105-3" tabindex="-1"></a>souvenirs <span class="sc">|&gt;</span></span>
<span id="cb1105-4"><a href="arima-models.html#cb1105-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(Sales) <span class="sc">+</span></span>
<span id="cb1105-5"><a href="arima-models.html#cb1105-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Monthly sales in Queensland, Australia&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1106-1"><a href="arima-models.html#cb1106-1" tabindex="-1"></a>souvenirs <span class="sc">|&gt;</span></span>
<span id="cb1106-2"><a href="arima-models.html#cb1106-2" tabindex="-1"></a>  <span class="fu">features</span>(Sales, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1      1.31        0.01</code></pre>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1108-1"><a href="arima-models.html#cb1108-1" tabindex="-1"></a><span class="co"># =&gt; the data is non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1109-1"><a href="arima-models.html#cb1109-1" tabindex="-1"></a><span class="co"># the data have strong seasonality and variable variance</span></span>
<span id="cb1109-2"><a href="arima-models.html#cb1109-2" tabindex="-1"></a></span>
<span id="cb1109-3"><a href="arima-models.html#cb1109-3" tabindex="-1"></a><span class="co"># 1. Stable the variance by Box-Cox transformation</span></span>
<span id="cb1109-4"><a href="arima-models.html#cb1109-4" tabindex="-1"></a><span class="co">#    1.1. Find optimal lambda for box cox transformation</span></span>
<span id="cb1109-5"><a href="arima-models.html#cb1109-5" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> souvenirs <span class="sc">%&gt;%</span> </span>
<span id="cb1109-6"><a href="arima-models.html#cb1109-6" tabindex="-1"></a>  <span class="fu">features</span>(Sales, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1109-7"><a href="arima-models.html#cb1109-7" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1109-8"><a href="arima-models.html#cb1109-8" tabindex="-1"></a></span>
<span id="cb1109-9"><a href="arima-models.html#cb1109-9" tabindex="-1"></a><span class="co">#    1.2. Stabilize the variance </span></span>
<span id="cb1109-10"><a href="arima-models.html#cb1109-10" tabindex="-1"></a>souvenirs_2 <span class="ot">&lt;-</span> souvenirs <span class="sc">|&gt;</span></span>
<span id="cb1109-11"><a href="arima-models.html#cb1109-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Sales (Box-Cox)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">box_cox</span>(Sales, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1109-12"><a href="arima-models.html#cb1109-12" tabindex="-1"></a></span>
<span id="cb1109-13"><a href="arima-models.html#cb1109-13" tabindex="-1"></a></span>
<span id="cb1109-14"><a href="arima-models.html#cb1109-14" tabindex="-1"></a><span class="co"># 2. Get to know the order of seasonal and first differencing is it&#39;s needed</span></span>
<span id="cb1109-15"><a href="arima-models.html#cb1109-15" tabindex="-1"></a><span class="co">#   2.1. Get to know the order of seasonal defferencing</span></span>
<span id="cb1109-16"><a href="arima-models.html#cb1109-16" tabindex="-1"></a>souvenirs_2 <span class="sc">|&gt;</span> </span>
<span id="cb1109-17"><a href="arima-models.html#cb1109-17" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Sales (Box-Cox)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   nsdiffs
##     &lt;int&gt;
## 1       1</code></pre>
<div class="sourceCode" id="cb1111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1111-1"><a href="arima-models.html#cb1111-1" tabindex="-1"></a><span class="co">#   2.2 Make seasonal differencing</span></span>
<span id="cb1111-2"><a href="arima-models.html#cb1111-2" tabindex="-1"></a>souvenirs_2 <span class="ot">&lt;-</span> souvenirs_2 <span class="sc">|&gt;</span></span>
<span id="cb1111-3"><a href="arima-models.html#cb1111-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Sales (sdiff)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Sales (Box-Cox)</span><span class="st">`</span>, <span class="at">lag =</span> <span class="dv">12</span>))</span>
<span id="cb1111-4"><a href="arima-models.html#cb1111-4" tabindex="-1"></a><span class="co">#   2.3. Get to know the order of first differencing of seasonal differenced transformed data</span></span>
<span id="cb1111-5"><a href="arima-models.html#cb1111-5" tabindex="-1"></a>souvenirs_2 <span class="sc">|&gt;</span> </span>
<span id="cb1111-6"><a href="arima-models.html#cb1111-6" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Sales (sdiff)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   ndiffs
##    &lt;int&gt;
## 1      0</code></pre>
<div class="sourceCode" id="cb1113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1113-1"><a href="arima-models.html#cb1113-1" tabindex="-1"></a><span class="co"># =&gt; the first differencing is not needed</span></span></code></pre></div>
<div class="sourceCode" id="cb1114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1114-1"><a href="arima-models.html#cb1114-1" tabindex="-1"></a><span class="co"># 3. Get to know the stationarity of the seasonal differenced transformed data</span></span>
<span id="cb1114-2"><a href="arima-models.html#cb1114-2" tabindex="-1"></a>souvenirs_2 <span class="sc">|&gt;</span></span>
<span id="cb1114-3"><a href="arima-models.html#cb1114-3" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Sales (sdiff)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1     0.240         0.1</code></pre>
<div class="sourceCode" id="cb1116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1116-1"><a href="arima-models.html#cb1116-1" tabindex="-1"></a><span class="co"># =&gt; the data is now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1117-1"><a href="arima-models.html#cb1117-1" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb1117-2"><a href="arima-models.html#cb1117-2" tabindex="-1"></a></span>
<span id="cb1117-3"><a href="arima-models.html#cb1117-3" tabindex="-1"></a>souvenirs_2 <span class="sc">|&gt;</span></span>
<span id="cb1117-4"><a href="arima-models.html#cb1117-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Sales (Differenced)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Sales (sdiff)</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb1117-5"><a href="arima-models.html#cb1117-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">&#39;Sales&#39;</span>), <span class="at">names_to =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1117-6"><a href="arima-models.html#cb1117-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1117-7"><a href="arima-models.html#cb1117-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-80-1.png" width="672" /></p>
<div class="sourceCode" id="cb1119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1119-1"><a href="arima-models.html#cb1119-1" tabindex="-1"></a>souvenirs_2 <span class="sc">|&gt;</span></span>
<span id="cb1119-2"><a href="arima-models.html#cb1119-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&#39;Sales&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1119-3"><a href="arima-models.html#cb1119-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Sales (Differenced)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Sales (sdiff)</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb1119-4"><a href="arima-models.html#cb1119-4" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="st">`</span><span class="at">Sales (Differenced)</span><span class="st">`</span>, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-81-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1122-1"><a href="arima-models.html#cb1122-1" tabindex="-1"></a>myseries <span class="ot">&lt;-</span> myseries <span class="sc">|&gt;</span></span>
<span id="cb1122-2"><a href="arima-models.html#cb1122-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>State, <span class="sc">-</span>Industry, <span class="sc">-</span><span class="st">`</span><span class="at">Series ID</span><span class="st">`</span>)</span>
<span id="cb1122-3"><a href="arima-models.html#cb1122-3" tabindex="-1"></a></span>
<span id="cb1122-4"><a href="arima-models.html#cb1122-4" tabindex="-1"></a><span class="co"># 1. Plot the data</span></span>
<span id="cb1122-5"><a href="arima-models.html#cb1122-5" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb1122-6"><a href="arima-models.html#cb1122-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(Turnover)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-82-1.png" width="672" /></p>
<div class="sourceCode" id="cb1123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1123-1"><a href="arima-models.html#cb1123-1" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb1123-2"><a href="arima-models.html#cb1123-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Turnover, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-83-1.png" width="672" /></p>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1124-1"><a href="arima-models.html#cb1124-1" tabindex="-1"></a><span class="co"># =&gt; monthly data have strong seasonality and unstable variance</span></span></code></pre></div>
<div class="sourceCode" id="cb1125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1125-1"><a href="arima-models.html#cb1125-1" tabindex="-1"></a><span class="co"># 2. Get to know the stationarity</span></span>
<span id="cb1125-2"><a href="arima-models.html#cb1125-2" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb1125-3"><a href="arima-models.html#cb1125-3" tabindex="-1"></a>  <span class="fu">features</span>(Turnover, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1      7.20        0.01</code></pre>
<div class="sourceCode" id="cb1127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1127-1"><a href="arima-models.html#cb1127-1" tabindex="-1"></a><span class="co"># =&gt; H0  is rejected, the data is non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1128-1"><a href="arima-models.html#cb1128-1" tabindex="-1"></a><span class="co"># the data have strong seasonality and variable variance</span></span>
<span id="cb1128-2"><a href="arima-models.html#cb1128-2" tabindex="-1"></a></span>
<span id="cb1128-3"><a href="arima-models.html#cb1128-3" tabindex="-1"></a><span class="co"># 3. Stable the variance by Box-Cox transformation</span></span>
<span id="cb1128-4"><a href="arima-models.html#cb1128-4" tabindex="-1"></a><span class="co">#    3.1. Find optimal lambda for box cox transformation</span></span>
<span id="cb1128-5"><a href="arima-models.html#cb1128-5" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> myseries <span class="sc">%&gt;%</span> </span>
<span id="cb1128-6"><a href="arima-models.html#cb1128-6" tabindex="-1"></a>  <span class="fu">features</span>(Turnover, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1128-7"><a href="arima-models.html#cb1128-7" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1128-8"><a href="arima-models.html#cb1128-8" tabindex="-1"></a></span>
<span id="cb1128-9"><a href="arima-models.html#cb1128-9" tabindex="-1"></a><span class="co">#    3.2. Stabilize the variance </span></span>
<span id="cb1128-10"><a href="arima-models.html#cb1128-10" tabindex="-1"></a>myseries <span class="ot">&lt;-</span> myseries <span class="sc">|&gt;</span></span>
<span id="cb1128-11"><a href="arima-models.html#cb1128-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Turnover (Box-Cox)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">box_cox</span>(Turnover, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1128-12"><a href="arima-models.html#cb1128-12" tabindex="-1"></a></span>
<span id="cb1128-13"><a href="arima-models.html#cb1128-13" tabindex="-1"></a></span>
<span id="cb1128-14"><a href="arima-models.html#cb1128-14" tabindex="-1"></a><span class="co"># 4. Get to know the order of seasonal and first differencing is it&#39;s needed</span></span>
<span id="cb1128-15"><a href="arima-models.html#cb1128-15" tabindex="-1"></a><span class="co">#   4.1. Get to know the order of seasonal defferencing</span></span>
<span id="cb1128-16"><a href="arima-models.html#cb1128-16" tabindex="-1"></a>myseries <span class="sc">|&gt;</span> </span>
<span id="cb1128-17"><a href="arima-models.html#cb1128-17" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Turnover (Box-Cox)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   nsdiffs
##     &lt;int&gt;
## 1       1</code></pre>
<div class="sourceCode" id="cb1130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1130-1"><a href="arima-models.html#cb1130-1" tabindex="-1"></a><span class="co">#   4.2 Make seasonal differencing</span></span>
<span id="cb1130-2"><a href="arima-models.html#cb1130-2" tabindex="-1"></a>myseries <span class="ot">&lt;-</span> myseries <span class="sc">|&gt;</span></span>
<span id="cb1130-3"><a href="arima-models.html#cb1130-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Turnover (Seasonal Difference)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Turnover (Box-Cox)</span><span class="st">`</span>, <span class="at">lag =</span> <span class="dv">12</span>))</span>
<span id="cb1130-4"><a href="arima-models.html#cb1130-4" tabindex="-1"></a><span class="co">#   4.3. Get to know the order of first differencing of seasonal differenced transformed data</span></span>
<span id="cb1130-5"><a href="arima-models.html#cb1130-5" tabindex="-1"></a>myseries <span class="sc">|&gt;</span> </span>
<span id="cb1130-6"><a href="arima-models.html#cb1130-6" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Turnover (Seasonal Difference)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   ndiffs
##    &lt;int&gt;
## 1      0</code></pre>
<div class="sourceCode" id="cb1132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1132-1"><a href="arima-models.html#cb1132-1" tabindex="-1"></a><span class="co"># =&gt; the first differencing is needed</span></span></code></pre></div>
<div class="sourceCode" id="cb1133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1133-1"><a href="arima-models.html#cb1133-1" tabindex="-1"></a><span class="co">#   4.4. Make first differencing</span></span>
<span id="cb1133-2"><a href="arima-models.html#cb1133-2" tabindex="-1"></a>myseries <span class="ot">&lt;-</span> myseries <span class="sc">|&gt;</span></span>
<span id="cb1133-3"><a href="arima-models.html#cb1133-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Turnover (First Difference)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">difference</span>(<span class="st">`</span><span class="at">Turnover (Seasonal Difference)</span><span class="st">`</span>))</span>
<span id="cb1133-4"><a href="arima-models.html#cb1133-4" tabindex="-1"></a></span>
<span id="cb1133-5"><a href="arima-models.html#cb1133-5" tabindex="-1"></a><span class="co">#   4.5. Get to know the stationarity of the first differenced of the seasonal differenced transformed data</span></span>
<span id="cb1133-6"><a href="arima-models.html#cb1133-6" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb1133-7"><a href="arima-models.html#cb1133-7" tabindex="-1"></a>  <span class="fu">features</span>(<span class="st">`</span><span class="at">Turnover (First Difference)</span><span class="st">`</span>, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   kpss_stat kpss_pvalue
##       &lt;dbl&gt;       &lt;dbl&gt;
## 1    0.0140         0.1</code></pre>
<div class="sourceCode" id="cb1135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1135-1"><a href="arima-models.html#cb1135-1" tabindex="-1"></a><span class="co"># =&gt; the data is now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1136-1"><a href="arima-models.html#cb1136-1" tabindex="-1"></a><span class="co"># plot the data</span></span>
<span id="cb1136-2"><a href="arima-models.html#cb1136-2" tabindex="-1"></a></span>
<span id="cb1136-3"><a href="arima-models.html#cb1136-3" tabindex="-1"></a>myseries <span class="sc">|&gt;</span></span>
<span id="cb1136-4"><a href="arima-models.html#cb1136-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1. Raw data</span><span class="st">`</span> <span class="ot">=</span> Turnover,</span>
<span id="cb1136-5"><a href="arima-models.html#cb1136-5" tabindex="-1"></a>         <span class="st">`</span><span class="at">2. Box-Cox</span><span class="st">`</span>  <span class="ot">=</span> <span class="st">`</span><span class="at">Turnover (Box-Cox)</span><span class="st">`</span>,</span>
<span id="cb1136-6"><a href="arima-models.html#cb1136-6" tabindex="-1"></a>         <span class="st">`</span><span class="at">3. Seasonal diff</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Turnover (Seasonal Difference)</span><span class="st">`</span>,</span>
<span id="cb1136-7"><a href="arima-models.html#cb1136-7" tabindex="-1"></a>         <span class="st">`</span><span class="at">4. First diff</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Turnover (First Difference)</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb1136-8"><a href="arima-models.html#cb1136-8" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Month, <span class="at">names_to =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1136-9"><a href="arima-models.html#cb1136-9" tabindex="-1"></a>  <span class="fu">autoplot</span>(value) <span class="sc">+</span></span>
<span id="cb1136-10"><a href="arima-models.html#cb1136-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(name) <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 25 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-88-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="arima-models.html#cb1138-1" tabindex="-1"></a><span class="co">#a.</span></span>
<span id="cb1138-2"><a href="arima-models.html#cb1138-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb1138-3"><a href="arima-models.html#cb1138-3" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1138-4"><a href="arima-models.html#cb1138-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1138-5"><a href="arima-models.html#cb1138-5" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fl">0.6</span><span class="sc">*</span>y[i<span class="dv">-1</span>] <span class="sc">+</span> e[i]</span>
<span id="cb1138-6"><a href="arima-models.html#cb1138-6" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">idx =</span> <span class="fu">seq_len</span>(<span class="dv">100</span>), <span class="at">y =</span> y, <span class="at">index =</span> idx)</span></code></pre></div>
<div class="sourceCode" id="cb1139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1139-1"><a href="arima-models.html#cb1139-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1139-2"><a href="arima-models.html#cb1139-2" tabindex="-1"></a>sim <span class="sc">|&gt;</span></span>
<span id="cb1139-3"><a href="arima-models.html#cb1139-3" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-90-1.png" width="672" /></p>
<div class="sourceCode" id="cb1140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1140-1"><a href="arima-models.html#cb1140-1" tabindex="-1"></a><span class="co"># c. </span></span>
<span id="cb1140-2"><a href="arima-models.html#cb1140-2" tabindex="-1"></a><span class="fu">tsibble</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">y =</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">ma=</span><span class="fl">0.6</span>), <span class="at">n =</span> <span class="dv">100</span>),</span>
<span id="cb1140-3"><a href="arima-models.html#cb1140-3" tabindex="-1"></a>        <span class="at">index =</span> n) <span class="sc">|&gt;</span></span>
<span id="cb1140-4"><a href="arima-models.html#cb1140-4" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb1140-5"><a href="arima-models.html#cb1140-5" tabindex="-1"></a>    <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-91-1.png" width="672" /></p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="arima-models.html#cb1141-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1141-2"><a href="arima-models.html#cb1141-2" tabindex="-1"></a><span class="co"># MA(1) from scratch</span></span>
<span id="cb1141-3"><a href="arima-models.html#cb1141-3" tabindex="-1"></a></span>
<span id="cb1141-4"><a href="arima-models.html#cb1141-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb1141-5"><a href="arima-models.html#cb1141-5" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1141-6"><a href="arima-models.html#cb1141-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1141-7"><a href="arima-models.html#cb1141-7" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> e[i] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span>e[i<span class="dv">-1</span>] </span>
<span id="cb1141-8"><a href="arima-models.html#cb1141-8" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">idx =</span> <span class="fu">seq_len</span>(<span class="dv">100</span>), <span class="at">y =</span> y, <span class="at">index =</span> idx)</span>
<span id="cb1141-9"><a href="arima-models.html#cb1141-9" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb1141-10"><a href="arima-models.html#cb1141-10" tabindex="-1"></a>sim <span class="sc">|&gt;</span></span>
<span id="cb1141-11"><a href="arima-models.html#cb1141-11" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-92-1.png" width="672" /></p>
<div class="sourceCode" id="cb1142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1142-1"><a href="arima-models.html#cb1142-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1142-2"><a href="arima-models.html#cb1142-2" tabindex="-1"></a></span>
<span id="cb1142-3"><a href="arima-models.html#cb1142-3" tabindex="-1"></a><span class="co"># e. </span></span>
<span id="cb1142-4"><a href="arima-models.html#cb1142-4" tabindex="-1"></a><span class="fu">tsibble</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">y =</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar=</span><span class="fl">0.6</span> , <span class="at">ma=</span><span class="fl">0.6</span>), <span class="at">n =</span> <span class="dv">100</span>),</span>
<span id="cb1142-5"><a href="arima-models.html#cb1142-5" tabindex="-1"></a>        <span class="at">index =</span> n) <span class="sc">|&gt;</span></span>
<span id="cb1142-6"><a href="arima-models.html#cb1142-6" tabindex="-1"></a>    <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-93-1.png" width="672" /></p>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="arima-models.html#cb1143-1" tabindex="-1"></a><span class="co"># from scratch</span></span>
<span id="cb1143-2"><a href="arima-models.html#cb1143-2" tabindex="-1"></a></span>
<span id="cb1143-3"><a href="arima-models.html#cb1143-3" tabindex="-1"></a><span class="co"># ARMA(1, 1) from scratch</span></span>
<span id="cb1143-4"><a href="arima-models.html#cb1143-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1143-5"><a href="arima-models.html#cb1143-5" tabindex="-1"></a></span>
<span id="cb1143-6"><a href="arima-models.html#cb1143-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb1143-7"><a href="arima-models.html#cb1143-7" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1143-8"><a href="arima-models.html#cb1143-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1143-9"><a href="arima-models.html#cb1143-9" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fl">0.6</span><span class="sc">*</span>y[i<span class="dv">-1</span>] <span class="sc">+</span> e[i] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span>e[i<span class="dv">-1</span>] </span>
<span id="cb1143-10"><a href="arima-models.html#cb1143-10" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">idx =</span> <span class="fu">seq_len</span>(<span class="dv">100</span>), <span class="at">y =</span> y, <span class="at">index =</span> idx)</span>
<span id="cb1143-11"><a href="arima-models.html#cb1143-11" tabindex="-1"></a></span>
<span id="cb1143-12"><a href="arima-models.html#cb1143-12" tabindex="-1"></a>sim <span class="sc">|&gt;</span></span>
<span id="cb1143-13"><a href="arima-models.html#cb1143-13" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb1144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1144-1"><a href="arima-models.html#cb1144-1" tabindex="-1"></a><span class="co"># f.</span></span>
<span id="cb1144-2"><a href="arima-models.html#cb1144-2" tabindex="-1"></a><span class="co"># AR(2) from scratch</span></span>
<span id="cb1144-3"><a href="arima-models.html#cb1144-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1144-4"><a href="arima-models.html#cb1144-4" tabindex="-1"></a></span>
<span id="cb1144-5"><a href="arima-models.html#cb1144-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb1144-6"><a href="arima-models.html#cb1144-6" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1144-7"><a href="arima-models.html#cb1144-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1144-8"><a href="arima-models.html#cb1144-8" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="fl">0.8</span>)<span class="sc">*</span>y[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>y[i<span class="dv">-2</span>] <span class="sc">+</span> e[i]</span>
<span id="cb1144-9"><a href="arima-models.html#cb1144-9" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">tsibble</span>(<span class="at">idx =</span> <span class="fu">seq_len</span>(<span class="dv">100</span>), <span class="at">y =</span> y, <span class="at">index =</span> idx)</span>
<span id="cb1144-10"><a href="arima-models.html#cb1144-10" tabindex="-1"></a></span>
<span id="cb1144-11"><a href="arima-models.html#cb1144-11" tabindex="-1"></a><span class="co">#g.</span></span>
<span id="cb1144-12"><a href="arima-models.html#cb1144-12" tabindex="-1"></a>sim <span class="sc">|&gt;</span></span>
<span id="cb1144-13"><a href="arima-models.html#cb1144-13" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(y, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-95-1.png" width="672" /></p>
<ol start="7" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="arima-models.html#cb1145-1" tabindex="-1"></a>train <span class="ot">&lt;-</span> aus_airpassengers <span class="sc">|&gt;</span></span>
<span id="cb1145-2"><a href="arima-models.html#cb1145-2" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&lt;</span> <span class="dv">2012</span>)</span>
<span id="cb1145-3"><a href="arima-models.html#cb1145-3" tabindex="-1"></a></span>
<span id="cb1145-4"><a href="arima-models.html#cb1145-4" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb1145-5"><a href="arima-models.html#cb1145-5" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb1145-6"><a href="arima-models.html#cb1145-6" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Passengers, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1145-7"><a href="arima-models.html#cb1145-7" tabindex="-1"></a>  <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Passengers 
## Model: ARIMA(0,2,1) 
## 
## Coefficients:
##           ma1
##       -0.8756
## s.e.   0.0722
## 
## sigma^2 estimated as 4.671:  log likelihood=-87.8
## AIC=179.61   AICc=179.93   BIC=182.99</code></pre>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="arima-models.html#cb1147-1" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb1147-2"><a href="arima-models.html#cb1147-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Passengers, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1147-3"><a href="arima-models.html#cb1147-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-97-1.png" width="672" /></p>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="arima-models.html#cb1148-1" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb1148-2"><a href="arima-models.html#cb1148-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">ARIMA</span>(Passengers, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1148-3"><a href="arima-models.html#cb1148-3" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1148-4"><a href="arima-models.html#cb1148-4" tabindex="-1"></a>  <span class="fu">autoplot</span>(train)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-98-1.png" width="672" /></p>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1149-1"><a href="arima-models.html#cb1149-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1149-2"><a href="arima-models.html#cb1149-2" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb1149-3"><a href="arima-models.html#cb1149-3" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1149-4"><a href="arima-models.html#cb1149-4" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Passengers, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1149-5"><a href="arima-models.html#cb1149-5" tabindex="-1"></a>    <span class="at">arima010 =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1149-6"><a href="arima-models.html#cb1149-6" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1149-7"><a href="arima-models.html#cb1149-7" tabindex="-1"></a>  <span class="fu">autoplot</span>(train)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-99-1.png" width="672" /></p>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="arima-models.html#cb1150-1" tabindex="-1"></a><span class="co"># c-e</span></span>
<span id="cb1150-2"><a href="arima-models.html#cb1150-2" tabindex="-1"></a>train <span class="sc">|&gt;</span></span>
<span id="cb1150-3"><a href="arima-models.html#cb1150-3" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1150-4"><a href="arima-models.html#cb1150-4" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Passengers, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1150-5"><a href="arima-models.html#cb1150-5" tabindex="-1"></a>    <span class="at">arima010 =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb1150-6"><a href="arima-models.html#cb1150-6" tabindex="-1"></a>    <span class="at">arima212 =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb1150-7"><a href="arima-models.html#cb1150-7" tabindex="-1"></a>    <span class="at">arima021 =</span> <span class="fu">ARIMA</span>(Passengers <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1150-8"><a href="arima-models.html#cb1150-8" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1150-9"><a href="arima-models.html#cb1150-9" tabindex="-1"></a>  <span class="fu">autoplot</span>(train, <span class="at">level =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning: Model specification induces a quadratic or higher order polynomial trend. 
## This is generally discouraged, consider removing the constant or reducing the number of differences.</code></pre>
<p><img src="figure_html/ch09-ts-arima-100-1.png" width="672" /></p>
<ol start="8" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1152-1"><a href="arima-models.html#cb1152-1" tabindex="-1"></a><span class="co"># find US GDP</span></span>
<span id="cb1152-2"><a href="arima-models.html#cb1152-2" tabindex="-1"></a>usa <span class="ot">&lt;-</span> global_economy <span class="sc">|&gt;</span></span>
<span id="cb1152-3"><a href="arima-models.html#cb1152-3" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&#39;USA&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1152-4"><a href="arima-models.html#cb1152-4" tabindex="-1"></a>  <span class="fu">select</span>(GDP)</span>
<span id="cb1152-5"><a href="arima-models.html#cb1152-5" tabindex="-1"></a></span>
<span id="cb1152-6"><a href="arima-models.html#cb1152-6" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb1152-7"><a href="arima-models.html#cb1152-7" tabindex="-1"></a>usa <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = GDP`</code></pre>
<p><img src="figure_html/ch09-ts-arima-101-1.png" width="672" /></p>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="arima-models.html#cb1154-1" tabindex="-1"></a><span class="co"># there is trend in the data</span></span></code></pre></div>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="arima-models.html#cb1155-1" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> usa <span class="sc">%&gt;%</span> </span>
<span id="cb1155-2"><a href="arima-models.html#cb1155-2" tabindex="-1"></a>  <span class="fu">features</span>(GDP, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1155-3"><a href="arima-models.html#cb1155-3" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1155-4"><a href="arima-models.html#cb1155-4" tabindex="-1"></a></span>
<span id="cb1155-5"><a href="arima-models.html#cb1155-5" tabindex="-1"></a>optimal_lambda</span></code></pre></div>
<pre><code>## [1] 0.2819443</code></pre>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="arima-models.html#cb1157-1" tabindex="-1"></a>usa <span class="ot">&lt;-</span> usa <span class="sc">|&gt;</span></span>
<span id="cb1157-2"><a href="arima-models.html#cb1157-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_boxcox =</span> <span class="fu">box_cox</span>(GDP, <span class="at">lambda=</span>optimal_lambda))</span>
<span id="cb1157-3"><a href="arima-models.html#cb1157-3" tabindex="-1"></a></span>
<span id="cb1157-4"><a href="arima-models.html#cb1157-4" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1157-5"><a href="arima-models.html#cb1157-5" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(GDP_boxcox, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-103-1.png" width="672" /></p>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="arima-models.html#cb1158-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1158-2"><a href="arima-models.html#cb1158-2" tabindex="-1"></a></span>
<span id="cb1158-3"><a href="arima-models.html#cb1158-3" tabindex="-1"></a><span class="co"># make data stationary</span></span>
<span id="cb1158-4"><a href="arima-models.html#cb1158-4" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1158-5"><a href="arima-models.html#cb1158-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_diff =</span> <span class="fu">difference</span>(GDP_boxcox)) <span class="sc">|&gt;</span></span>
<span id="cb1158-6"><a href="arima-models.html#cb1158-6" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(GDP_diff, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-104-1.png" width="672" /></p>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="arima-models.html#cb1161-1" tabindex="-1"></a><span class="co"># it&#39;s probably AR(1) process, make an experiment</span></span>
<span id="cb1161-2"><a href="arima-models.html#cb1161-2" tabindex="-1"></a></span>
<span id="cb1161-3"><a href="arima-models.html#cb1161-3" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1161-4"><a href="arima-models.html#cb1161-4" tabindex="-1"></a></span>
<span id="cb1161-5"><a href="arima-models.html#cb1161-5" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1161-6"><a href="arima-models.html#cb1161-6" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1161-7"><a href="arima-models.html#cb1161-7" tabindex="-1"></a>    <span class="at">ar1 =</span> <span class="fu">ARIMA</span>(GDP_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="co"># my bet</span></span>
<span id="cb1161-8"><a href="arima-models.html#cb1161-8" tabindex="-1"></a>    <span class="at">ma1 =</span> <span class="fu">ARIMA</span>(GDP_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb1161-9"><a href="arima-models.html#cb1161-9" tabindex="-1"></a>    <span class="at">arima111 =</span> <span class="fu">ARIMA</span>(GDP_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1161-10"><a href="arima-models.html#cb1161-10" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(GDP_boxcox, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F)) <span class="sc">|&gt;</span></span>
<span id="cb1161-11"><a href="arima-models.html#cb1161-11" tabindex="-1"></a>  <span class="fu">glance</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 × 8
##   .model   sigma2 log_lik   AIC  AICc   BIC ar_roots  ma_roots 
##   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   
## 1 ar1       5479.   -325.  657.  657.  663. &lt;cpl [1]&gt; &lt;cpl [0]&gt;
## 2 ma1       5689.   -326.  659.  659.  665. &lt;cpl [0]&gt; &lt;cpl [1]&gt;
## 3 arima111  5580.   -325.  659.  659.  667. &lt;cpl [1]&gt; &lt;cpl [1]&gt;
## 4 auto      5479.   -325.  657.  657.  663. &lt;cpl [1]&gt; &lt;cpl [0]&gt;</code></pre>
<div class="sourceCode" id="cb1163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1163-1"><a href="arima-models.html#cb1163-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb1163-2"><a href="arima-models.html#cb1163-2" tabindex="-1"></a></span>
<span id="cb1163-3"><a href="arima-models.html#cb1163-3" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1163-4"><a href="arima-models.html#cb1163-4" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1163-5"><a href="arima-models.html#cb1163-5" tabindex="-1"></a>    <span class="at">ar1 =</span> <span class="fu">ARIMA</span>(GDP_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1163-6"><a href="arima-models.html#cb1163-6" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-106-1.png" width="672" /></p>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="arima-models.html#cb1164-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb1164-2"><a href="arima-models.html#cb1164-2" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1164-3"><a href="arima-models.html#cb1164-3" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1164-4"><a href="arima-models.html#cb1164-4" tabindex="-1"></a>    <span class="at">ar1 =</span> <span class="fu">ARIMA</span>(GDP_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1164-5"><a href="arima-models.html#cb1164-5" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb1164-6"><a href="arima-models.html#cb1164-6" tabindex="-1"></a>  <span class="fu">autoplot</span>(usa)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-107-1.png" width="672" /></p>
<div class="sourceCode" id="cb1165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1165-1"><a href="arima-models.html#cb1165-1" tabindex="-1"></a><span class="co"># f.</span></span>
<span id="cb1165-2"><a href="arima-models.html#cb1165-2" tabindex="-1"></a>usa <span class="sc">|&gt;</span></span>
<span id="cb1165-3"><a href="arima-models.html#cb1165-3" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1165-4"><a href="arima-models.html#cb1165-4" tabindex="-1"></a>    <span class="at">ar1 =</span> <span class="fu">ARIMA</span>(GDP <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb1165-5"><a href="arima-models.html#cb1165-5" tabindex="-1"></a>    <span class="at">ets_AAN =</span> <span class="fu">ETS</span>(GDP <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;N&#39;</span>)),</span>
<span id="cb1165-6"><a href="arima-models.html#cb1165-6" tabindex="-1"></a>    <span class="at">ets_AAdN =</span> <span class="fu">ETS</span>(GDP <span class="sc">~</span> <span class="fu">error</span>(<span class="st">&#39;A&#39;</span>) <span class="sc">+</span> <span class="fu">trend</span>(<span class="st">&#39;Ad&#39;</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="st">&#39;N&#39;</span>)),) <span class="sc">|&gt;</span></span>
<span id="cb1165-7"><a href="arima-models.html#cb1165-7" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">20</span>) <span class="sc">|&gt;</span></span>
<span id="cb1165-8"><a href="arima-models.html#cb1165-8" tabindex="-1"></a>  <span class="fu">autoplot</span>(usa, <span class="at">level =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-108-1.png" width="672" /></p>
<ol start="9" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="arima-models.html#cb1166-1" tabindex="-1"></a><span class="co"># a. </span></span>
<span id="cb1166-2"><a href="arima-models.html#cb1166-2" tabindex="-1"></a>uk <span class="ot">&lt;-</span> aus_arrivals <span class="sc">|&gt;</span></span>
<span id="cb1166-3"><a href="arima-models.html#cb1166-3" tabindex="-1"></a>  <span class="fu">filter</span>(Origin <span class="sc">==</span> <span class="st">&#39;UK&#39;</span>)</span>
<span id="cb1166-4"><a href="arima-models.html#cb1166-4" tabindex="-1"></a></span>
<span id="cb1166-5"><a href="arima-models.html#cb1166-5" tabindex="-1"></a>uk <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = Arrivals`</code></pre>
<p><img src="figure_html/ch09-ts-arima-109-1.png" width="672" /></p>
<ul>
<li>The variance is not constant</li>
<li>There is strong seasonality in the data</li>
<li>There is trend in the data</li>
</ul>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1168-1"><a href="arima-models.html#cb1168-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1168-2"><a href="arima-models.html#cb1168-2" tabindex="-1"></a></span>
<span id="cb1168-3"><a href="arima-models.html#cb1168-3" tabindex="-1"></a><span class="co"># transform the data to make the variance constant</span></span>
<span id="cb1168-4"><a href="arima-models.html#cb1168-4" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> uk <span class="sc">%&gt;%</span> </span>
<span id="cb1168-5"><a href="arima-models.html#cb1168-5" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals, <span class="at">features =</span> guerrero) <span class="sc">%&gt;%</span> </span>
<span id="cb1168-6"><a href="arima-models.html#cb1168-6" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1168-7"><a href="arima-models.html#cb1168-7" tabindex="-1"></a></span>
<span id="cb1168-8"><a href="arima-models.html#cb1168-8" tabindex="-1"></a>uk <span class="ot">&lt;-</span> uk <span class="sc">|&gt;</span></span>
<span id="cb1168-9"><a href="arima-models.html#cb1168-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Arrivals_boxcox =</span> <span class="fu">box_cox</span>(Arrivals, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1168-10"><a href="arima-models.html#cb1168-10" tabindex="-1"></a></span>
<span id="cb1168-11"><a href="arima-models.html#cb1168-11" tabindex="-1"></a>uk <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>(Arrivals_boxcox)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-110-1.png" width="672" /></p>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="arima-models.html#cb1169-1" tabindex="-1"></a>uk <span class="sc">|&gt;</span></span>
<span id="cb1169-2"><a href="arima-models.html#cb1169-2" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals_boxcox, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Origin kpss_stat kpss_pvalue
##   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 UK          2.43        0.01</code></pre>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="arima-models.html#cb1171-1" tabindex="-1"></a><span class="co"># =&gt; H0 is rejected - the data are non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1172-1"><a href="arima-models.html#cb1172-1" tabindex="-1"></a><span class="co"># the order of seasonal differencing</span></span>
<span id="cb1172-2"><a href="arima-models.html#cb1172-2" tabindex="-1"></a>uk <span class="sc">%&gt;%</span> </span>
<span id="cb1172-3"><a href="arima-models.html#cb1172-3" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals_boxcox, <span class="at">features =</span> unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   Origin nsdiffs
##   &lt;chr&gt;    &lt;int&gt;
## 1 UK           1</code></pre>
<div class="sourceCode" id="cb1174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1174-1"><a href="arima-models.html#cb1174-1" tabindex="-1"></a>uk <span class="ot">&lt;-</span> uk <span class="sc">|&gt;</span></span>
<span id="cb1174-2"><a href="arima-models.html#cb1174-2" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Arrivals_sdiff =</span> <span class="fu">difference</span>(Arrivals_boxcox, <span class="at">lag =</span> <span class="dv">4</span>))</span>
<span id="cb1174-3"><a href="arima-models.html#cb1174-3" tabindex="-1"></a></span>
<span id="cb1174-4"><a href="arima-models.html#cb1174-4" tabindex="-1"></a>uk <span class="sc">|&gt;</span></span>
<span id="cb1174-5"><a href="arima-models.html#cb1174-5" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals_sdiff, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Origin kpss_stat kpss_pvalue
##   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 UK         0.514      0.0385</code></pre>
<div class="sourceCode" id="cb1176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1176-1"><a href="arima-models.html#cb1176-1" tabindex="-1"></a><span class="co"># =&gt; H0 is rejected - the data are still non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1177-1"><a href="arima-models.html#cb1177-1" tabindex="-1"></a>uk <span class="sc">%&gt;%</span> </span>
<span id="cb1177-2"><a href="arima-models.html#cb1177-2" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals_sdiff, <span class="at">features =</span> unitroot_ndiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   Origin ndiffs
##   &lt;chr&gt;   &lt;int&gt;
## 1 UK          1</code></pre>
<div class="sourceCode" id="cb1179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1179-1"><a href="arima-models.html#cb1179-1" tabindex="-1"></a>uk <span class="ot">&lt;-</span> uk <span class="sc">|&gt;</span></span>
<span id="cb1179-2"><a href="arima-models.html#cb1179-2" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Arrivals_diff =</span> <span class="fu">difference</span>(Arrivals_sdiff))</span>
<span id="cb1179-3"><a href="arima-models.html#cb1179-3" tabindex="-1"></a></span>
<span id="cb1179-4"><a href="arima-models.html#cb1179-4" tabindex="-1"></a>uk <span class="sc">|&gt;</span></span>
<span id="cb1179-5"><a href="arima-models.html#cb1179-5" tabindex="-1"></a>  <span class="fu">features</span>(Arrivals_diff, <span class="at">features =</span> unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Origin kpss_stat kpss_pvalue
##   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 UK        0.0268         0.1</code></pre>
<div class="sourceCode" id="cb1181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1181-1"><a href="arima-models.html#cb1181-1" tabindex="-1"></a><span class="co"># =&gt; H0 is not rejected - the data are now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1182-1"><a href="arima-models.html#cb1182-1" tabindex="-1"></a>uk <span class="sc">|&gt;</span> <span class="fu">gg_tsdisplay</span>(Arrivals_diff, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-116-1.png" width="672" /></p>
<p>The plot suggests ARIMA(1,1,1)(1,1,1)</p>
<div class="sourceCode" id="cb1185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1185-1"><a href="arima-models.html#cb1185-1" tabindex="-1"></a>fits <span class="ot">&lt;-</span> uk <span class="sc">|&gt;</span></span>
<span id="cb1185-2"><a href="arima-models.html#cb1185-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">auto =</span> <span class="fu">ARIMA</span>(Arrivals_boxcox, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1185-3"><a href="arima-models.html#cb1185-3" tabindex="-1"></a>        <span class="at">arima111_111 =</span> <span class="fu">ARIMA</span>(Arrivals_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb1185-4"><a href="arima-models.html#cb1185-4" tabindex="-1"></a></span>
<span id="cb1185-5"><a href="arima-models.html#cb1185-5" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1185-6"><a href="arima-models.html#cb1185-6" tabindex="-1"></a>  <span class="fu">glance</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 × 9
##   Origin .model        sigma2 log_lik   AIC  AICc   BIC ar_roots  ma_roots 
##   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   
## 1 UK     auto         0.00282    184. -362. -362. -354. &lt;cpl [0]&gt; &lt;cpl [5]&gt;
## 2 UK     arima111_111 0.00285    184. -359. -358. -345. &lt;cpl [5]&gt; &lt;cpl [5]&gt;</code></pre>
<div class="sourceCode" id="cb1187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1187-1"><a href="arima-models.html#cb1187-1" tabindex="-1"></a>fits<span class="sc">$</span>auto[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">report</span>()</span></code></pre></div>
<pre><code>## Series: Arrivals_boxcox 
## Model: ARIMA(0,1,1)(0,1,1)[4] 
## 
## Coefficients:
##           ma1     sma1
##       -0.5149  -0.7691
## s.e.   0.0803   0.0814
## 
## sigma^2 estimated as 0.002822:  log likelihood=184.05
## AIC=-362.11   AICc=-361.9   BIC=-353.69</code></pre>
<div class="sourceCode" id="cb1189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1189-1"><a href="arima-models.html#cb1189-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1189-2"><a href="arima-models.html#cb1189-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb1189-3"><a href="arima-models.html#cb1189-3" tabindex="-1"></a>  <span class="fu">autoplot</span>(uk, <span class="at">level =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-119-1.png" width="672" /></p>
<div class="sourceCode" id="cb1190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1190-1"><a href="arima-models.html#cb1190-1" tabindex="-1"></a>frc <span class="ot">&lt;-</span> fits <span class="sc">|&gt;</span></span>
<span id="cb1190-2"><a href="arima-models.html#cb1190-2" tabindex="-1"></a>          <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">12</span>, <span class="at">lambda =</span> optimal_lambda) <span class="sc">|&gt;</span></span>
<span id="cb1190-3"><a href="arima-models.html#cb1190-3" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">.mean =</span> <span class="fu">inv_box_cox</span>(.mean, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1190-4"><a href="arima-models.html#cb1190-4" tabindex="-1"></a></span>
<span id="cb1190-5"><a href="arima-models.html#cb1190-5" tabindex="-1"></a></span>
<span id="cb1190-6"><a href="arima-models.html#cb1190-6" tabindex="-1"></a><span class="fu">ggplot</span>(uk) <span class="sc">+</span></span>
<span id="cb1190-7"><a href="arima-models.html#cb1190-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Quarter, <span class="at">y =</span> Arrivals)) <span class="sc">+</span></span>
<span id="cb1190-8"><a href="arima-models.html#cb1190-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>frc, <span class="fu">aes</span>(<span class="at">x =</span> Quarter, <span class="at">y =</span> .mean, <span class="at">color =</span> .model))</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-120-1.png" width="672" /></p>
<ol start="10" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1191-1"><a href="arima-models.html#cb1191-1" tabindex="-1"></a>series <span class="ot">&lt;-</span> us_employment <span class="sc">|&gt;</span></span>
<span id="cb1191-2"><a href="arima-models.html#cb1191-2" tabindex="-1"></a>  <span class="fu">filter</span>(Series_ID <span class="sc">==</span> <span class="st">&#39;CEU7071300001&#39;</span>, <span class="sc">!</span><span class="fu">is.na</span>(Employed))</span>
<span id="cb1191-3"><a href="arima-models.html#cb1191-3" tabindex="-1"></a></span>
<span id="cb1191-4"><a href="arima-models.html#cb1191-4" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1191-5"><a href="arima-models.html#cb1191-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-121-1.png" width="672" /></p>
<div class="sourceCode" id="cb1192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1192-1"><a href="arima-models.html#cb1192-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb1192-2"><a href="arima-models.html#cb1192-2" tabindex="-1"></a></span>
<span id="cb1192-3"><a href="arima-models.html#cb1192-3" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1192-4"><a href="arima-models.html#cb1192-4" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>()</span></code></pre></div>
<pre><code>## Plot variable not specified, automatically selected `y = Employed`</code></pre>
<p><img src="figure_html/ch09-ts-arima-122-1.png" width="672" /></p>
<div class="sourceCode" id="cb1194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1194-1"><a href="arima-models.html#cb1194-1" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1194-2"><a href="arima-models.html#cb1194-2" tabindex="-1"></a>  <span class="fu">model</span>(<span class="fu">STL</span>(Employed <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">7</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="dv">7</span>))) <span class="sc">|&gt;</span></span>
<span id="cb1194-3"><a href="arima-models.html#cb1194-3" tabindex="-1"></a>  <span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb1194-4"><a href="arima-models.html#cb1194-4" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-123-1.png" width="672" /></p>
<div class="sourceCode" id="cb1195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1195-1"><a href="arima-models.html#cb1195-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1195-2"><a href="arima-models.html#cb1195-2" tabindex="-1"></a></span>
<span id="cb1195-3"><a href="arima-models.html#cb1195-3" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> series <span class="sc">|&gt;</span></span>
<span id="cb1195-4"><a href="arima-models.html#cb1195-4" tabindex="-1"></a>  <span class="fu">features</span>(Employed, guerrero) <span class="sc">|&gt;</span></span>
<span id="cb1195-5"><a href="arima-models.html#cb1195-5" tabindex="-1"></a>  <span class="fu">pull</span>(lambda_guerrero)</span>
<span id="cb1195-6"><a href="arima-models.html#cb1195-6" tabindex="-1"></a></span>
<span id="cb1195-7"><a href="arima-models.html#cb1195-7" tabindex="-1"></a>series <span class="ot">&lt;-</span> series <span class="sc">|&gt;</span></span>
<span id="cb1195-8"><a href="arima-models.html#cb1195-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employed_transformed =</span> <span class="fu">box_cox</span>(Employed, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1195-9"><a href="arima-models.html#cb1195-9" tabindex="-1"></a></span>
<span id="cb1195-10"><a href="arima-models.html#cb1195-10" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1195-11"><a href="arima-models.html#cb1195-11" tabindex="-1"></a>  <span class="fu">autoplot</span>(Employed_transformed)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-124-1.png" width="672" /></p>
<div class="sourceCode" id="cb1196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1196-1"><a href="arima-models.html#cb1196-1" tabindex="-1"></a><span class="co"># the data have thrend and strong seasonality</span></span></code></pre></div>
<div class="sourceCode" id="cb1197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1197-1"><a href="arima-models.html#cb1197-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1197-2"><a href="arima-models.html#cb1197-2" tabindex="-1"></a></span>
<span id="cb1197-3"><a href="arima-models.html#cb1197-3" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1197-4"><a href="arima-models.html#cb1197-4" tabindex="-1"></a>  <span class="fu">features</span>(Employed, unitroot_kpss)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   Series_ID     kpss_stat kpss_pvalue
##   &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;
## 1 CEU7071300001      4.78        0.01</code></pre>
<div class="sourceCode" id="cb1199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1199-1"><a href="arima-models.html#cb1199-1" tabindex="-1"></a><span class="co"># =&gt; H0 is rejected, the data are non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1200-1"><a href="arima-models.html#cb1200-1" tabindex="-1"></a><span class="co"># get to know the order of the seasonal differencing </span></span>
<span id="cb1200-2"><a href="arima-models.html#cb1200-2" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1200-3"><a href="arima-models.html#cb1200-3" tabindex="-1"></a>  <span class="fu">features</span>(Employed, unitroot_nsdiffs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   Series_ID     nsdiffs
##   &lt;chr&gt;           &lt;int&gt;
## 1 CEU7071300001       1</code></pre>
<div class="sourceCode" id="cb1202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1202-1"><a href="arima-models.html#cb1202-1" tabindex="-1"></a>series <span class="ot">&lt;-</span> series <span class="sc">|&gt;</span></span>
<span id="cb1202-2"><a href="arima-models.html#cb1202-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employed_sdiff =</span> <span class="fu">difference</span>(Employed_transformed, <span class="at">lag=</span><span class="dv">12</span>))</span>
<span id="cb1202-3"><a href="arima-models.html#cb1202-3" tabindex="-1"></a></span>
<span id="cb1202-4"><a href="arima-models.html#cb1202-4" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1202-5"><a href="arima-models.html#cb1202-5" tabindex="-1"></a>  <span class="fu">features</span>(Employed_sdiff, <span class="fu">c</span>(unitroot_nsdiffs, unitroot_ndiffs, unitroot_kpss))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Series_ID     nsdiffs ndiffs kpss_stat kpss_pvalue
##   &lt;chr&gt;           &lt;int&gt;  &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 CEU7071300001       0      1      1.39        0.01</code></pre>
<div class="sourceCode" id="cb1204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1204-1"><a href="arima-models.html#cb1204-1" tabindex="-1"></a><span class="co"># =&gt; H0 is rejected, the data are still non-stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1205-1"><a href="arima-models.html#cb1205-1" tabindex="-1"></a>series <span class="ot">&lt;-</span> series <span class="sc">|&gt;</span></span>
<span id="cb1205-2"><a href="arima-models.html#cb1205-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employed_diff =</span> <span class="fu">difference</span>(Employed_sdiff))</span>
<span id="cb1205-3"><a href="arima-models.html#cb1205-3" tabindex="-1"></a></span>
<span id="cb1205-4"><a href="arima-models.html#cb1205-4" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1205-5"><a href="arima-models.html#cb1205-5" tabindex="-1"></a>  <span class="fu">features</span>(Employed_diff, <span class="fu">c</span>(unitroot_nsdiffs, unitroot_ndiffs, unitroot_kpss))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   Series_ID     nsdiffs ndiffs kpss_stat kpss_pvalue
##   &lt;chr&gt;           &lt;int&gt;  &lt;int&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 CEU7071300001       0      0    0.0291         0.1</code></pre>
<div class="sourceCode" id="cb1207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1207-1"><a href="arima-models.html#cb1207-1" tabindex="-1"></a><span class="co"># =&gt; the data are now stationary</span></span></code></pre></div>
<div class="sourceCode" id="cb1208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1208-1"><a href="arima-models.html#cb1208-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb1208-2"><a href="arima-models.html#cb1208-2" tabindex="-1"></a></span>
<span id="cb1208-3"><a href="arima-models.html#cb1208-3" tabindex="-1"></a>series <span class="sc">|&gt;</span></span>
<span id="cb1208-4"><a href="arima-models.html#cb1208-4" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Employed_diff, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-129-1.png" width="672" /></p>
<div class="sourceCode" id="cb1211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1211-1"><a href="arima-models.html#cb1211-1" tabindex="-1"></a><span class="co"># Plot suggests</span></span>
<span id="cb1211-2"><a href="arima-models.html#cb1211-2" tabindex="-1"></a><span class="co"># ARIMA(0,1,3)(0,1,1)</span></span>
<span id="cb1211-3"><a href="arima-models.html#cb1211-3" tabindex="-1"></a><span class="co"># ARIMA(3,1,0)(3,1,0)</span></span></code></pre></div>
<div class="sourceCode" id="cb1212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1212-1"><a href="arima-models.html#cb1212-1" tabindex="-1"></a>fits <span class="ot">&lt;-</span> series <span class="sc">|&gt;</span></span>
<span id="cb1212-2"><a href="arima-models.html#cb1212-2" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1212-3"><a href="arima-models.html#cb1212-3" tabindex="-1"></a>    <span class="at">arima013_021 =</span> <span class="fu">ARIMA</span>(Employed_transformed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1212-4"><a href="arima-models.html#cb1212-4" tabindex="-1"></a>    <span class="at">arima310_320 =</span> <span class="fu">ARIMA</span>(Employed_transformed <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb1212-5"><a href="arima-models.html#cb1212-5" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Employed_transformed, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1212-6"><a href="arima-models.html#cb1212-6" tabindex="-1"></a>  )</span>
<span id="cb1212-7"><a href="arima-models.html#cb1212-7" tabindex="-1"></a></span>
<span id="cb1212-8"><a href="arima-models.html#cb1212-8" tabindex="-1"></a>fits</span></code></pre></div>
<pre><code>## # A mable: 1 x 4
## # Key:     Series_ID [1]
##   Series_ID                  arima013_021              arima310_320                      auto
##   &lt;chr&gt;                           &lt;model&gt;                   &lt;model&gt;                   &lt;model&gt;
## 1 CEU7071300001 &lt;ARIMA(0,1,3)(0,1,1)[12]&gt; &lt;ARIMA(3,1,0)(3,1,0)[12]&gt; &lt;ARIMA(3,1,1)(0,1,2)[12]&gt;</code></pre>
<div class="sourceCode" id="cb1214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1214-1"><a href="arima-models.html#cb1214-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1214-2"><a href="arima-models.html#cb1214-2" tabindex="-1"></a>  <span class="fu">glance</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 9
##   Series_ID     .model       sigma2 log_lik   AIC  AICc   BIC ar_roots   ma_roots  
##   &lt;chr&gt;         &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;    
## 1 CEU7071300001 arima013_021 0.0188    197. -385. -385. -366. &lt;cpl [0]&gt;  &lt;cpl [15]&gt;
## 2 CEU7071300001 arima310_320 0.0183    202. -391. -390. -364. &lt;cpl [39]&gt; &lt;cpl [0]&gt; 
## 3 CEU7071300001 auto         0.0178    207. -400. -400. -373. &lt;cpl [3]&gt;  &lt;cpl [25]&gt;</code></pre>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1216-1"><a href="arima-models.html#cb1216-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb1216-2"><a href="arima-models.html#cb1216-2" tabindex="-1"></a></span>
<span id="cb1216-3"><a href="arima-models.html#cb1216-3" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1216-4"><a href="arima-models.html#cb1216-4" tabindex="-1"></a>  <span class="fu">select</span>(arima013_021) <span class="sc">|&gt;</span></span>
<span id="cb1216-5"><a href="arima-models.html#cb1216-5" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb1217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1217-1"><a href="arima-models.html#cb1217-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1217-2"><a href="arima-models.html#cb1217-2" tabindex="-1"></a>  <span class="fu">select</span>(arima310_320) <span class="sc">|&gt;</span></span>
<span id="cb1217-3"><a href="arima-models.html#cb1217-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-133-1.png" width="672" /></p>
<div class="sourceCode" id="cb1218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1218-1"><a href="arima-models.html#cb1218-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1218-2"><a href="arima-models.html#cb1218-2" tabindex="-1"></a>  <span class="fu">select</span>(auto) <span class="sc">|&gt;</span></span>
<span id="cb1218-3"><a href="arima-models.html#cb1218-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-134-1.png" width="672" /></p>
<div class="sourceCode" id="cb1219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1219-1"><a href="arima-models.html#cb1219-1" tabindex="-1"></a><span class="co"># f.</span></span>
<span id="cb1219-2"><a href="arima-models.html#cb1219-2" tabindex="-1"></a></span>
<span id="cb1219-3"><a href="arima-models.html#cb1219-3" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1219-4"><a href="arima-models.html#cb1219-4" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb1219-5"><a href="arima-models.html#cb1219-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(series, <span class="at">level =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1219-6"><a href="arima-models.html#cb1219-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(.model) <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-135-1.png" width="672" /></p>
<div class="sourceCode" id="cb1220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1220-1"><a href="arima-models.html#cb1220-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1220-2"><a href="arima-models.html#cb1220-2" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">36</span>) <span class="sc">|&gt;</span></span>
<span id="cb1220-3"><a href="arima-models.html#cb1220-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.mean =</span> <span class="fu">inv_box_cox</span>(.mean, <span class="at">lambda =</span> optimal_lambda)) <span class="sc">|&gt;</span></span>
<span id="cb1220-4"><a href="arima-models.html#cb1220-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1220-5"><a href="arima-models.html#cb1220-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> series, <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> Employed)) <span class="sc">+</span></span>
<span id="cb1220-6"><a href="arima-models.html#cb1220-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> .mean, <span class="at">color =</span> .model)) <span class="sc">+</span></span>
<span id="cb1220-7"><a href="arima-models.html#cb1220-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="fu">factor</span>(.model) <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-136-1.png" width="672" /></p>
<ol start="11" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb1221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1221-1"><a href="arima-models.html#cb1221-1" tabindex="-1"></a><span class="co"># a.</span></span>
<span id="cb1221-2"><a href="arima-models.html#cb1221-2" tabindex="-1"></a></span>
<span id="cb1221-3"><a href="arima-models.html#cb1221-3" tabindex="-1"></a>gas <span class="ot">&lt;-</span> aus_production <span class="sc">|&gt;</span></span>
<span id="cb1221-4"><a href="arima-models.html#cb1221-4" tabindex="-1"></a>  <span class="fu">select</span>(Gas)</span>
<span id="cb1221-5"><a href="arima-models.html#cb1221-5" tabindex="-1"></a></span>
<span id="cb1221-6"><a href="arima-models.html#cb1221-6" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb1221-7"><a href="arima-models.html#cb1221-7" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(Gas, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-137-1.png" width="672" /></p>
<div class="sourceCode" id="cb1222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1222-1"><a href="arima-models.html#cb1222-1" tabindex="-1"></a>optimal_lambda <span class="ot">&lt;-</span> gas <span class="sc">|&gt;</span></span>
<span id="cb1222-2"><a href="arima-models.html#cb1222-2" tabindex="-1"></a>  <span class="fu">features</span>(Gas, guerrero)</span>
<span id="cb1222-3"><a href="arima-models.html#cb1222-3" tabindex="-1"></a></span>
<span id="cb1222-4"><a href="arima-models.html#cb1222-4" tabindex="-1"></a>gas <span class="ot">&lt;-</span> gas <span class="sc">|&gt;</span></span>
<span id="cb1222-5"><a href="arima-models.html#cb1222-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gas_boxcox =</span> <span class="fu">box_cox</span>(Gas, <span class="at">lambda =</span> optimal_lambda))</span>
<span id="cb1222-6"><a href="arima-models.html#cb1222-6" tabindex="-1"></a></span>
<span id="cb1222-7"><a href="arima-models.html#cb1222-7" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb1222-8"><a href="arima-models.html#cb1222-8" tabindex="-1"></a>    <span class="fu">gg_tsdisplay</span>(Gas_boxcox, <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-138-1.png" width="672" /></p>
<div class="sourceCode" id="cb1223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1223-1"><a href="arima-models.html#cb1223-1" tabindex="-1"></a><span class="co"># b.</span></span>
<span id="cb1223-2"><a href="arima-models.html#cb1223-2" tabindex="-1"></a></span>
<span id="cb1223-3"><a href="arima-models.html#cb1223-3" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb1223-4"><a href="arima-models.html#cb1223-4" tabindex="-1"></a>  <span class="fu">features</span>(Gas_boxcox, <span class="fu">c</span>(unitroot_kpss, unitroot_ndiffs, unitroot_nsdiffs))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   kpss_stat kpss_pvalue ndiffs nsdiffs
##       &lt;dbl&gt;       &lt;dbl&gt;  &lt;int&gt;   &lt;int&gt;
## 1      4.15        0.01      1       1</code></pre>
<div class="sourceCode" id="cb1225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1225-1"><a href="arima-models.html#cb1225-1" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb1225-2"><a href="arima-models.html#cb1225-2" tabindex="-1"></a>  <span class="fu">features</span>(<span class="fu">difference</span>(<span class="fu">difference</span>(Gas_boxcox, <span class="at">lag=</span><span class="dv">12</span>)), <span class="fu">c</span>(unitroot_kpss, </span>
<span id="cb1225-3"><a href="arima-models.html#cb1225-3" tabindex="-1"></a>                                             unitroot_ndiffs, </span>
<span id="cb1225-4"><a href="arima-models.html#cb1225-4" tabindex="-1"></a>                                             unitroot_nsdiffs))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   kpss_stat kpss_pvalue ndiffs nsdiffs
##       &lt;dbl&gt;       &lt;dbl&gt;  &lt;int&gt;   &lt;int&gt;
## 1     0.102         0.1      0       0</code></pre>
<div class="sourceCode" id="cb1227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1227-1"><a href="arima-models.html#cb1227-1" tabindex="-1"></a>gas <span class="sc">|&gt;</span></span>
<span id="cb1227-2"><a href="arima-models.html#cb1227-2" tabindex="-1"></a>  <span class="fu">gg_tsdisplay</span>(<span class="fu">difference</span>(<span class="fu">difference</span>(Gas_boxcox, <span class="at">lag=</span><span class="dv">12</span>)), <span class="at">plot_type =</span> <span class="st">&#39;partial&#39;</span>, <span class="at">lag_max =</span> <span class="dv">36</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 13 rows containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="figure_html/ch09-ts-arima-140-1.png" width="672" /></p>
<div class="sourceCode" id="cb1230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1230-1"><a href="arima-models.html#cb1230-1" tabindex="-1"></a><span class="co"># c.</span></span>
<span id="cb1230-2"><a href="arima-models.html#cb1230-2" tabindex="-1"></a><span class="co"># ARIMA(0,1,2)(2,1,1)</span></span>
<span id="cb1230-3"><a href="arima-models.html#cb1230-3" tabindex="-1"></a><span class="co"># ARIMA(2,1,0)(2,1,0)</span></span>
<span id="cb1230-4"><a href="arima-models.html#cb1230-4" tabindex="-1"></a></span>
<span id="cb1230-5"><a href="arima-models.html#cb1230-5" tabindex="-1"></a>fits <span class="ot">&lt;-</span> gas <span class="sc">|&gt;</span></span>
<span id="cb1230-6"><a href="arima-models.html#cb1230-6" tabindex="-1"></a>  <span class="fu">model</span>(</span>
<span id="cb1230-7"><a href="arima-models.html#cb1230-7" tabindex="-1"></a>    <span class="at">arima012_211 =</span> <span class="fu">ARIMA</span>(Gas_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)),</span>
<span id="cb1230-8"><a href="arima-models.html#cb1230-8" tabindex="-1"></a>    <span class="at">arima210_210 =</span> <span class="fu">ARIMA</span>(Gas_boxcox <span class="sc">~</span> <span class="fu">pdq</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="sc">+</span> <span class="fu">PDQ</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)),</span>
<span id="cb1230-9"><a href="arima-models.html#cb1230-9" tabindex="-1"></a>    <span class="at">auto =</span> <span class="fu">ARIMA</span>(Gas_boxcox, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1230-10"><a href="arima-models.html#cb1230-10" tabindex="-1"></a>    )</span>
<span id="cb1230-11"><a href="arima-models.html#cb1230-11" tabindex="-1"></a></span>
<span id="cb1230-12"><a href="arima-models.html#cb1230-12" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1230-13"><a href="arima-models.html#cb1230-13" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb1230-14"><a href="arima-models.html#cb1230-14" tabindex="-1"></a>  <span class="fu">arrange</span>(AICc) <span class="sc">|&gt;</span></span>
<span id="cb1230-15"><a href="arima-models.html#cb1230-15" tabindex="-1"></a>  <span class="fu">select</span>(.model<span class="sc">:</span>BIC)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 6
##   .model        sigma2 log_lik   AIC  AICc   BIC
##   &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 auto         0.00535    255. -495. -495. -472.
## 2 arima012_211 0.00559    249. -485. -485. -465.
## 3 arima210_210 0.00626    239. -468. -468. -452.</code></pre>
<div class="sourceCode" id="cb1232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1232-1"><a href="arima-models.html#cb1232-1" tabindex="-1"></a><span class="co"># d.</span></span>
<span id="cb1232-2"><a href="arima-models.html#cb1232-2" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1232-3"><a href="arima-models.html#cb1232-3" tabindex="-1"></a>  <span class="fu">select</span>(arima012_211) <span class="sc">|&gt;</span></span>
<span id="cb1232-4"><a href="arima-models.html#cb1232-4" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-142-1.png" width="672" /></p>
<div class="sourceCode" id="cb1233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1233-1"><a href="arima-models.html#cb1233-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1233-2"><a href="arima-models.html#cb1233-2" tabindex="-1"></a>  <span class="fu">select</span>(arima210_210) <span class="sc">|&gt;</span></span>
<span id="cb1233-3"><a href="arima-models.html#cb1233-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-143-1.png" width="672" /></p>
<div class="sourceCode" id="cb1234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1234-1"><a href="arima-models.html#cb1234-1" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1234-2"><a href="arima-models.html#cb1234-2" tabindex="-1"></a>  <span class="fu">select</span>(auto) <span class="sc">|&gt;</span></span>
<span id="cb1234-3"><a href="arima-models.html#cb1234-3" tabindex="-1"></a>  <span class="fu">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-144-1.png" width="672" /></p>
<div class="sourceCode" id="cb1235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1235-1"><a href="arima-models.html#cb1235-1" tabindex="-1"></a><span class="co"># e.</span></span>
<span id="cb1235-2"><a href="arima-models.html#cb1235-2" tabindex="-1"></a></span>
<span id="cb1235-3"><a href="arima-models.html#cb1235-3" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb1235-4"><a href="arima-models.html#cb1235-4" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> <span class="dv">24</span>) <span class="sc">|&gt;</span></span>
<span id="cb1235-5"><a href="arima-models.html#cb1235-5" tabindex="-1"></a>  <span class="fu">autoplot</span>(gas, <span class="at">level =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="figure_html/ch09-ts-arima-145-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exponential-smoothing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic-regression-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
